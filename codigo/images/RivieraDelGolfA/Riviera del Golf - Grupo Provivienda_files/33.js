(window.webpackJsonp=window.webpackJsonp||[]).push([[33,2,3,13],{1055:function(t,e,n){},1056:function(t,e,n){t.exports=n.p+"images/icon_MacOSX_Safari.png"},1057:function(t,e,n){t.exports=n.p+"images/icon_Internet_Explorer_10.png"},1058:function(t,e,n){t.exports=n.p+"images/icon_Mozilla_Firefox.png"},1059:function(t,e,n){t.exports=n.p+"images/icon_Google_Chrome_2011.png"},1061:function(t,e,n){},1084:function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(113),a=n(39),s=n(327),u=n(412),c=n(384),l=n(19),p=n(94),h=n(114),f=n(47),d=n(82),y=n(348),v=n(312),g=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),w=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},m=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.internalProgress=!1,e.name="sweep-data",e.defaultEasing=p.c,e.moveToSweep=function(t){var n=new l.a;return t.prevSweepId=t.prevSweepId||e.sweepData.currentSweep,e.activateSweep(t).then(function(){return e.beginSweepTransition(t),e.defaultSweepCameraMove(n,t)}).then(function(){e.endSweepTransition(t),n.resolve()}).catch(function(e){Object(d.c)(e,"Failure moving to sweep "+t.sweepId),n.reject(e)}),n.promise()},e.activateSweep=function(t){return w(e,void 0,void 0,function(){return m(this,function(e){if(!this.sweepData.canTransition()||!this.cameraData.canTransition())throw new Error("Tried to start sweep transition while another transition was active!");if(!this.sweepData.containsSweep(t.sweepId))throw new Error("invalid sweep");return[2,this.activateSweepUnsafe(t)]})})},e.activateSweepUnsafe=function(t){return w(e,void 0,void 0,function(){var e,n,r=this;return m(this,function(o){switch(o.label){case 0:return this.sweepPanoModule?[3,2]:(e=this,[4,this.engine.getModuleByParent(i.Xa)]);case 1:e.sweepPanoModule=o.sent(),o.label=2;case 2:return n=this.sweepPanoModule.getRenderer(),this.sweepData.setTransitionPending(!0),[2,n.activateSweep(t.sweepId).then(function(){return r.sweepData.setTransitionPending(!1)})]}})})},e.instantSweepTransition=function(t){var n=e.sweepData.currentSweep;e.beginSweepTransition({sweepId:t,transitionTime:0,internalProgress:!0,prevSweepId:n}),e.sweepData.currentSweep=t,e.market.update(e,e.sweepData),e.engine.broadcast(new y.a(t,n)),e.endSweepTransition({sweepId:t,prevSweepId:n})},e.beginSweepTransition=function(t){e.sweepData.activateTransition(t.sweepId,t.prevSweepId),e.internalProgress=t.internalProgress||!1,e.sweepData.transition.progress.modifyAnimation(0,1,t.transitionTime||0,t.easing||e.defaultEasing),e.market.update(e,e.sweepData),e.engine.broadcast(new c.a(t.sweepId,t.prevSweepId))},e.endSweepTransition=function(t){e.sweepData.setTransitionPending(!1);var n=e.sweepData.getSweep(t.sweepId);e.sweepData.deactivateTransition(),e.sweepData.currentSweep=t.sweepId,e.sweepData.transition.progress.stop(1),e.internalProgress=!1,e.market.update(e,e.sweepData),e.engine.broadcast(new u.a(t.sweepId,n.alignmentType,n.placementType,t.prevSweepId))},e.defaultSweepCameraMove=function(t,n){return w(e,void 0,Promise,function(){var e,r,i,o,u,c=this;return m(this,function(l){return e={position:this.sweepData.getSweep(n.sweepId).position,rotation:n.rotation},r=Object(s.c)(this.cameraData.aspect()),i=a.a.Interpolate,void 0!==n.transitionType&&a.a[n.transitionType]&&(i=n.transitionType),o=this.cameraModule.moveTo({transitionType:i,pose:e,transitionTime:n.transitionTime,projection:r,easing:n.easing,rotationDelay:n.rotationDelay}),u=!1,o.progress(function(e){c.sweepData.transition.progress.updateProgress(e),t.notify(e),e>=.5&&!u&&(u=!0,c.sweepData.currentSweep=n.sweepId,c.market.update(c,c.sweepData),c.engine.broadcast(new y.a(n.sweepId,n.prevSweepId)))}),[2,o.nativePromise()]})})},e}return g(e,t),e.prototype.init=function(t,e){return w(this,void 0,void 0,function(){var n,r,a,s,u,c;return m(this,function(l){switch(l.label){case 0:return this.engine=e,this.market=this.engine.market,this.market.register(this,o.a),[4,t.sweepSync.load()];case 1:return n=l.sent()||{},r=function(t){var e=Object(h.a)();for(var n in t){var r=t[n],i=Object(f.a)(r.position),o=Object(f.a)(r.rotation),a=Object(f.a)(r);a.position=i,a.rotation=o,e.set(r.id,a)}return e}(n),t.createSyncMonitor&&t.sweepSync.addMonitor(t.createSyncMonitor(r)),a=Object(f.a)(new o.a(r)),this.market.update(this,a),s=this,[4,this.market.waitForData(o.a)];case 2:return s.sweepData=l.sent(),u=this,[4,this.engine.getModule(i.c)];case 3:return u.cameraModule=l.sent(),c=this,[4,e.market.waitForData(v.a)];case 4:return c.cameraData=l.sent(),[2]}})})},e.prototype.onUpdate=function(t){this.internalProgress&&this.sweepData.transition.active&&this.sweepData.transition.progress.tick(t)},e}(i.Wa);e.default=b},1096:function(t,e,n){"use strict";n.r(e);var r,i=n(403),o=n(674),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.sweepLoader=new i.a(e),r}return a(e,t),e.prototype.activateSweep=function(e){return t.prototype.activateSweep.call(this,e),this.sweepLoader.load(e).then(function(t){return t})},e.prototype.useTexture=function(e){var n=this.sweepLoader.useTexture(e);return n&&t.prototype.useTexture.call(this,e),n},e.prototype.freeTexture=function(e,n){void 0===n&&(n=!1),t.prototype.freeTexture.call(this,e,n),0===this.textureUsageCounter[e]&&this.sweepLoader.unload(e)},e.prototype.freeAllTextures=function(t){this.sweepLoader.unloadAll(t)},e}(o.a),u=n(0),c=n(113),l=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),p=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},h=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="sweep-pano",e}return l(e,t),e.prototype.init=function(t,e){return p(this,void 0,void 0,function(){var t,n;return h(this,function(r){switch(r.label){case 0:return[4,e.getModule(u.U)];case 1:return t=r.sent().getSignedUrls(),[4,e.market.waitForData(c.a)];case 2:return n=r.sent().getSweepList(),this.panoRenderer=new s(t,n),e.addComponent(this,this.panoRenderer),[2]}})})},e.prototype.getRenderer=function(){return this.panoRenderer},e}(u.Xa);e.default=f},1104:function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(113),a=n(531),s=n(530),u=n(14),c=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t[t.None=0]="None",t[t.Queued=1]="Queued",t[t.Rendering=2]="Rendering",t[t.Rendered=3]="Rendered"}(r||(r={}));var l,p=function(){function t(t){this.statusMap={},this.active=[],this.queued=[],this.panoRenderer=t,this.disablePreRendering()}return t.prototype.init=function(){},t.prototype.dispose=function(){},t.prototype.activate=function(t){},t.prototype.deactivate=function(t){this.disablePreRendering()},t.prototype.enablePreRendering=function(){this.enabled=!0},t.prototype.disablePreRendering=function(){this.enabled=!1},t.prototype.render=function(){},t.prototype.beforeRender=function(){this.enabled&&this.processQueued()},t.prototype.tryPreRender=function(t){return this.getPreRenderState(t)===r.None&&(this.queued.push(t),this.statusMap[t]=r.Queued,!0)},t.prototype.getPreRenderState=function(t){var e=this.statusMap[t];return void 0!==e?e:r.None},t.prototype.processQueued=function(){var t,e,n=this,i=0;try{for(var o=c(Object.keys(this.statusMap)),a=o.next();!a.done;a=o.next()){var s=a.value;this.statusMap[s]===r.Rendering&&i++}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}if(0===i&&this.queued.length>0){var u=this.queued.shift();if(u)this.active.push(u),this.statusMap[u]=r.Rendering,this.panoRenderer.activateSweep(u).then(function(){n.onRendered(u)})}},t.prototype.cleanup=function(t){var e,n,i,o;void 0===t&&(t=[]);var a=Object(u.b)(t),s=[];try{for(var l=c(this.queued),p=l.next();!p.done;p=l.next()){a[y=p.value]?s.push(y):this.statusMap[y]=r.None}}catch(t){e={error:t}}finally{try{p&&!p.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}this.queued.length=0,this.queued.push.apply(this.queued,s);var h=[];try{for(var f=c(this.active),d=f.next();!d.done;d=f.next()){var y;a[y=d.value]?h.push(y):this.statusMap[y]=r.None}}catch(t){i={error:t}}finally{try{d&&!d.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}this.active.length=0,this.active.push.apply(this.active,h)},t.prototype.onRendered=function(t){this.statusMap[t]=r.Rendered},t}(),h=n(8),f=Object.freeze({prerender:{preRenderTourPanos:h.q("pre",1)}}),d=(l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},v=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="prerenderer-module",e.lastPrerendered=null,e}return d(e,t),e.prototype.init=function(t,e){return y(this,void 0,void 0,function(){var n,r,u=this;return v(this,function(c){switch(c.label){case 0:return f.prerender.preRenderTourPanos||t.preRenderTourPanos?(n=this,[4,e.market.waitForData(o.a)]):[3,3];case 1:return n.sweepData=c.sent(),r=this,[4,e.getModuleByParent(i.Xa)];case 2:r.panoRenderer=c.sent().getRenderer(),this.preRenderer=new p(this.panoRenderer),e.addComponent(this,this.preRenderer),this.bindings.push(e.subscribe(a.a,function(t){u.preRenderer.enablePreRendering(),u.lastPrerendered=null,t.sweepIds&&t.sweepIds.length>=3&&(u.lastPrerendered=t.sweepIds[2],u.preRenderer.tryPreRender(u.lastPrerendered)),u.cleanup(u.sweepData),u.currentRestrictedSweeps=t.sweepIds})),this.bindings.push(e.subscribe(s.a,function(t){u.preRenderer.disablePreRendering(),u.cleanup(u.sweepData,!0),u.currentRestrictedSweeps=null})),c.label=3;case 3:return[2]}})})},e.prototype.getCurrentSweeps=function(){return this.currentRestrictedSweeps||[]},e.prototype.cleanup=function(t,e){void 0===e&&(e=!1);var n=[];t.transition.active?(t.transition.from&&n.push(t.transition.from),t.transition.to&&n.push(t.transition.to)):t.currentSweep&&n.push(t.currentSweep),this.lastPrerendered&&n.push(this.lastPrerendered),e&&this.panoRenderer.freeAllTextures(n),this.preRenderer.cleanup(n)},e}(i.Fa);e.default=g},1109:function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(624),a=function(){function t(){}return t.prototype.load=function(t){this.data=t,this.sid=this.data.sid,this.uuid=this.data.job.uuid,this.vrSupported=this.data.is_vr},t}(),s=n(113),u=n(149),c=n(3),l=n(95),p=n(96),h=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},f=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},d=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},y=new c.a("modelurls"),v=function(){function t(){this.version=1,this.cache=null,this.expires=0}return t.prototype.validate=function(t){return"catalog.json"in t&&Object.keys(t).length>0},t.prototype.update=function(t){return this.cache=t,this.expires=Date.now()+u.a.signedUrlDefaultExpireTime,Promise.resolve()},t.prototype.get=function(t){return this.cache[t]},t}(),g=function(){function t(){this.version=2,this.baseUrl="",this.cache=null,this.expires=0}return t.prototype.validate=function(t){return"catalog.json"in t&&"base.url"in t&&Object.keys(t).length>1},t.prototype.update=function(t){return this.baseUrl=t["base.url"],this.cache=t,this.expires=Date.now()+u.a.signedUrlDefaultExpireTime,Promise.resolve()},t.prototype.get=function(t){var e=this.cache[t];if(!e)throw Error("URL path not found: "+t);return this.baseUrl.replace("{{filename}}",t)+e},t}(),w=function(){function t(){this.version=3,this.baseUrl="",this.expires=0}return t.prototype.validate=function(t){return t.templates&&t.catalog_file&&(!t.expires||1e3*t.expires>Date.now())},t.prototype.update=function(t){if(!t.templates)throw new Error("No templates found.");return this.baseUrl=t.templates[0],t.expires?this.expires=1e3*t.expires:this.expires=Date.now()+u.a.signedUrlDefaultExpireTime,Promise.resolve()},t.prototype.get=function(t){return this.baseUrl&&this.baseUrl.replace("{{filename}}",t)},t}(),m=function(){function t(t,e){this.api=t,this.endpoint=e,this.urlContainer=null,this.authorizationHeader=Object(l.a)(),this.previousRefreshPromise=null,this.containerClasses=[w,g,v],this.endpoint=e+"?type=3"}return t.prototype.needsRefresh=function(){var t=this.urlContainer?this.urlContainer.expires:Date.now();return Date.now()+u.a.signedUrlRefreshBuffer>t},t.prototype.refresh=function(){if(!this.needsRefresh())return Promise.resolve();if(!this.previousRefreshPromise){y.debug("Refreshing urls...");var t=this;this.previousRefreshPromise=this._refresh().then(function(){y.debug("Refreshed"),t.previousRefreshPromise=null},function(){y.error("Failed url refresh, urls might go stale soon"),t.previousRefreshPromise=null})}return this.previousRefreshPromise},t.prototype._refresh=function(t){return void 0===t&&(t=!0),h(this,void 0,Promise,function(){var e,n,r,i,o,a,s;return f(this,function(u){switch(u.label){case 0:return[4,this.api.get(this.endpoint,{responseType:"json",prefetchFrom:t?"files":void 0,auth:this.authorizationHeader,priority:p.RequestPriority.HIGHEST})];case 1:if(r=u.sent(),this.urlContainer&&this.urlContainer.validate(r))return[2,this.urlContainer.update(r)];try{for(i=d(this.containerClasses),o=i.next();!o.done;o=i.next())if(a=o.value,(s=new a).validate(r))return y.info("Using urls version "+s.version),this.urlContainer=s,[2,this.urlContainer.update(r)]}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}if(t)return[2,this._refresh(!1)];throw new Error("missing-urls")}})})},t.prototype.getSignedUrl=function(t){return h(this,void 0,Promise,function(){var e;return f(this,function(n){switch(n.label){case 0:return[4,this.refresh()];case 1:if(n.sent(),!this.urlContainer)throw new Error("Tried to use ModelUrls.get before urlContainer is established.");if(!(e=this.urlContainer.get(t)))throw new Error("Could not get signed URL for path "+t);return[2,e]}})})},t.prototype.getFile=function(t,e,n){return h(this,void 0,Promise,function(){var r,i;return f(this,function(o){switch(o.label){case 0:return i=l.d,[4,this.getSignedUrl(t)];case 1:return r=i.apply(void 0,[o.sent(),n]),[2,this.api.get(r,e)]}})})},t.prototype.getImage=function(t,e,n){return h(this,void 0,Promise,function(){var r,i;return f(this,function(o){switch(o.label){case 0:return i=l.d,[4,this.getSignedUrl(t)];case 1:return r=i.apply(void 0,[o.sent(),n]),[2,this.api.getImage(r,e)]}})})},t.prototype.getImageBitmap=function(t,e,n,r,i){return h(this,void 0,Promise,function(){var o,a;return f(this,function(s){switch(s.label){case 0:return a=l.d,[4,this.getSignedUrl(t)];case 1:return o=a.apply(void 0,[s.sent(),i]),[2,this.api.getImageBitmap(o,e,n,r)]}})})},t}(),b=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),T=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},_=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="model-data",e}return b(e,t),e.prototype.init=function(t,e){return T(this,void 0,void 0,function(){var n,r,u,c;return _(this,function(l){switch(l.label){case 0:return[4,e.getModule(i.a)];case 1:return n=l.sent(),r=n.getApi(),[4,t.modelDetailsStore.read()];case 2:return u=l.sent(),this.model=new a,this.model.load(u),this.signedUrls=new m(r,r.baseUrl+"/api/player/models/"+t.sid+"/files"),[4,e.market.waitForData(s.a)];case 3:return c=l.sent(),e.broadcast(new o.a(this.signedUrls,this.model.sid,this.model.vrSupported,c.getSweepList())),[2]}})})},e.prototype.getModel=function(){return this.model},e.prototype.getSignedUrls=function(){return this.signedUrls},e}(i.U);e.default=S},1110:function(t,e,n){"use strict";n.r(e);var r,i=n(3),o=n(8),a=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},s=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},u=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},c=new i.a("api"),l=function(){function t(t,e){this.api=t,this.baseUrl=e,this.loggedIn=!1}return t.prototype.load=function(){return a(this,void 0,Promise,function(){var t,e,n,r,i,a,l,p,h,f,d,y,v,g;return s(this,function(s){switch(s.label){case 0:i=this.baseUrl+"/api/v1/user/",s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.api.get(i,{responseType:"json"})];case 2:return a=s.sent(),[3,4];case 3:throw l=s.sent(),c.error("Failed to get User data"),l;case 4:if(this.sid=a.user_sid,this.firstName=a.first_name,this.lastName=a.last_name,this.email=a.email,this.loggedIn=!!a.user_sid,this.flags=new Set(a.flags),a.memberships){p=Object(o.q)("organization","");try{for(h=u(a.memberships),f=h.next();!f.done;f=h.next())if(d=f.value,""===p||d.organization_sid===p)try{for(y=u(d.flags),v=y.next();!v.done;v=y.next())g=v.value,this.flags.add(g)}catch(t){n={error:t}}finally{try{v&&!v.done&&(r=y.return)&&r.call(y)}finally{if(n)throw n.error}}}catch(e){t={error:e}}finally{try{f&&!f.done&&(e=h.return)&&e.call(h)}finally{if(t)throw t.error}}}return[2]}})})},t.prototype.getFlags=function(t){void 0===t&&(t="");var e=new Set;return this.flags.forEach(function(n){if(0===n.indexOf(t)){var r=n.replace(t,"");e.add(r)}}),e},t}(),p=n(95),h=n(96),f=n(19),d=function(){return(d=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},y=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},v=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},g=new i.a("api"),w=Object.freeze({cacheClearTimeout:6e4,retryTimeout:1e3}),m=function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=window.location.origin);var n=this;this.prefetchedData=t,this.baseUrl=e,this._configCache={},this.queue=new h.RequestQueue({retries:0}),setTimeout(function(){n.prefetchedData={}},w.cacheClearTimeout),this.needAuth={}}return t.prototype.init=function(t){return y(this,void 0,void 0,function(){var e;return v(this,function(n){switch(n.label){case 0:return this.user=new l(this,this.baseUrl),e=[this.user.load()],t&&e.push(this.getConfigs(t)),[4,Promise.all(e)];case 1:return n.sent(),[2]}})})},t.prototype.get=function(t,e){var n=this;if(e&&e.prefetchFrom&&this.prefetchedData[e.prefetchFrom])return Promise.resolve(this.prefetchedData[e.prefetchFrom]);var r=d({},e);this.needAuth[t]&&(r=this.addAuthToOptions(e));var i=this.queue.get(t,r).then(function(e){if(null===e)throw Error("Data from get was null, possibly unparsable JSON");return n.needAuth[t]=!1,e}).catch(function(e){return!n.needAuth[t]&&e.status_code>=400&&e.status_code<500?(r=n.addAuthToOptions(r),n.queue.get(t,r).then(function(e){return n.needAuth[t]=!0,e})):i});return i},t.prototype.addAuthToOptions=function(t){return this.authToken||(this.authToken=Object(p.a)()),d({},t,{auth:this.authToken})},t.prototype.getImage=function(t,e){return this.get(t,d({},e,{responseType:"image"}))},t.prototype.getImageBitmap=function(t,e,n,r){return void 0===r&&(r={}),y(this,void 0,Promise,function(){var i,o,a;return v(this,function(s){switch(s.label){case 0:return"createImageBitmap"in window?(i=-1!==t.indexOf("?"),o=t+(i?"&":"?")+"imgopt=1",[4,this.get(o,d({},r,{responseType:"blob"}))]):[3,2];case 1:return a=s.sent(),[2,createImageBitmap(a,0,0,e,n,{imageOrientation:r.flipY?"flipY":"none"})];case 2:return[2,this.getImage(t,r)]}})})},t.prototype.getImageViaBrowser=function(t,e){void 0===e&&(e=3);var n=new f.a,r=new Image,i=this,o=function(){i.getImageViaBrowser(t,e-1).then(n.resolve.bind(n)).progress(n.notify.bind(n)).catch(n.reject.bind(n))};return r.onerror=function(){e>0?setTimeout(o,1e3):n.reject()},r.onload=function(){n.resolve(r)},r.crossOrigin="anonymous",r.src=t,n.promise()},t.prototype.getConfigs=function(t,e){return y(this,void 0,Promise,function(){var n,r,i,o,a;return v(this,function(s){switch(s.label){case 0:if(t=t.toLowerCase(),!e&&this._configCache[t])return[2,this._configCache[t]];n=e?{responseType:"json"}:{responseType:"json",prefetchFrom:"config"},r=Object(p.c)(),i=Object(p.e)(r),o={},a=i.urlBase+"/api/v1/config/"+t,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.get(a,n)];case 2:return o=s.sent(),[3,4];case 3:return s.sent(),g.warn("Failed to load config from "+a+", ignoring"),[3,4];case 4:return e||(this._configCache[t]=o),[2,o||{}]}})})},t.prototype.getAppKey=function(t,e,n){return y(this,void 0,Promise,function(){var r;return v(this,function(i){switch(i.label){case 0:return""===t||""===e?[2,null]:[4,this.getConfigs(t,n)];case 1:return(r=i.sent()).hasOwnProperty(e)?[2,r[e]]:[2,null]}})})},t}(),b=n(0),T=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),_=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},S=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="api-client",e}return T(e,t),e.prototype.init=function(t,e){return _(this,void 0,void 0,function(){return S(this,function(e){switch(e.label){case 0:return this.api=new m(t.prefetchedData,t.baseUrl),[4,this.api.init(t.preloadConfig)];case 1:return e.sent(),[2]}})})},e.prototype.getApi=function(){return this.api},e}(b.a);e.default=D},1115:function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(33),a=n(152),s=n(529),u=n(402),c=n(479),l=n(48),p=n(7),h=n(1),f=n(72),d=n(322),y=n(332),v=n(330),g=n(11),w=n(51),m=n(528),b=n(442),T=n(401),_=n(441),S=n(321),D=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),P=function(t){function e(e,n){var r=this,i=e.max,o=e.min,a=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1];a[0]=i.x,a[1]=i.y,a[2]=i.z,a[3]=o.x,a[4]=i.y,a[5]=i.z,a[6]=o.x,a[7]=o.y,a[8]=i.z,a[9]=i.x,a[10]=o.y,a[11]=i.z,a[12]=i.x,a[13]=i.y,a[14]=o.z,a[15]=o.x,a[16]=i.y,a[17]=o.z,a[18]=o.x,a[19]=o.y,a[20]=o.z,a[21]=i.x,a[22]=o.y,a[23]=o.z;var s=void 0!==n?n:16776960,u=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),c=new y.a;return c.setIndex(new v.a(u,1)),c.addAttribute("position",new v.b(a,3)),c.computeBoundingSphere(),(r=t.call(this,c,new T.a({color:s}))||this).box=e,r}return D(e,t),e.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),S.a.prototype.updateMatrixWorld.call(this,t))},e}(b.a),x=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),E=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},R=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},O=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(R(arguments[e]));return t},M=new g.a,A=function(){function t(){this.parent=null,this.raycastDistance=1/0}return t.prototype.updateRaycastDistance=function(t){this.raycastDistance=this.bounds.distanceToPoint(t)},t}(),C=function(t){function e(e,n){var r=t.call(this)||this;return r.mesh=e,r.geometry=r.makeGeometryFromFaces(n),r}return x(e,t),e.prototype.makeGeometryFromFaces=function(t){var e,n,r=new Float32Array(9*t.length),i=0,o={};try{for(var a=E(t),s=a.next();!s.done;s=a.next()){var u=s.value;(p=o[u.materialIndex])||(p=o[u.materialIndex]={start:i/3,count:0,materialIndex:u.materialIndex}),p.count+=3,r[i++]=u.ax,r[i++]=u.ay,r[i++]=u.az,r[i++]=u.bx,r[i++]=u.by,r[i++]=u.bz,r[i++]=u.cx,r[i++]=u.cy,r[i++]=u.cz}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}var c=new y.a;for(var l in c.addAttribute("position",new v.a(r,3)),c.computeBoundingBox(),c.boundingSphere=c.boundingBox.getBoundingSphere(new w.a),o){var p=o[l];c.addGroup(p.start,p.count,p.materialIndex)}return c},Object.defineProperty(e.prototype,"bounds",{get:function(){return this.geometry.boundingBox},enumerable:!0,configurable:!0}),e.prototype.raycast=function(t,e){var n,r,i=this.mesh.geometry,o=this.mesh.matrixWorld,a=this.mesh.matrix;this.mesh.geometry=this.geometry,this.mesh.matrix=M,this.mesh.matrixWorld=M;var s=[];function u(t,e){var n,r;if(0===e.length)return 0;try{for(var i=E(e),o=i.next();!o.done;o=i.next()){var a=o.value;if(a.start<=t&&a.start+a.count>t)return a.materialIndex}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}throw new Error("This vertex is not in this group, how could this happen?")}this.mesh.raycast(t,s);try{for(var c=E(s),l=c.next();!l.done;l=c.next()){var p=l.value;p.face&&p.faceIndex&&(p.face.materialIndex=u(p.face.a,this.mesh.geometry.groups)||0),e.push(p)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}this.mesh.geometry=i,this.mesh.matrix=a,this.mesh.matrixWorld=o},e}(A),I=function(t){function e(e){var n=t.call(this)||this;return n.mesh=e,n._bounds=new f.a,n.mesh.geometry.boundingBox||n.mesh.geometry.computeBoundingBox(),n}return x(e,t),Object.defineProperty(e.prototype,"bounds",{get:function(){return this._bounds.copy(this.mesh.geometry.boundingBox).applyMatrix4(this.mesh.matrixWorld)},enumerable:!0,configurable:!0}),e.prototype.raycast=function(t,e){this.mesh.visible&&this.mesh.raycast(t,e)},e}(A),k=function(){return function(t,e,n,r,i,o,a,s,u,c){this.materialIndex=t,this.ax=e,this.ay=n,this.az=r,this.bx=i,this.by=o,this.bz=a,this.cx=s,this.cy=u,this.cz=c,this.bounds=new f.a(new h.a(Math.min(e,i,s),Math.min(n,o,u),Math.min(r,a,c)),new h.a(Math.max(e,i,s),Math.max(n,o,u),Math.max(r,a,c)))}}(),U=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.level=n,o.leafMinSize=r,o.leafMaxFaces=i,o.childNodes=[],o.children=[],o.listeners={},o.bounds=e.clone(),o.size=e.getSize(new h.a),o}return x(e,t),e.prototype.addMeshes=function(t){var e=this;t.updateMatrixWorld(!0),t.traverse(function(t){if(t instanceof d.a){var n=new I(t);if(t.geometry instanceof y.a&&e.bounds.containsBox(n.bounds)){var r=e.geometryToFaces(t.geometry,t.matrixWorld);e.addFaces(t,r)}else e.addMesh(n)}})},e.prototype.removeMeshes=function(t){for(var e=!1,n=0;n<this.children.length;n++){var r=this.children[n];(r instanceof I||r instanceof C)&&r.mesh.id===t.id&&(r.parent=null,this.children.splice(n,1),this.emit("removed",this,r),e=!0)}if(!e)throw new Error("Mesh that is being attempted removed does not exist in this node.")},e.prototype.addMesh=function(t){var e,n,r=!1;if(this.size.length()>this.leafMinSize){0===this.childNodes.length&&this.buildChildNodes();try{for(var i=E(this.childNodes),o=i.next();!o.done;o=i.next()){var a=o.value;a.bounds.containsBox(t.bounds)&&(r=!0,a.addMesh(t))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}r||this.add(t)},e.prototype.add=function(t){if(t.parent)throw new Error("ColliderNode already has a parent, remove before trying to add in another node");t.parent=this,this.children.push(t),this.emit("added",this,t)},e.prototype.addFaces=function(t,e){if(e.length>this.leafMaxFaces&&this.size.length()>this.leafMinSize)0===this.childNodes.length&&this.buildChildNodes(),this.splitFaces(t,e);else if(e.length>0){var n=new C(t,e);n.bounds.intersect(this.bounds),this.addMesh(n)}},e.prototype.splitFaces=function(t,e){var n,r,i,o;try{for(var a=E(this.childNodes),s=a.next();!s.done;s=a.next()){var u=s.value,c=[];try{for(var l=E(e),p=l.next();!p.done;p=l.next()){var h=p.value;u.bounds.intersectsBox(h.bounds)&&c.push(h)}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}u.addFaces(t,c)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}},e.prototype.buildChildNodes=function(){for(var t=this.size.multiplyScalar(.5),n=0;n<2;n++)for(var r=0;r<2;r++)for(var i=0;i<2;i++){var o=this.bounds.min.x+t.x*i,a=o+t.x,s=this.bounds.min.y+t.y*n,u=s+t.y,c=this.bounds.min.z+t.z*r,l=c+t.z,p=new e(new f.a(new h.a(o,s,c),new h.a(a,u,l)),this.level+1,this.leafMinSize,this.leafMaxFaces);this.childNodes.push(p),this.add(p)}},e.prototype.raycast=function(t,e){var n,r;if(!0===t.ray.intersectsBox(this.bounds))try{for(var i=E(this.children),o=i.next();!o.done;o=i.next()){o.value.raycast(t,e)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.pick=function(t,n,r){var i,o,a,s;if(!t.ray.intersectsBox(this.bounds))return n;try{for(var u=E(this.children),c=u.next();!c.done;c=u.next()){(h=c.value).updateRaycastDistance(t.ray.origin)}}catch(t){i={error:t}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}this.children.sort(function(t,e){return t.raycastDistance-e.raycastDistance});try{for(var l=E(this.children),p=l.next();!p.done;p=l.next()){var h=p.value;if(n&&n.distance<h.raycastDistance)break;if(r(h))if(h instanceof e)n=h.pick(t,n,r);else{var f=[];h.raycast(t,f),f.length>0&&(!n||n.distance>f[0].distance)&&(n=f[0])}}}catch(t){a={error:t}}finally{try{p&&!p.done&&(s=l.return)&&s.call(l)}finally{if(a)throw a.error}}return n},e.prototype.geometryToFaces=function(t,e){var n,r,i,o,a=t.getAttribute("position");if(a instanceof m.a)throw new Error("InterleavedBufferAttribute not supported");e.equals(M)||(a=a.clone(),e.applyToBufferAttribute(a));var s,u=a.array;if(t.index){var c=t.index.array;s=new Array(c.length/3);var l=0,p=t.groups.length>0?t.groups:[{start:0,count:c.length,materialIndex:0}];try{for(var h=E(p),f=h.next();!f.done;f=h.next())for(var d=(T=f.value).start;d<T.start+T.count;d+=3){var y=3*c[d],v=3*c[d+1],g=3*c[d+2];s[l++]=new k(T.materialIndex||0,u[y],u[y+1],u[y+2],u[v],u[v+1],u[v+2],u[g],u[g+1],u[g+2])}}catch(t){n={error:t}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}}else{s=new Array(u.length/9);l=0,p=t.groups.length>0?t.groups:[{start:0,count:u.length/3,materialIndex:0}];try{for(var w=E(p),b=w.next();!b.done;b=w.next()){var T;for(d=3*(T=b.value).start;d<3*(T.start+T.count);d+=9)s[l++]=new k(T.materialIndex||0,u[d],u[d+1],u[d+2],u[d+3],u[d+4],u[d+5],u[d+6],u[d+7],u[d+8])}}catch(t){i={error:t}}finally{try{b&&!b.done&&(o=w.return)&&o.call(w)}finally{if(i)throw i.error}}}return s},e.prototype.getAllBounds=function(t){var n,r;try{for(var i=E(this.children),o=i.next();!o.done;o=i.next()){var a=o.value;t.push(a.bounds.clone()),a instanceof e&&a.getAllBounds(t)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.emit=function(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var a=this.listeners[t]||[];try{for(var s=E(a),u=s.next();!u.done;u=s.next()){u.value.apply(void 0,O(i))}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}this.parent&&(r=this.parent).emit.apply(r,O([t],i))},e.prototype.on=function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},e}(A),L=function(){function t(t,e,n){var r=this;this.meshToNodes={};var i=Object(p.o)(t);this.root=new U(i,0,e,n),this.root.on("added",function(t,e){(e instanceof I||e instanceof C)&&(r.meshToNodes[e.mesh.id]||(r.meshToNodes[e.mesh.id]=[]),r.meshToNodes[e.mesh.id].push(e))}),this.root.on("removed",function(t,e){if(e instanceof I||e instanceof C)for(var n=r.meshToNodes[e.mesh.id],i=0;i<n.length;i++)n[i]===e&&n.splice(i,1)})}return t.prototype.addMeshes=function(t){this.root.addMeshes(t)},t.prototype.removeMeshes=function(t){var e=this;t.traverse(function(t){var n,r,i=e.meshToNodes[t.id]||[];try{for(var o=E(i),a=o.next();!a.done;a=o.next()){var s=a.value;s.parent&&s.parent.removeMeshes(t)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}})},t.prototype.raycast=function(t){var e=[];return this.root.raycast(t,e),e},t.prototype.getAllBounds=function(){var t=[];return this.root.getAllBounds(t),t},t.prototype.pick=function(t,e){return this.root.pick(t,null,function(t){return!e||!(t instanceof I||t instanceof C)||e(t.mesh)&&t.mesh.visible})},t.prototype.getDebugMesh=function(){var t,e,n=this.getAllBounds(),r=[];try{for(var i=E(n),o=i.next();!o.done;o=i.next()){var a=o.value,s=new P(a);r.push(s.geometry)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}var u=Object(_.a)(r);return new b.a(u,new T.a({color:16777215}))},t}(),j=n(91),N=n(49),z=n(334),F=n(10),B=n(615),G=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),H=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},Q=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}G(e,t)}(d.a),function(){function t(t,e,n,r){this.camera=t,this.cameraData=e,this.settings=n,this.renderer=r,this.meshes={},this.meshGroups={},this.groupMeshes={},this.groupEnabled={},this.octreeEnabledMeshes={},this.raycaster=new B.a,this.pointer=new j.a(-2,-2),this.prevRay=new z.a,this.gamepadClicked=!1,this.screenCenter=new j.a,this.lookDirection=new h.a,this.controllerOrientation=new F.a,this.rayDirection=new h.a,this.rayOrigin=new h.a,this.gamePad=null,this.selectedObject=null,this.callbackSets={},this._pointerHits=[],this._hitCache=[],this.realNorm=new N.a}return t.prototype.render=function(){},t.prototype.init=function(){},t.prototype.activate=function(t){var e=this;this.engine=t,t.market.waitForData(a.a).then(function(t){return e.interactionmodeData=t}),this.settings.registerButton("Octree","Visualize",function(){var t=e.octree.getDebugMesh();t.updateMatrixWorld(!0),e.renderer.getScene().scene.add(t)})},t.prototype.dispose=function(){this.meshes={},this.callbackSets={}},t.prototype.deactivate=function(t){},t.prototype.beforeRender=function(){var t,e;if(this.prevRay.copy(this.raycaster.ray),this.interactionmodeData&&(this.updateRay(this.cameraData.pose.position,this.interactionmodeData.mode),this.interactionmodeData.hasController&&null===this.gamePad&&(this.gamePad=Object(c.a)())),this.gamePad)try{for(var n=H(this.gamePad.buttons),r=n.next();!r.done;r=n.next()){if(r.value.pressed){this.gamepadClicked=!0;break}}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this._pointerHits=this.cast().slice();var i=this._pointerHits.length>0;if(i){var o=this._pointerHits[0];if(o&&o.face){this.onMeshRayOver(o.object);var a=o.face.normal;this.realNorm.set(a.x,a.y,a.z,0),this.realNorm.applyMatrix4(o.object.matrixWorld);var l=new u.a(o.point.clone(),new h.a(this.realNorm.x,this.realNorm.y,this.realNorm.z),o.object);this.engine.broadcast(new s.b(l))}}else this.engine.broadcast(new s.b(null));!i&&this.selectedObject&&this.onMeshRayOut()},t.prototype.ray=function(){return this.raycaster.ray},t.prototype.cast=function(t,e,n){var r=this;if(t&&e&&(this.prevRay.copy(this.raycaster.ray),this.raycaster.set(t,e)),this.prevRay.equals(this.raycaster.ray)){if(this.gamepadClicked)(i=this._pointerHits[0])&&i.face&&(this.onMeshClick(i.object,i),this.engine.broadcast(new s.a)),this.gamepadClicked=!1;return this._hitCache}this._hitCache.length=0;var i;this.octree&&((i=this.octree.pick(this.raycaster,function(t){var e=r.meshGroups[t.id];return!(!r.octreeEnabledMeshes[t.id]||!(e&&r.groupEnabled[e]||n&&n.length>0&&-1!==n.indexOf(e)))}))&&this._hitCache.push(i));for(var o in this.meshes){var a=this.meshGroups[o];if(!this.octreeEnabledMeshes[o]&&(a&&this.groupEnabled[a]||n&&n.length>0&&-1!==n.indexOf(a))){var u=this.meshes[o],c=this.raycaster.intersectObject(u,!0);this._hitCache=this._hitCache.concat(c)}}return this._hitCache.sort(function(t,e){return t.distance>e.distance?1:t.distance<e.distance?-1:0}),this.prevRay.copy(this.raycaster.ray),this._hitCache},Object.defineProperty(t.prototype,"hits",{get:function(){return this._pointerHits},enumerable:!0,configurable:!0}),t.prototype.setupOctree=function(t){var e,n;this.octree=new L(t.boundingBox,.5,200);try{for(var r=H(Object.keys(this.meshes)),i=r.next();!i.done;i=r.next()){var o=i.value;if(this.octreeEnabledMeshes[o]){var a=this.meshes[o];this.octree.addMeshes(a)}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.updateRay=function(t,e){switch(e){case o.b.Desktop:case o.b.Mobile:this.rayOrigin.set(this.pointer.x,this.pointer.y,-1).unproject(this.camera),this.rayDirection.set(this.pointer.x,this.pointer.y,1).unproject(this.camera),this.raycaster.set(this.rayOrigin,this.rayDirection.sub(this.rayOrigin).normalize());break;case o.b.VrOrientOnly:this.raycaster.setFromCamera(this.screenCenter,this.camera);break;case o.b.VrWithController:case o.b.VrWithTrackedController:if(this.raycaster.ray.origin.copy(t),this.gamePad){var n=this.controllerOrientation.fromArray(this.gamePad.pose.orientation),r=this.lookDirection.copy(l.a.FORWARD).applyQuaternion(n);this.raycaster.ray.direction.copy(r)}}},t.prototype.createCallbackSet=function(){return{click:void 0,select:void 0,deselect:void 0}},t.prototype.addTarget=function(t,e,n,r){void 0===r&&(r="default-group");var i=t,o=i.collider?i.collider:t;this.meshes[t.id]=o,n&&(this.callbackSets[t.id]=n),this.meshGroups[t.id]=r;var a=this.groupEnabled[r];null==a&&this.enableForGroup(r,!0);var s=this.groupMeshes[r];s||(this.groupMeshes[r]=s=[]),this.octreeEnabledMeshes[t.id]=e,this.octree&&e&&this.octree.addMeshes(t)},t.prototype.enableAllGroups=function(){for(var t in this.groupEnabled)this.enableForGroup(t,!0)},t.prototype.enableForGroup=function(t,e){this.groupEnabled[t]=e},t.prototype.setExclusiveMode=function(t){for(var e in this.groupEnabled)this.enableForGroup(e,!1);this.enableForGroup(t,!0)},t.prototype.removeTarget=function(t){this.octree&&this.octreeEnabledMeshes[t.id]&&this.octree.removeMeshes(t);var e=this.meshGroups[t.id];if(e)for(var n=this.groupMeshes[e],r=0;r<n.length;r++)if(n[r].id===t.id){n[r]=n[n.length-1],n.length--;break}delete this.meshes[t.id],delete this.callbackSets[t.id]},t.prototype.onMeshClick=function(t,e){if(t){var n=this.getCallbackSet(t,!0);n&&n.click&&n.click(t,e)}},t.prototype.onMeshRayOver=function(t){if(this.selectedObject!==t&&(this.onMeshRayOut(),this.selectedObject=t,this.selectedObject)){var e=this.getCallbackSet(this.selectedObject,!1);e&&e.select&&e.select(this.selectedObject)}},t.prototype.onMeshRayOut=function(){if(this.selectedObject){var t=this.getCallbackSet(this.selectedObject,!1);t&&t.deselect&&t.deselect(this.selectedObject),this.selectedObject=null}},t.prototype.updatePointerPosition=function(t){this.pointer.distanceToSquared(t)>2e-5&&this.pointer.set(t.x,t.y),this.interactionmodeData&&this.updateRay(this.cameraData.pose.position,this.interactionmodeData.mode)},t.prototype.onClick=function(){this.gamepadClicked=!0},t.prototype.getCallbackSet=function(t,e){var n=this.callbackSets[t.id];if(e)for(;!n&&t.parent;)t=t.parent,n=this.callbackSets[t.id];return n},t}()),V=n(312),W=n(61),X=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),q=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},Y=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Z=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="raycaster",e.raycasterData=new u.b,e}return X(e,t),e.prototype.init=function(t,e){return q(this,void 0,void 0,function(){var t,n,r,o,a=this;return Y(this,function(c){switch(c.label){case 0:return e.market.register(this,u.b),e.market.update(this,this.raycasterData),[4,e.getModule(i.qb)];case 1:return t=c.sent(),[4,e.getModule(W.default)];case 2:return n=c.sent(),r=t.getScene(),[4,e.market.waitForData(V.a)];case 3:return o=c.sent(),this.raycaster=new Q(r.camera,o,n,t),this.bindings.push(e.subscribe(s.b,function(t){a.raycasterData.hit=t.hit,e.market.update(a,a.raycasterData)})),e.addComponent(this,this.raycaster),[2]}})})},e.prototype.getRaycaster=function(){return this.raycaster},e.prototype.getRaycastHits=function(){return this.raycaster.hits},e.prototype.cast=function(t,e,n){return void 0===n&&(n=[]),this.raycaster.cast(t,e,n)},e}(i.Ha);e.default=Z},1116:function(t,e,n){"use strict";n.r(e);var r,i,o=n(320),a=n(538),s=n(0),u=n(312),c=n(485),l=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e}(c.a),h=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e}(c.a),d=n(19),y=n(94),v=n(484),g=n(59),w=n(336),m=n(7),b=n(54),T=n(39),_=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),S=function(){return(S=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},D=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},P=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},x=((i={})[T.a.Instant]={blackoutTime:0,transitionTime:0},i[T.a.FadeToBlack]={blackoutTime:v.a.camera.transitionBlackoutTime,transitionTime:2*v.a.camera.transitionBlackoutTime},i[T.a.Interpolate]={blackoutTime:0,transitionTime:v.a.camera.transitionFadeTime},i),E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="camera-data",e}return _(e,t),e.prototype.init=function(t,e){return D(this,void 0,void 0,function(){var n,r=this;return P(this,function(i){switch(i.label){case 0:return this.engine=e,this.market=e.market,n=this,[4,e.market.waitForData(w.a)];case 1:return n.canvas=i.sent(),this.cameraData=new u.a(this.canvas.width,this.canvas.height),this.market.register(this,u.a,this.cameraData),this.baseTransitionTime=t.baseTransitionTime||v.a.camera.baseTransitionTime,e.market.waitForData(g.a).then(function(t){t.onPropertyChanged(s.wb,function(t){r.baseTransitionTime=t})}),this.bindings.push(e.subscribe(a.a,function(t){return r.cameraData.setCameraDimensions(t.width,t.height)})),this.transitionSpeed=t.transitionSpeed||v.a.camera.transitionSpeed,[2]}})})},e.prototype.getData=function(t){return void 0===t&&(t=!0),t?Object.freeze(this.cameraData.clone()):this.cameraData},e.prototype.onUpdate=function(t){var e=this.market.tryGetData(u.a);e&&!this.cameraData.isEqual(e)&&this.market.update(this,this.cameraData)},e.prototype.fromPose=function(){return{position:this.cameraData.pose.position.clone(),rotation:this.cameraData.pose.rotation.clone(),projection:this.cameraData.pose.projection.clone()}},e.prototype.updateCameraProjection=function(t){t&&(this.cameraData.pose.projection.copy(t),this.broadcastCameraMoved({projection:t}))},e.prototype.updateCameraFocus=function(t){this.cameraData.pose.focalDistance=t},e.prototype.updateCameraRotation=function(t){t&&(this.cameraData.pose.rotation.copy(t),this.broadcastCameraMoved({rotation:t}))},e.prototype.updateCameraPosition=function(t){t&&(this.cameraData.pose.position.copy(t),this.broadcastCameraMoved({position:t}))},e.prototype.broadcastCameraMoved=function(t){var e=this.fromPose(),n=S({},e,t);this.engine.broadcast(new c.a(n,e))},e.prototype.updateCameraPose=function(t){t.position&&(this.cameraData.pose.position.copy(t.position),this.broadcastCameraMoved({position:t.position})),t.rotation&&(this.cameraData.pose.rotation.copy(t.rotation),this.broadcastCameraMoved({rotation:t.rotation}))},e.prototype.canMove=function(){return this.cameraData.canTransition()},e.prototype.moveTo=function(t){if(this.cameraData.transition.active)return d.a.reject("Cannot move while the camera is already moving");var e=x[t.transitionType],n=e.blackoutTime,r=t.pose.rotation,i=t.pose.position,a=t.projection;t.pose.zoom&&(a&&Object(o.o)(a)||this.cameraData.isOrtho())&&(a=this.adjustProjectionZoom(a||this.cameraData.pose.projection.clone(),t.pose.zoom));var s=t.transitionType===T.a.Instant?0:t.transitionTime;if(void 0===s)if(t.transitionType===T.a.Interpolate&&i){var u=i.distanceTo(this.cameraData.pose.position);s=this.baseTransitionTime+166*Math.log2(1+u)*this.transitionSpeed}else s=e.transitionTime;this.beginInternalTransition({transitionType:t.transitionType,transitionTime:s,blackoutTime:n,pose:{position:i,rotation:r},projection:a,easing:t.easing,rotationDelay:t.rotationDelay||0,rotationDuration:t.rotationDuration||1,matrixDelay:t.matrixDelay||0,matrixDuration:t.matrixDuration||1});var c={position:t.pose.position?t.pose.position.clone():void 0,rotation:t.pose.rotation?t.pose.rotation.clone():void 0,projection:t.projection?t.projection.clone():void 0},l=this.fromPose();this.engine.broadcast(new p(c,l));var h=new d.a,y=this.progressInternalTransition.bind(this),v=this.endInternalTransition.bind(this),g=this;return h.notify(0),this.engine.startGenerator(function(){var e,r;return P(this,function(i){switch(i.label){case 0:return(e=16)>=g.cameraData.transition.duration?(h.notify(.5),[4,new b.b]):[3,2];case 1:i.sent(),i.label=2;case 2:return e<g.cameraData.transition.duration?(y(e,n),r=Object(m.f)(e/g.cameraData.transition.duration,0,1),h.notify(r),[4,new b.b]):[3,4];case 3:return i.sent(),e=16+Date.now()-g.cameraData.transition.startTime,[3,2];case 4:return v(t.transitionType),t.focalDistance&&g.updateCameraFocus(t.focalDistance),g.market.update(g,g.cameraData),h.notify(1),h.resolve(),g.engine.broadcast(new f(c,l)),[2]}})}),h.promise()},e.prototype.cancelTransition=function(){return D(this,void 0,Promise,function(){var t=this;return P(this,function(e){return this.cameraData.transition.active?[2,new Promise(function(e){Object(u.b)(t.cameraData.pose,t.cameraData.transition.to,!1);var n=Date.now()-t.cameraData.transition.startTime;t.cameraData.transition.duration=n,t.cameraData.transition.progress.stop(1);var r=t.cameraData.transition.onPropertyChanged("active",function(t){t||(r&&r.cancel(),e())})})]:[2,Promise.resolve()]})})},e.prototype.updateTransitionSpeed=function(t){if(this.cameraData.transition.active){var e=Date.now(),n=e-this.cameraData.transition.startTime,r=n/t,i=this.cameraData.transition.progress,o=(i.duration-n)/t+r;this.cameraData.transition.duration=o,this.cameraData.transition.startTime=e-r,i.modifyAnimation(i.value,i.endValue,o,i.easing,r)}},e.prototype.beginExternalTransition=function(){this.cameraData.transition.activeInternal||(this.cameraData.transition.startTime=Date.now(),this.cameraData.transition.active=!0)},e.prototype.endExternalTransition=function(){this.cameraData.transition.activeInternal||(this.cameraData.transition.active=!1)},e.prototype.beginInternalTransition=function(t){var e=t.transitionTime||0;this.cameraData.transition.startTime=Date.now(),this.cameraData.transition.duration=e,this.cameraData.transition.active=!0,this.cameraData.transition.activeInternal=!0,this.cameraData.transition.type=t.transitionType,this.cameraData.transition.progress.modifyAnimation(0,1,e,t.easing||y.d),this.cameraData.transition.rotationDelay=t.rotationDelay||0,this.cameraData.transition.rotationDuration=t.rotationDuration||1,this.cameraData.transition.matrixDelay=t.matrixDelay||0,this.cameraData.transition.matrixDuration=t.matrixDuration||1,t.transitionType===T.a.FadeToBlack&&this.cameraData.transition.blackoutProgress.modifyAnimation(0,1,t.blackoutTime),this.cameraData.transition.from.position=this.cameraData.pose.position.clone(),this.cameraData.transition.from.rotation=this.cameraData.pose.rotation.clone(),this.cameraData.transition.from.projection=this.cameraData.pose.projection.clone(),this.cameraData.transition.to.position=t.pose.position?t.pose.position.clone():void 0,this.cameraData.transition.to.rotation=t.pose.rotation?t.pose.rotation.clone():void 0,this.cameraData.transition.to.projection=t.projection?t.projection.clone():void 0},e.prototype.progressInternalTransition=function(t,e){if(this.cameraData.transition.active)if(this.cameraData.transition.progress.updateAbsolute(t),this.cameraData.transition.type===T.a.Interpolate){var n=this.cameraData.transition.from,r=this.cameraData.transition.to;if(r.position&&n.position&&this.cameraData.pose.position.copy(n.position).lerp(r.position,this.cameraData.transition.progress.value),r.rotation&&n.rotation){var i=Object(y.a)(this.cameraData.transition.progress.easing,this.cameraData.transition.progress.value,this.cameraData.transition.progress.elapsed,this.cameraData.transition.progress.duration*this.cameraData.transition.rotationDuration,this.cameraData.transition.rotationDelay);this.cameraData.pose.rotation.copy(n.rotation).slerp(r.rotation,i)}if(r.projection&&n.projection){i=Object(y.a)(y.g,this.cameraData.transition.progress.value,this.cameraData.transition.progress.elapsed,this.cameraData.transition.progress.duration*this.cameraData.transition.matrixDuration,this.cameraData.transition.matrixDelay);!function(t,e,n,r){for(var i=r.elements,o=t.elements,a=e.elements,s=0;s<16;s++)i[s]=o[s]*(1-n)+a[s]*n}(n.projection,r.projection,i,this.cameraData.pose.projection)}}else if(this.cameraData.transition.type===T.a.FadeToBlack){var o=0,a=this.cameraData.transition.duration;t<=e?o=t:(Object(u.b)(this.cameraData.transition.to,this.cameraData.pose,!1),o=t>=a-e?a-t:e),this.cameraData.transition.blackoutProgress.updateAbsolute(o),this.cameraData.transition.progress.updateAbsolute(t<=e?0:a)}},e.prototype.endInternalTransition=function(t){Object(u.b)(this.cameraData.transition.to,this.cameraData.pose,!1),this.cameraData.transition.type=null,this.cameraData.transition.active=!1,this.cameraData.transition.activeInternal=!1,this.cameraData.transition.progress.stop(1),t===T.a.FadeToBlack&&this.cameraData.transition.blackoutProgress.stop(0)},e.prototype.adjustProjectionZoom=function(t,e){var n=1/e;return t.elements[0]=n/this.canvas.aspectRatio,t.elements[5]=n,t},e}(s.c);e.default=E},1119:function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(532),a=n(1),s=n(389),u=n(309),c=n(30),l=n(388),p=n(411),h=n(326),f=n(340),d=n(11),y=n(371),v=n(370),g={sky:{uniforms:{progress:{type:"f",value:0},pano0Map:{type:"t",value:null},pano0Position:{type:"v3",value:new a.a},pano0Matrix:{type:"m4",value:new d.a},pano1Map:{type:"t",value:null},pano1Position:{type:"v3",value:new a.a},pano1Matrix:{type:"m4",value:new d.a},gradientOpacity:{type:"f",value:0},topColor:{type:"v3",value:new a.a(.094,.102,.11)},bottomColor:{type:"v3",value:new a.a(.2,.216,.235)},radius:{type:"f",value:100}},vertexShader:v+n(910),fragmentShader:y+n(909)}},w=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),m=function(){return(m=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},b=new a.a(1,1,1),T=function(t){function e(e){return void 0===e&&(e={}),t.call(this,m({fragmentShader:g.sky.fragmentShader,vertexShader:g.sky.vertexShader,uniforms:h.a.clone(g.sky.uniforms),name:"SkyboxMaterial"},e))||this}return w(e,t),e.prototype.setProjectedPano=function(t,e,n,r){var i="pano"+t;r&&(this.uniforms[i+"Map"].value=r),e&&this.uniforms[i+"Position"].value.copy(e),n&&e&&this.uniforms[i+"Matrix"].value.compose(e,n,b)},e}(f.a),_=n(4),S=n(145),D=n(151),P=n(94),x=n(7),E=n(369),R=n(149),O=n(347),M=n(383),A=n(616),C=n(331),I=n(385),k=n(327),U=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},L=I.a.CameraRig,j=I.a.Root,N=function(){function t(t,e,n,r,i){void 0===i&&(i=D.a.ALL),this.scene=t,this.raycaster=e,this.sweepData=n,this.panoRenderer=r,this.renderLayer=i,this.bindings=[]}return t.prototype.init=function(){this.skySphere=this.setupSkysphere(),this.material=this.skySphere.material},t.prototype.dispose=function(){this.material.uniforms.pano0Map.value.dispose(),this.material.uniforms.pano1Map.value.dispose(),this.material.dispose(),this.skySphere.geometry.dispose(),this.skyBox.geometry.dispose()},t.prototype.activate=function(t){var e=this;this.scene.addChild(L,this.skySphere),this.skySphere.updateMatrixWorld(!0),t.market.waitForData(S.a).then(function(n){e.viewmodeData=n,e.viewmodeData.isPano()||e.raycaster.enableForGroup(R.a.skyboxMeshGroup,!1),e.bindings.push(t.subscribe(O.a,function(t){t.fromMode===_.a.Panorama&&e.raycaster.enableForGroup(R.a.skyboxMeshGroup,!1)})),e.bindings.push(t.subscribe(M.a,function(t){t.toMode===_.a.Panorama&&e.raycaster.enableForGroup(R.a.skyboxMeshGroup,!0)}))}),t.market.waitForData(E.a).then(function(t){e.meshData=t,e.skyBox=e.setupSkybox(t.bounds,e.material),e.raycaster.addTarget(e.skyBox,!1,e.raycaster.createCallbackSet(),R.a.skyboxMeshGroup),e.scene.addChild(j,e.skyBox)}),this.skySphere.visible=!0,this.updateMeshOpacity()},t.prototype.deactivate=function(t){var e,n;try{for(var r=U(this.bindings),i=r.next();!i.done;i=r.next()){i.value.cancel()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}this.bindings=[],this.scene.removeChild(L,this.skySphere),this.scene.removeChild(j,this.skyBox),this.raycaster.removeTarget(this.skyBox),this.currentSweepId&&this.panoRenderer.freeTexture(this.currentSweepId),this.currentSweepId=null,this.targetSweepId=null},t.prototype.updateBackgroundColors=function(t,e){var n=new c.a(t),r=new c.a(e);this.material.uniforms.topColor.value.set(n.r,n.g,n.b),this.material.uniforms.bottomColor.value.set(r.r,r.g,r.b)},t.prototype.updateSweepRenderTarget=function(t,e,n,r){var i=this.panoRenderer.useTexture(e);i&&this.material.setProjectedPano(t,n,r,i)},t.prototype.updateExistingTexture=function(t,e,n,r){t===this.currentSweepId&&this.material.setProjectedPano(0,n,r,e),t===this.targetSweepId&&this.material.setProjectedPano(1,n,r,e)},t.prototype.render=function(){var t=this.viewmodeData&&(null===this.viewmodeData.currentMode||void 0===this.viewmodeData.currentMode);if(this.viewmodeData&&!t){var e=this.sweepData.currentSweep,n=this.sweepData.transition,r=n.active?n.from:e,i=n.active?n.to:e;this.currentSweepId=this.handleSweepChange(0,this.sweepData,this.currentSweepId,r||null),this.targetSweepId=this.handleSweepChange(1,this.sweepData,this.targetSweepId,i||null),this.material.uniforms.progress.value=this.sweepData.transition.progress.value,this.updateMeshOpacity()}},t.prototype.updateMeshOpacity=function(){if(this.viewmodeData&&this.meshData&&this.sweepData){var t=this.meshData.opacity.value;if(this.viewmodeData.transition.active){var e=!!this.sweepData.currentSweep&&this.sweepData.isSweepUnaligned(this.sweepData.currentSweep);t=this.getMeshOpacityForTransition(this.viewmodeData.transition.from,this.viewmodeData.transition.to,this.viewmodeData.transition.progress,e,this.meshData.opacity.value)}else t=this.viewmodeData.currentMode===_.a.Panorama?this.meshData.opacity.value:1;var n=0===t;n!==this.skyBox.visible&&(this.skyBox.visible=n),this.material.uniforms.gradientOpacity.value=t}},t.prototype.getMeshOpacityForTransition=function(t,e,n,r,i){if(e===_.a.Panorama||t===_.a.Panorama){var o=e===_.a.Panorama?P.b:P.g,a=e===_.a.Panorama?2*(n-.5):2*n,s=o(r?n:Object(x.f)(a,0,1),0,1,1);return(1-s)*(t===_.a.Panorama?i:1)+s*(e===_.a.Panorama?i:1)}return 1},t.prototype.setupSkysphere=function(t){var e=.9*k.a.far,n=new l.a(e,24,24);n.computeBoundingBox(),t||((t=new T({side:u.f})).uniforms.pano0Map.value=new s.a,t.uniforms.pano1Map.value=new s.a);var r=new A.a(n,t);return t.uniforms.radius.value=e,r.layers.mask=this.renderLayer.mask,r.name="Skysphere",r.renderOrder=C.a.boundingSkybox,r.updateMatrixWorld(!0),r},t.prototype.setupSkybox=function(t,e){var n=t.getSize(new a.a),r=new p.b(n.x+.2,n.y+.2,n.z+.2);r.computeBoundingBox(),e||((e=new T({side:u.f})).uniforms.pano0Map.value=new s.a,e.uniforms.pano1Map.value=new s.a);var i=new A.a(r,e),o=t.getCenter(new a.a);return i.position.copy(o),i.layers.mask=this.renderLayer.mask,i.name="Skybox",i.renderOrder=C.a.boundingSkybox,i.updateMatrixWorld(!0),i},t.prototype.handleSweepChange=function(t,e,n,r){if(n!==r&&(n&&this.panoRenderer.freeTexture(n),r)){var i=e.getSweep(r);this.updateSweepRenderTarget(t,r,i.position,i.rotation)}return r},t}(),z=n(113),F=n(59),B=n(122),G=n(150),H=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Q=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},V=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},W=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},X=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="skybox-module",e}return H(e,t),e.prototype.init=function(t,e){return Q(this,void 0,void 0,function(){var t,n,r,a,s,u=this;return V(this,function(c){switch(c.label){case 0:return t=e.getModule(i.qb),n=e.getModule(i.Ha),r=e.getModuleByParent(i.Xa),a=e.market.waitForData(z.a),s=e.market.waitForData(F.a),[4,Promise.all([a,t,n,r,s]).then(function(t){var n=W(t,5),r=n[0],i=n[1],a=n[2],s=n[3],c=n[4],l=e.claimRenderLayer("skybox"),p=s.getRenderer(),h=a.getRaycaster(),f=i.getScene();u.skybox=new N(f,h,r,p,l),e.addComponent(u,u.skybox);var d=c.tryGetProperty(G.a.BackgroundColor,B.a.default);u.skybox.updateBackgroundColors(B.b[d].bgPrimary,B.b[d].bgSecondary),u.bindings.push(e.subscribe(o.a,function(t){u.skybox.updateExistingTexture(t.sweepId,t.renderTarget.texture)}),c.onPropertyChanged(G.a.BackgroundColor,function(t){u.skybox.updateBackgroundColors(B.b[t].bgPrimary,B.b[t].bgSecondary)}))})];case 1:return c.sent(),[2]}})})},e}(i.Sa);e.default=X},1126:function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(92),a=n(8),s=function(t){return{problem:"",solution:t.t(o.a.ERROR_BROWSER_SOLUTION),explanation:t.t(o.a.ERROR_BROWSER_EXPLANATION),actions:Object(a.k)()?"":["<div id='browser-tiles'>","<a href='https://www.google.com/chrome/browser/' target='_blank'>","<div class='tile'>","<img src="+n(1059)+">","</div>","</a>","<a href='https://www.mozilla.org/en-US/firefox/new/' target='_blank'>","<div class='tile'>","<img src="+n(1058)+">","</div>","</a>","<a href='http://windows.microsoft.com/en-us/internet-explorer/download-ie' target='_blank'>","<div class='tile'>","<img src="+n(1057)+">","</div>","</a>","<a href='https://support.apple.com/en-us/HT204416' target='_blank'>","<div class='tile'>","<img src="+n(1056)+">","</div>","</a>","</div>"].join("")}},u=function(){return(u=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},c=function(t){return u({},s(t),{problem:""+t.t(o.a.ERROR_WEBGL_UNSUPPORTED_PROBLEM)})},l="https://support.matterport.com/hc/articles/208220058",p=function(t){return{problem:t.t(o.a.ERROR_GENERIC_PROBLEM),solution:t.t(o.a.ERROR_GENERIC_SOLUTION),explanation:"",actions:[""+t.t(o.a.ERROR_GENERIC_ACTIONS_1)].concat(Object(a.k)()?[]:["<a id='install-browser' href='#'>"+t.t(o.a.ERROR_GENERIC_ACTIONS_2)+"</a>",""+t.t(o.a.ERROR_GENERIC_ACTIONS_3)]).concat(["<a href="+l+" target='_blank'>"+t.t(o.a.ERROR_GENERIC_ACTIONS_4)+"</a>"]).join("")}},h=function(t){return{problem:t.t(o.a.ERROR_LOADING_FAILED_PROBLEM),solution:"",explanation:"",actions:[""+t.t(o.a.ERROR_LOADING_FAILED_ACTIONS_1),"<a href="+l+" target='_blank'>"+t.t(o.a.ERROR_LOADING_FAILED_ACTIONS_2)+"</a>"].join("")}},f=(n(1055),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},y=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="error-gui",e}return f(e,t),e.prototype.init=function(t,e){return d(this,void 0,void 0,function(){var t;return y(this,function(n){switch(n.label){case 0:return this.container=document.querySelector("#error-container"),this.problem=document.querySelector("#error-problem"),this.solution=document.querySelector("#error-solution"),this.explanation=document.querySelector("#error-explanation"),this.actions=document.querySelector("#error-actions"),t=this,[4,e.getModule(i.H)];case 1:return t.localeModule=n.sent(),[2]}})})},e.prototype.showError=function(t){var e=this;switch(t){case i.q.UNSUPPORTED:this.populateErrorScreen(c);break;case i.q.WEBGL:this.populateErrorScreen(p);var n=this.actions.querySelector("#install-browser");n&&n.addEventListener("click",function(){return e.populateErrorScreen(s)});break;case i.q.GENERIC:default:this.populateErrorScreen(h)}},e.prototype.populateErrorScreen=function(t){var e=t(this.localeModule);this.container.classList.remove("hidden"),this.problem.innerText=e.problem,this.solution.innerText=e.solution,this.explanation.innerText=e.explanation,this.actions.innerHTML=e.actions},e}(i.p);e.default=v},1127:function(t,e,n){"use strict";n.r(e);var r,i=n(8),o=Object.freeze({profiling:{enabled:i.q("mem",!1)}}),a=n(55),s=n(0),u=n(385),c=n(59),l=n(697),p=n(325),h=n(309),f=n(389),d=n(922),y=n(395),v=n(534),g=n(345),w=n(322),m=n(340),b=n(411),T=n(117),_=n(371),S=n(370),D={copyCubeMap:{uniforms:{tDiffuse:{type:"t",value:null},alpha:{type:"f",value:1}},vertexShader:S+n(921),fragmentShader:_+n(920)}},P=n(1),x={basicTextured:{uniforms:{tDiffuse:{type:"t",value:null},alpha:{type:"f",value:1}},vertexShader:S+n(483),fragmentShader:_+n(919)},screenSpaceColored:{uniforms:{color:{type:"v3",value:new P.a(0,0,0)},opacity:{type:"f",value:1}},vertexShader:S+n(918),fragmentShader:_+n(917)}};!function(t){t[t.Texture2D=0]="Texture2D",t[t.TextureCube=1]="TextureCube"}(r||(r={}));var E,R=r,O=n(462),M=n(137),A=n(229),C=function(){function t(t,e,n,r,i,o){var a,s,u,c,l,p,f=this;this.textures=[],this.updateTextureMemory=function(){return function(){var t=0;for(var e in f.textures){var n=f.textures[e];n.width&&n.height&&(t+=n.width*n.height*4)}t}},this.renderToCubeMap=(p=!1,function(t,e,n,r,i,o,d,b,T,_,S,D,P,E,R,O){p||((s=new v.a(-.5,.5,.5,-.5,-200,200)).position.z=150,(a=new y.a).add(s),u=new m.a({uniforms:{tDiffuse:{type:"t",value:null},alpha:{type:"f",value:1}},vertexShader:x.basicTextured.vertexShader,fragmentShader:x.basicTextured.fragmentShader,depthWrite:!1,depthTest:!1,side:h.u}),c=new g.a(1,1),(l=new w.a(c,u)).position.z=0,a.add(l),p=!0);var M=c.getAttribute("uv");M.setDynamic(!0),M.needsUpdate=!0;var A=M.array,C=i/n,I=o/r,k=d/n,U=b/r;A[0]=C,A[1]=I+U,A[2]=C+k,A[3]=I+U,A[4]=C,A[5]=I,A[6]=C+k,A[7]=I;var L=c.getAttribute("position");L.setDynamic(!0),L.needsUpdate=!0;var j=L.array,N=T/e.width-.5,z=_/e.height-.5,F=S/e.width,B=D/e.height;j[0]=N,j[1]=z+B,j[3]=N+F,j[4]=z+B,j[6]=N,j[7]=z,j[9]=N+F,j[10]=z,u.uniforms.tDiffuse.value=t,u.blending=E||h.Ba,u.transparent=!!R,null==O&&(O=1),u.uniforms.alpha.value=O,u.needsUpdate=!0,e.activeCubeFace=P,e.viewport.set(0,0,e.width,e.height);var G=f.threeRenderer.autoClear;f.threeRenderer.autoClear=!1,f.threeRenderer.render(a,s,e,!1),f.threeRenderer.autoClear=G}),this.copyCubeMap=function(){var t,e,n,r,i,o=!1,a=new T.a,s=f;return function(u,c,l,p,f,d,g,T,_){if(!o){(e=new v.a(-1,1,1,-1,0,200)).position.set(0,0,0),(t=new y.a).add(e),n=new m.a({uniforms:{tDiffuse:{type:"t",value:null},alpha:{type:"f",value:1}},vertexShader:D.copyCubeMap.vertexShader,fragmentShader:D.copyCubeMap.fragmentShader,depthWrite:!1,depthTest:!1,side:h.u}),r=new b.b(2,2,2),i=new w.a(r,n),t.add(i),o=!0}for(var S=0;S<6;S++){I(S,a),i.rotation.copy(a),i.matrixWorldNeedsUpdate=!0,i.updateMatrixWorld(!0),n.uniforms.tDiffuse.value=u,n.blending=g||h.Ba,n.transparent=!!T,null==_&&(_=1),n.uniforms.alpha.value=_,n.needsUpdate=!0,c.activeCubeFace=S,c.viewport.set(0,0,f,d),s.threeRenderer.render(t,e,c,!1)}}}(),this.threeRenderer=this.createRenderer(t,e,n,r,i,o)}return Object.defineProperty(t.prototype,"renderer",{get:function(){return this.threeRenderer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxCubemapSize",{get:function(){return this._maxCubemapSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxTextureSize",{get:function(){return this._maxTextureSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gpuInfo",{get:function(){return this._gpuInfo},enumerable:!0,configurable:!0}),t.prototype.getSize=function(){return this.threeRenderer.getSize()},t.prototype.dispose=function(){this.threeRenderer.dispose()},t.prototype.createRenderer=function(t,e,n,r,i,o){var a=null;try{(a=new l.a({canvas:t.element,antialias:n,alpha:!0})).autoClear=e,i=i||(window.devicePixelRatio?window.devicePixelRatio:1),a.setPixelRatio(i),a.setSize(o.width,o.height,!1);var s=a.context;this._maxCubemapSize=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),this._maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),this._gpuInfo=Object(A.a)(s)}catch(t){throw new M.b("Unable to create a WebGL rendering context")}return r&&this.overrideTextures(a),a},t.prototype.overrideTextures=function(t){var e=this,n=t.context,r=0,i=n.createTexture;n.createTexture=function(){var t=i.call(n);return t.id=r++,e.textures[t.id]=t,t};var o=n.texImage2D;n.texImage2D=function(t,r,i,a,s,u,c,l,p){var h=null,f=e.getTextureTypeFromTarget(n,t);h=f===R.TextureCube?n.getParameter(n.TEXTURE_BINDING_CUBE_MAP):n.getParameter(n.TEXTURE_BINDING_2D),void 0!==c?o.call(n,t,r,i,a,s,u,c,l,p):(c=a,l=s,a=(p=u).naturalWidth,s=p.naturalHeight,o.call(n,t,r,i,c,l,p));var d=e.textures[h.id];d.width=f===R.TextureCube?6*a:a,d.height=s};var a=n.deleteTexture;n.deleteTexture=function(t){delete e.textures[t.id],a.call(n,t)}},t.prototype.getTextureTypeFromTarget=function(t,e){switch(e){case t.TEXTURE_CUBE_MAP_POSITIVE_X:case t.TEXTURE_CUBE_MAP_NEGATIVE_X:case t.TEXTURE_CUBE_MAP_POSITIVE_Y:case t.TEXTURE_CUBE_MAP_NEGATIVE_Y:case t.TEXTURE_CUBE_MAP_POSITIVE_Z:case t.TEXTURE_CUBE_MAP_NEGATIVE_Z:return R.TextureCube;case t.TEXTURE_2D:return R.Texture2D;default:return null}},t.prototype.initSizedTexture2D=function(t,e){var n=this.threeRenderer.context,r=this.threeRenderer.state;(e=e||new p.a).addEventListener("dispose",function(){return n.deleteTexture(a.__webglTexture)});var i=k(e.format,this.threeRenderer),o=k(e.type,this.threeRenderer),a=this.threeRenderer.properties.get(e),s=n.createTexture();r.bindTexture(n.TEXTURE_2D,s),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,e.flipY),n.texImage2D(n.TEXTURE_2D,0,i,t,t,0,i,o,null);var u=k(e.wrapS,this.threeRenderer),c=k(e.wrapT,this.threeRenderer);return n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,u),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,c),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,k(e.magFilter,this.threeRenderer)),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,k(e.minFilter,this.threeRenderer)),e.generateMipmaps&&n.generateMipmap(n.TEXTURE_2D),r.bindTexture(n.TEXTURE_2D,null),a.__webglTexture=s,e},t.prototype.initSizedCubeMap=function(t,e){var n=this.threeRenderer.context,r=this.threeRenderer.state,i=new f.a([null,null,null,null,null,null]);i.flipY=!1,i.generateMipmaps=e;var o=k(i.format,this.threeRenderer),a=k(i.type,this.threeRenderer),s=this.threeRenderer.properties.get(i),u=n.createTexture();r.bindTexture(n.TEXTURE_CUBE_MAP,u),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,i.flipY);for(var c=0;c<6;c++)n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+c,0,o,t,t,0,o,a,null);return e?(i.magFilter=h.L,i.minFilter=h.M,n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_LINEAR),n.generateMipmap(n.TEXTURE_CUBE_MAP)):(i.magFilter=h.L,i.minFilter=h.L,n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MIN_FILTER,n.LINEAR)),r.bindTexture(n.TEXTURE_CUBE_MAP,null),s.__image__webglTextureCube=u,i},t.prototype.initRenderTargetCube=function(t,e){var n=this.threeRenderer,r=new d.a(t,t,{stencilBuffer:!1}),i=new f.a([]);r.texture=i,i.image=[null,null,null,null,null,null],i.flipY=!0,e?(i.generateMipmaps=!0,i.magFilter=h.L,i.minFilter=h.M):(i.generateMipmaps=!1,i.magFilter=h.L,i.minFilter=h.L),i.format=h.Pa,n.setRenderTarget(r),n.setRenderTarget.call(n,null);var o=n.properties.get(i);return o.__image__webglTextureCube=o.__webglTexture,r},t.prototype.deallocateCubeTexture=function(t){var e=this.threeRenderer.context,n=this.threeRenderer.properties.get(t);e.deleteTexture(n.__image__webglTextureCube)},t.prototype.uploadTexture2D=function(t,e,n,r){var i=this.threeRenderer.context,o=this.threeRenderer.state,a=i.getParameter(i.TEXTURE_BINDING_2D),s=this.threeRenderer.properties.get(e);o.bindTexture(i.TEXTURE_2D,s.__webglTexture),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,e.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,e.unpackAlignment),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,k(e.wrapS,this.threeRenderer)),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,k(e.wrapT,this.threeRenderer)),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,k(e.magFilter,this.threeRenderer)),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,k(e.minFilter,this.threeRenderer));var u=k(e.format,this.threeRenderer),c=k(e.type,this.threeRenderer);i.texSubImage2D(i.TEXTURE_2D,0,n,r,u,c,t),e.generateMipmaps&&i.generateMipmap(i.TEXTURE_2D),o.bindTexture(i.TEXTURE_2D,a)},t.prototype.uploadTexture3D=function(t,e,n,r,i,o,a){var s=this.threeRenderer.context,u=this.threeRenderer.state,c=this.threeRenderer.properties.get(e);u.bindTexture(s.TEXTURE_CUBE_MAP,c.__image__webglTextureCube),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,e.flipY),s.texSubImage2D(i,0,n,r,s.RGBA,s.UNSIGNED_BYTE,t),e.generateMipmaps&&s.generateMipmap(s.TEXTURE_CUBE_MAP),u.bindTexture(s.TEXTURE_CUBE_MAP,null)},t.prototype.rebuildMipMaps2D=function(t){var e=this.threeRenderer.context,n=this.threeRenderer.state;e.generateMipmap(e.TEXTURE_2D),n.bindTexture(e.TEXTURE_2D,null)},t.prototype.rebuildMipMaps3D=function(t){var e=this.threeRenderer.context,n=this.threeRenderer.state,r=this.threeRenderer.properties.get(t);n.bindTexture(e.TEXTURE_CUBE_MAP,r.__image__webglTextureCube),e.generateMipmap(e.TEXTURE_CUBE_MAP),n.bindTexture(e.TEXTURE_CUBE_MAP,null)},t}(),I=function(t,e){switch(t){case O.a.GL_TEXTURE_CUBE_MAP_POSITIVE_X:e.set(0,-Math.PI/2,0);break;case O.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_X:e.set(0,Math.PI/2,0);break;case O.a.GL_TEXTURE_CUBE_MAP_POSITIVE_Y:e.set(Math.PI/2,Math.PI,0);break;case O.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y:e.set(-Math.PI/2,Math.PI,0);break;case O.a.GL_TEXTURE_CUBE_MAP_POSITIVE_Z:e.set(0,-Math.PI,0);break;case O.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z:e.set(0,0,0)}},k=function(t,e){var n,r=e.extensions,i=e.context;switch(t){case h.tb:return i.REPEAT;case h.j:return i.CLAMP_TO_EDGE;case h.T:return i.MIRRORED_REPEAT;case h.X:return i.NEAREST;case h.Z:return i.NEAREST_MIPMAP_NEAREST;case h.Y:return i.NEAREST_MIPMAP_LINEAR;case h.L:return i.LINEAR;case h.N:return i.LINEAR_MIPMAP_NEAREST;case h.M:return i.LINEAR_MIPMAP_LINEAR;case h.Hb:return i.UNSIGNED_BYTE;case h.Kb:return i.UNSIGNED_SHORT_4_4_4_4;case h.Lb:return i.UNSIGNED_SHORT_5_5_5_1;case h.Mb:return i.UNSIGNED_SHORT_5_6_5;case h.h:return i.BYTE;case h.vb:return i.SHORT;case h.Nb:return i.UNSIGNED_SHORT;case h.H:return i.INT;case h.Jb:return i.UNSIGNED_INT;case h.B:return i.FLOAT}if(null!==(n=r.get("OES_texture_half_float"))&&t===h.G)return n.HALF_FLOAT_OES;switch(t){case h.d:return i.ALPHA;case h.lb:return i.RGB;case h.Pa:return i.RGBA;case h.Q:return i.LUMINANCE;case h.P:return i.LUMINANCE_ALPHA;case h.a:return i.FUNC_ADD;case h.Ab:return i.FUNC_SUBTRACT;case h.ub:return i.FUNC_REVERSE_SUBTRACT;case h.Ob:return i.ZERO;case h.Ga:return i.ONE;case h.zb:return i.SRC_COLOR;case h.Ka:return i.ONE_MINUS_SRC_COLOR;case h.xb:return i.SRC_ALPHA;case h.Ja:return i.ONE_MINUS_SRC_ALPHA;case h.v:return i.DST_ALPHA;case h.Ha:return i.ONE_MINUS_DST_ALPHA;case h.w:return i.DST_COLOR;case h.Ia:return i.ONE_MINUS_DST_COLOR;case h.yb:return i.SRC_ALPHA_SATURATE}if(null!==(n=r.get("WEBGL_compressed_texture_s3tc"))){if(t===h.rb)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===h.gb)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===h.hb)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===h.ib)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(null!==(n=r.get("WEBGL_compressed_texture_pvrtc"))){if(t===h.qb)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===h.pb)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===h.fb)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===h.eb)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(null!==(n=r.get("WEBGL_compressed_texture_etc1"))&&t===h.ob)return n.COMPRESSED_RGB_ETC1_WEBGL;if(null!==(n=r.get("EXT_blend_minmax"))){if(t===h.S)return n.MIN_EXT;if(t===h.R)return n.MAX_EXT}return 0},U=n(336),L=n(312),j=n(538),N=n(91),z=n(18),F=n(617),B=n(326),G=n(30),H=n(331),Q=(E=function(t,e){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}E(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),V=function(t){function e(e){var n=t.call(this,new g.a(2,2,1,1),new m.a({uniforms:B.a.clone(x.screenSpaceColored.uniforms),vertexShader:x.screenSpaceColored.vertexShader,fragmentShader:x.screenSpaceColored.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1}))||this;return n._opacity=1,n.material.uniforms.color.value=new G.a(e),n.renderOrder=H.a.colorOverlay,n}return Q(e,t),Object.defineProperty(e.prototype,"opacity",{get:function(){return this._opacity},set:function(t){this.visible=t>0,this._opacity=t,this.material.uniforms.opacity.value=t},enumerable:!0,configurable:!0}),e}(w.a),W=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),X=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},q=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Y=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Z=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="webgl-renderer",e.perfStatEnabled=!1,e.perfStatInterval=1e3,e.elapsedTime=0,e.frameCount=0,e.contextLostError=null,e.fps=[0],e.blackoutOverlayMesh=new V(0),e.setContextLostError=function(t){e.contextLostError=t},e.createRenderer=function(t,e){return new C(t,!1,!1,o.profiling.enabled,window.devicePixelRatio||1,e)},e}return W(e,t),e.prototype.init=function(t,e){return X(this,void 0,void 0,function(){var t,n,r=this;return q(this,function(o){switch(o.label){case 0:if(!("WebGLRenderingContext"in window))throw new M.c("WebGL not supported");return this.engine=e,[4,Promise.all([e.getModule(s.e),e.market.waitForData(U.a),e.market.waitForData(L.a),e.waitForModule(a.default),e.market.waitForData(c.a)])];case 1:return t=Y.apply(void 0,[o.sent(),5]),this.canvasModule=t[0],this.canvasData=t[1],this.cameraData=t[2],this.sdkModule=t[3],n=t[4],this.perfStatEnabled=i.q("perf",0),this.perfStatInterval=n.tryGetProperty("perfInterval",this.perfStatInterval),this.calculatePerf=this.calculatePerf.bind(this),this.cwfRenderer=this.createRenderer(this.canvasModule,this.canvasData),this.scene=new u.b(this.cwfRenderer,this.cameraData,this.canvasData),e.addComponent(this,this.scene),this.bindings.push(e.subscribe(j.a,function(t){return r.scene.setSize(t.width,t.height)})),this.scene.addChild(u.a.CameraRig,this.blackoutOverlayMesh),this.canvasModule.element.addEventListener("webglcontextlost",this.setContextLostError),[2]}})})},e.prototype.dispose=function(e){t.prototype.dispose.call(this,e),this.canvasModule.element.removeEventListener("webglcontextlost",this.setContextLostError)},e.prototype.calculatePerf=function(t){var e=this;return this.elapsedTime+=t,this.frameCount++,this.elapsedTime>=this.perfStatInterval&&(this.fps[0]=1e3*this.frameCount/this.elapsedTime,this.elapsedTime=0,this.frameCount=0,this.sdkModule.broadcast(F.a.FPS,t,function(){return e.fps},!0)),this.fps},e.prototype.onUpdate=function(t){if(this.perfStatEnabled&&this.calculatePerf(t),this.cameraData&&(this.blackoutOverlayMesh.opacity=this.cameraData.transition.blackoutProgress.value),this.contextLostError)throw new M.a("WebGL context lost: "+(this.contextLostError.statusMessage||"no status given"))},Object.defineProperty(e.prototype,"maxCubemapSize",{get:function(){return this.cwfRenderer.maxCubemapSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxTextureSize",{get:function(){return this.cwfRenderer.maxTextureSize},enumerable:!0,configurable:!0}),e.prototype.getScene=function(){return this.scene},e.prototype.renderOnce=function(){return X(this,void 0,void 0,function(){var t=this;return q(this,function(e){return this.scene.startRender(!0),[2,this.engine.after(z.a.Render).then(function(){return t.scene.startRender(!1)})]})})},e.prototype.startRender=function(t){void 0===t&&(t=!0),this.scene.startRender(t)},e.prototype.worldToNDC=function(t,e){return(e=e||new P.a).copy(t).project(this.scene.camera),e},e.prototype.ndcToWorld=function(t,e){return(e=e||new P.a).x=t.x,e.y=t.y,e.z=.5,e.unproject(this.scene.camera),e},e.prototype.ndcToScreenPoint=function(t,e){e=e||new N.a;var n=this.cwfRenderer.getSize(),r=n.width,i=n.height;return e.set((t.x+1)*r/2,(1-t.y)*i/2),e},e}(s.qb);e.default=Z},1128:function(t,e,n){"use strict";n.r(e);var r,i=n(118),o=n(538),a=n(1),s=n(10),u=n(325),c=n(309),l=n(482),p=n(44),h=n(48),f=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t[t.PreOrder=0]="PreOrder",t[t.PostOrder=1]="PostOrder"}(r||(r={}));var d,y=function(){function t(e,n){this.tree=e,this.parent=n,this.children=[],this.id=++t._id,this.extra={},this.level=-1}return t._id=0,t}(),v=function(){function t(t,e){this.levels=e,this.tileSize=t,this.root=null,this.allNodes=[],m(this)}return t.prototype.getSizeForLevel=function(t,e){return Math.pow(2,e)*t},t.prototype.getSubNode=function(t,e,n){(!e||t<this.tileSize)&&(e=0),(!n||t<this.tileSize)&&(n=0),t<this.tileSize&&(t=this.tileSize);var r=g(this.tileSize,t);return T(this.root,0,r,e,n)},t.prototype.deleteAllNodes=function(){this.depthFirst(function(t,e,n,r,i){for(var o=0;o<t.children.length;o++){var a=t.children[o];a&&(a.parent=null,a.tree=null),t.children[o]=null}t.children.length=0}.bind(this),null,r.PostOrder);for(var t=0;t<this.allNodes.length;t++){var e=this.allNodes[t];e&&(e.parent=null,e.tree=null),this.allNodes[t]=null}this.allNodes.length=0,this.root=null},t.prototype.breadthFirst=function(t){var e,n,r=!!(t=t||{}).nullLevelEnd,i=t.maxLevel,o=t.minLevel,a=t.callback,s=t.saveVisited,u=[],c=new y(this,null),l=0;if(this.root)for(u.push(this.root),u.push(c);u.length>0&&!(i&&l>i);){var p=u.shift();if(p)if(p===c)(!o||l>=o)&&(a&&r&&a(),s&&r&&s.push(null)),u.length>0&&u.push(c),l++;else{if(p.children)try{for(var h=f(p.children),d=h.next();!d.done;d=h.next()){var v=d.value;v&&u.push(v)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(n=h.return)&&n.call(h)}finally{if(e)throw e.error}}var g=this.getFaceIndexFromNode(p);(!o||l>=o)&&(a&&a(p,l,g),s&&s.push(p))}}},t.prototype.getFaceIndexFromNode=function(t){if(!t)return-1;for(var e=1,n=t,r=0,i=0;;){var o=n.parent;if(!o)break;for(var a=-1,s=0;s<o.children.length;s++)o.children[s]===n&&(a=s);r=a%2*e+r,i=Math.floor(a/2)*e+i,e*=2,n=o}return i*e+r},t.prototype.depthFirst=function(t,e,n){w(this.root,0,0,0,t,e,n,this.tileSize)},t}(),g=function(t,e){var n=0;for(e<t&&(e=t);!((e/=2)<t);)n++;return n},w=function(t,e,n,i,o,a,s,u){if(t){var c=2*i+n;if((s=s||r.PreOrder)===r.PreOrder&&(o&&o(t,e,c,n,i),a&&a.push(t)),t.children&&0!==t.children.length){for(var l=2*i,p=2*n,h=0;h<2;h++)for(var f=0;f<2;f++)w(t.children[2*f+h],e+1,p+h,l+f,o,a,s,u);s===r.PostOrder&&(o&&o(t,e,c,n,i),a&&a.push(t))}}},m=function(t){t.root=b(t,null,0)},b=function(t,e,n){if(n>t.levels)return null;var r=new y(t,e);r.level=n,t.allNodes.push(r);for(var i=0;i<4;i++){var o=b(t,r,n+1);o&&(r.children[i]=o)}return r},T=function(t,e,n,r,i){if(!t)return null;if(0===n)return t;if(!t.children||0===t.children.length)return null;var o=Math.pow(2,n)/2,a=r%o,s=i%o,u=2*Math.floor(i/o)+Math.floor(r/o),c=t.children[u];return T(c,e+1,n-1,a,s)},_=n(418),S=n(674),D=n(480),P=n(481),x=n(26),E=n(461);!function(t){t[t.None=0]="None",t[t.Queued=1]="Queued",t[t.ForceQueued=2]="ForceQueued",t[t.Downloading=3]="Downloading",t[t.Downloaded=4]="Downloaded",t[t.DownloadFailed=5]="DownloadFailed"}(d||(d={}));var R,O=d,M=n(7),A=n(14),C=n(346),I=n(410),k=n(60),U=n(0),L=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t[t.None=0]="None",t[t.DirectionalFOV=1]="DirectionalFOV"}(R||(R={}));var j=function(){return function(t,e,n,r,i){this.sweep=t,this.cameraPosition=(new a.a).copy(e),this.cameraDir=(new a.a).copy(n),this.panoSpaceDir=(new a.a).copy(r),this.upcomingSweeps=i,this.zoomingActive=!1}}(),N=function(t,e,n){var r,i;void 0===n&&(n=!1);var o=0;if(t&&e)try{for(var a=L(e),s=a.next();!s.done;s=a.next()){var u=s.value;n&&-1!==t.indexOf(u)||(t.push(u),o++)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o},z=function(){function t(t,e){this.panoQualityManager=t,this.tilingSettings=e,this.persistentStorage=new E.a,this.maxResolution=t.getNavPanoSize(),this.currViewQueue=H(),this.fullPanoQueue=H(),this.priorityCriteria=new j(null,new a.a(0,0,0),new a.a(0,0,-1),new a.a(0,0,-1))}return t.prototype.getQualityQueueSize=function(t,e){return t===U.o.CurrentView?this.currViewQueue[e].value:this.fullPanoQueue[e].value},t.prototype.makeQueueSubscription=function(t,e,n){return(t===U.o.CurrentView?this.currViewQueue[e]:this.fullPanoQueue[e]).onChanged(n)},t.prototype.updateCriteria=function(t,e,n){this.priorityCriteria.sweep=t,this.priorityCriteria.cameraPosition.copy(e),this.priorityCriteria.cameraDir.copy(n)},t.prototype.setUpcomingSweeps=function(t){this.priorityCriteria.upcomingSweeps=t},t.prototype.clearUpcomingSweeps=function(){this.priorityCriteria.upcomingSweeps=void 0},t.prototype.filterAndPrioritize=function(e,n,r){var i,o;if(this.priorityCriteria.sweep){var a=void 0!==this.priorityCriteria.upcomingSweeps&&null!==this.priorityCriteria.upcomingSweeps,s=this.persistentStorage.getArray("filterAndPrioritize:tempQueue"),u=[];a||(u=this.persistentStorage.getArray("filterAndPrioritize:scoredSweeps"),this.populateScoredSweeps(this.priorityCriteria.sweep,n,u,this.priorityCriteria.cameraDir,6));var c=this.priorityCriteria.sweep.id;s.length=0,this.queueTilesForPano(s,r,this.priorityCriteria.sweep,x.c.BASE);var l=N(e,s,!0);if(this.currViewQueue[x.d.BASE].value=l,this.fullPanoQueue[x.d.BASE].value=l,this.priorityCriteria.upcomingSweeps){var p=0;try{for(var h=L(this.priorityCriteria.upcomingSweeps),f=h.next();!f.done;f=h.next()){var d=f.value;if((p+=this.queueTilesForPano(e,r,d,x.c.BASE))>=3)break}}catch(t){i={error:t}}finally{try{f&&!f.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}}if(this.canDownloadSize(c,x.d.STANDARD)){s.length=0;var y=this.queueTilesInDirectionForPano(s,r,this.priorityCriteria.sweep,x.c.STANDARD,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,120);t.sortTiles(s,this.priorityCriteria.sweep,this.priorityCriteria.cameraDir),N(e,s,!0),this.currViewQueue[x.d.STANDARD].value=y,this.fullPanoQueue[x.d.STANDARD].value=y}if(!a&&this.maxResolution<=2048&&this.queueTilesForPanos(e,u,r,x.c.BASE,2),s.length=0,this.canDownloadSize(c,x.d.HIGH)){y=this.queueTilesInDirectionForPano(s,r,this.priorityCriteria.sweep,x.c.HIGH,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,120);this.currViewQueue[x.d.HIGH].value=y}if(this.canDownloadSize(c,x.d.ULTRAHIGH)){y=this.queueTilesInDirectionForPano(s,r,this.priorityCriteria.sweep,x.c.ULTRAHIGH,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,120);this.currViewQueue[x.d.ULTRAHIGH].value=y}if(t.sortTiles(s,this.priorityCriteria.sweep,this.priorityCriteria.cameraDir),N(e,s,!0),s.length=0,this.canDownloadSize(c,x.d.STANDARD)&&this.queueTilesInDirectionForPano(s,r,this.priorityCriteria.sweep,x.c.STANDARD,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,180),this.canDownloadSize(c,x.d.HIGH)&&this.queueTilesInDirectionForPano(s,r,this.priorityCriteria.sweep,x.c.HIGH,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,180),this.canDownloadSize(c,x.d.ULTRAHIGH)&&this.queueTilesInDirectionForPano(s,r,this.priorityCriteria.sweep,x.c.ULTRAHIGH,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,180),t.sortTiles(s,this.priorityCriteria.sweep,this.priorityCriteria.cameraDir),N(e,s,!0),this.tilingSettings.downloadFullPano){if(s.length=0,this.maxResolution<=x.c.HIGH){if(this.canDownloadSize(c,x.d.HIGH)){y=this.queueTilesForPano(s,r,this.priorityCriteria.sweep,x.c.HIGH);this.fullPanoQueue[x.d.HIGH].value=y}}else if(this.canDownloadSize(c,x.d.ULTRAHIGH)){y=this.queueTilesForPano(s,r,this.priorityCriteria.sweep,x.c.ULTRAHIGH);this.fullPanoQueue[x.d.ULTRAHIGH].value=y}t.sortTiles(s,this.priorityCriteria.sweep,this.priorityCriteria.cameraDir),N(e,s,!0)}if(!a){var v=this.persistentStorage.getArray("filterAndPrioritize:neighbors");this.populateNeighborSweeps(this.priorityCriteria.sweep,n,v),this.queueTilesForPanos(e,v,r,x.c.BASE)}}},t.prototype.canDownloadSize=function(t,e){var n=x.a[e],r=this.panoQualityManager.getNavPanoSize()>=n||this.maxResolution>=n&&this.panoQualityManager.getZoomPanoSize()>=n,i=this.panoQualityManager.getTestResults(t,e);return r&&i===D.a.Untested&&this.panoQualityManager.testDownload(t,e,_.b),i===D.a.Success&&r},t.prototype.populateNeighborSweeps=function(t,e,n){for(var r in(n=n||[]).length=0,t.neighbours){var i=t.neighbours[r],o=e.get(i);n.push(o)}},t.prototype.populateScoredSweeps=function(t,e,n,r,o){(n=n||[]).length=0;for(var s=(new a.a).copy(t.position),u=[C.a(s,r,.75),C.h(t)],c=[I.d(s,i.c.navigation.distanceFactor),I.b(s,r,i.c.navigation.directionFactor)],l=G(u,c,e),p=0;p<l.length&&p<o;p++){var h=l[p].sweep;n.push(h)}},t.prototype.queueTilesForPanos=function(t,e,n,r,i){var o,a,s=0;try{for(var u=L(e),c=u.next();!c.done;c=u.next()){var l=c.value;if(s+=this.queueTilesForPano(t,n,l,r)>0?1:0,i&&s>=i)break}}catch(t){o={error:t}}finally{try{c&&!c.done&&(a=u.return)&&a.call(u)}finally{if(o)throw o.error}}return s},t.prototype.queueTilesForPano=function(t,e,n,r){var i=this.persistentStorage.get("queueTilesForSweep:filterCriteria",function(){return{filter:R.None}});return this.filterAndQueueTileDownloadDescriptors(t,e,n,r,i)},t.prototype.queueTilesInDirectionForPano=function(t,e,n,r,i,o,s){var u=this.persistentStorage.get("queueTilesInDirectionForSweep:panoSpaceDir",function(){return new a.a}),c=this.persistentStorage.get("queueTilesInDirectionForSweep:filterCriteria",function(){return{filter:R.DirectionalFOV,direction:new a.a,fov:60}});return u.copy(o),_.d(n.rotation,u),c.direction.copy(u),c.fov=s,this.filterAndQueueTileDownloadDescriptors(t,e,n,r,c)},t.prototype.filterAndQueueTileDownloadDescriptors=function(t,e,n,r,i){var o,a,s=this.persistentStorage.getArray("filterAndQueueTileDownloadDescriptors:descriptors"),u=e.getTileDownloadDescriptors(n,r);s.length=0,this.filterTileDownloadDescriptors(u,s,i);var c=0;try{for(var l=L(s),p=l.next();!p.done;p=l.next()){var h=p.value;h&&(t.push(h),c++)}}catch(t){o={error:t}}finally{try{p&&!p.done&&(a=l.return)&&a.call(l)}finally{if(o)throw o.error}}return c},t.prototype.filterTileDownloadDescriptors=function(t,e,n){var r,i;switch(n.filter){case R.DirectionalFOV:for(r=0;r<t.length;r++)(i=t[r])&&_.h(i.panoSize,i.tileSize,i.face,i.tileX,i.tileY,n.direction,n.fov)&&e.push(i);break;default:for(r=0;r<t.length;r++)i=t[r],e.push(i)}for(r=0;r<e.length;r++)(i=e[r])&&!this.canIncludeDescriptor(i)&&(e[r]=null)},t.prototype.canIncludeDescriptor=function(t){return t.status!==O.Downloading&&t.status!==O.Downloaded},t.sortTiles=function(t,e,n){F.panoSpaceDir.copy(n),_.d(e.rotation,F.panoSpaceDir),F.fovThresholdNarrow=M.l(120),F.fovThreshold=M.l(180),t.sort(B)},t.insertSortedPanoTile=function(t,e,n,r){F.panoSpaceDir.copy(r),_.d(n.rotation,F.panoSpaceDir),F.fovThresholdNarrow=M.l(120),F.fovThreshold=M.l(180);for(var i=-1,o=0;o<t.length;o++){if(B(e,t[o])<=0){i=o;break}}if(-1===i)t[t.length]=e;else{for(var a=t.length;a>i;a--)t[a]=t[a-1];t[i]=e}},t}(),F={panoSpaceDir:new a.a,fovThreshold:-1,fovThresholdNarrow:-1},B=function(t,e){var n=F.panoSpaceDir,r=F.fovThreshold,i=F.fovThresholdNarrow,o=Math.max(Math.min(n.dot(t.direction),1),-1),a=Math.max(Math.min(n.dot(e.direction),1),-1);return o>=r&&a<r?-1:o<r&&a>=r?1:o>=i&&a<i?-1:o<i&&a>=i?1:t.panoSize>e.panoSize?1:e.panoSize>t.panoSize?-1:-(o-a)},G=function(t,e,n){var r,i,o=[],a=function(n){if(!A.g(n,t))return"continue";o.push({sweep:n,score:e.reduce(function(t,e){return t+e(n)},0)})};try{for(var s=L(n),u=s.next();!u.done;u=s.next()){a(u.value)}}catch(t){r={error:t}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o.sort(function(t,e){return e.score-t.score}),o};function H(){var t;return(t={})[x.d.BASE]=Object(k.b)(0),t[x.d.STANDARD]=Object(k.b)(0),t[x.d.HIGH]=Object(k.b)(0),t[x.d.ULTRAHIGH]=Object(k.b)(0),t}var Q,V=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t[t.Base=0]="Base",t[t.Remaining=1]="Remaining"}(Q||(Q={}));var W,X=function(){function t(){this.forceQueue=[],this.uploadQueues={},this.panoLODDescriptors={}}return t.prototype.addToForceQueue=function(t){this.forceQueue.push(t)},t.prototype.addToPanoQueue=function(t,e){this.getUploadQueueForPano(t).push(e)},t.prototype.insertSortedIntoPanoQueue=function(t,e,n){var r=this.getUploadQueueForPano(e.id);z.insertSortedPanoTile(r,t,e,n)},t.prototype.sortQueue=function(t,e){var n=this.getUploadQueueForPano(t.id);z.sortTiles(n,t,e)},t.prototype.getUploadQueueForPano=function(t){var e=this.uploadQueues[t];return e||(e=[],this.uploadQueues[t]=e),e},t.prototype.hasQueuedTiles=function(){if(this.forceQueue.length>0)return!0;for(var t in this.uploadQueues){var e=this.getUploadQueueForSweep(t);if(e&&e.length>0)return!0}return!1},t.prototype.getUploadQueueForSweep=function(t){var e=this.uploadQueues[t];return e||(e=[],this.uploadQueues[t]=e),e},t.prototype.getTopUploadQueue=function(t){for(var e,n,r=null,i=Q.Base;i<=Q.Remaining;i++)try{for(var o=V(t),a=o.next();!a.done;a=o.next()){var s=a.value;if((r=this.getUploadQueueForSweep(s.id)).length>0)switch(i){case Q.Base:if(0===r[0].level)return r;break;case Q.Remaining:return r}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return null},t.prototype.processNextQueueItem=function(t){var e=t.shift();return e?(e.uploadQueued=!1,e):null},t.prototype.getNextFromUploadQueue=function(t){if(this.forceQueue.length>0)return this.processNextQueueItem(this.forceQueue);var e=this.getTopUploadQueue(t);return e&&e.length>0?this.processNextQueueItem(e):null},t.prototype.peekNextFromUploadQueue=function(t){if(this.forceQueue.length>0)return this.forceQueue[0];var e=this.getTopUploadQueue(t);return e&&e.length>0?e[0]:null},t.prototype.clearAllQueuedUploads=function(){this.clearAllUploadQueues(null,0)},t.prototype.clearAllUploadQueues=function(t,e){if(void 0===e&&(e=0),t)this.clearUploadQueue(this.getUploadQueueForSweep(t),e),this.clearUploadQueue(this.forceQueue,e,t);else{for(var n in this.uploadQueues)this.clearUploadQueue(this.getUploadQueueForSweep(n),e);this.clearUploadQueue(this.forceQueue,e)}},t.prototype.clearUploadQueue=function(t,e,n){void 0===e&&(e=0);for(var r=0;r<t.length;){var i=t[r];(!n||n&&n===i.sweepId)&&i.level>=e?(i.uploadQueued=!1,t.splice(r,1)):r++}},t.prototype.resetPanoLODDescriptors=function(t){var e=this.getPanoLODDescriptors(t);for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];r.uploadCount=0,r.uploadAttempts=0}},t.prototype.getPanoLODDescriptor=function(t,e){var n=this.getPanoLODDescriptors(t),r=n[e];return r||(r={uploadCount:0,uploadAttempts:0},n[e]=r),r},t.prototype.getPanoLODDescriptors=function(t){var e=this.panoLODDescriptors[t];return e||(e={},this.panoLODDescriptors[t]=e),e},t}(),q=n(532),Y=(W=function(t,e){return(W=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}W(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Z=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},K=i.c.uploadIntervalDelay,J=function(t){function e(e,n,r,i,o,u,c,p){var h=t.call(this,e,o.getSweepList())||this;return h.cwfRenderer=n,h.panoQualityManager=r,h.tileDownloader=i,h.sweepData=o,h.cameraData=u,h.tilingSettings=c,h.broadcast=p,h.persistentStorage=new E.a,h.activeSweeps=[],h.sweepLoadHistory=[],h.activeRenderTargetDescriptors={},h.panoLoadPromises={},h.panoLoadResolvers={},h.tileTrees={},h.tileDirectory={},h.zoomSweepRenderingDisabled=!1,h.zoomingActive=!1,h.zoomSweepId=null,h.usingTileOverlay=!1,h.overlayTilesLoaded=!1,h.overlayTileBase=null,h.overlayTilesBasic={},h.overlayTilesEnhanced={},h.tileUploadQueue=new X,h.currentState={direction:new a.a,position:new a.a,rotation:new s.a},h.renderTargetPool=new l.a(h.rtCompare),h.tileDownloader.setModel(h.sweepListMap),h.tileDownloader.setLoadCallbacks(h.onTileDownLoaded.bind(h)),h}return Y(e,t),e.prototype.rtCompare=function(t,e){return t.object.height===e.size&&t.object.width===e.size},e.prototype.getActivePanos=function(){var t,e,n=[];try{for(var r=Z(Object.keys(this.activeRenderTargetDescriptors)),i=r.next();!i.done;i=r.next()){var o=i.value;this.activeRenderTargetDescriptors[o]&&n.push(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},e.prototype.init=function(){t.prototype.init.call(this),this.loadOverlayTiles()},e.prototype.highResRenderTarget=function(t,e){if(t){if(!e)throw new Error("Cannot activate zooming without sweepId!");this.zoomingActive=!0,this.zoomSweepId=e,this.copyTargetToZoom(e)}else this.zoomingActive=!1,this.zoomSweepId=null;if(e){var n=this.getRenderTargetDescriptorForSweep(e);if(!n)throw new Error("Zooming at a null render target!");var r=this.zoomingActive?this.zoomRenderTarget:n.object,i=r.width;this.broadcast(new q.a(i,e,r))}},e.prototype.getCurrentPanoResolution=function(){var t=this.zoomingActive?this.panoQualityManager.getZoomPanoSize():this.panoQualityManager.getNavPanoSize();return D.b.getPanoSizeClass(t)},e.prototype.beforeRender=function(){var t=this.sweepData.currentSweep,e=this.sweepData.transition.to;this.updateState(this.cameraData.pose.position,this.cameraData.pose.rotation,t,e),this.updateUploadQueueProcessing()},e.prototype.activateSweep=function(e){var n=this,r=this.sweepListMap.get(e);if(!r)throw new Error("Invalid sweepId passed to TiledPanORenderer.activate(): "+e);var i=this.panoLoadPromises[e];return i||(i=new Promise(function(t,i){n.panoLoadResolvers[e]=t,n.updateSweepState(e),n.activatePano(r),n.queueUploadForAllTiles(e,!0),n.tileDownloader.forceQueueTiles(r,D.b.getPanoSize(x.d.BASE),n.currentState.direction,!0)}),this.panoLoadPromises[e]=i),t.prototype.activateSweep.call(this,e),i},e.prototype.useTexture=function(e){var n=this.getRenderTargetDescriptorForSweep(e);if(!n)throw Error("Texture for sweep "+e+" not loaded before using");var r=n.object.texture;return t.prototype.useTexture.call(this,e),this.zoomingActive?this.zoomRenderTarget.texture:r},e.prototype.freeTexture=function(e,n){void 0===n&&(n=!1),t.prototype.freeTexture.call(this,e,n),0===this.textureUsageCounter[e]&&(this.panoLoadPromises[e]=null,this.deactivatePano(e))},e.prototype.freeAllTextures=function(t){var e,n;void 0===t&&(t=[]);var r=Object(A.b)(t),i=this.getActivePanos();try{for(var o=Z(i),a=o.next();!a.done;a=o.next()){var s=a.value;r[s]||this.freeTexture(s,!0)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},e.prototype.enableUltraHighQualityMode=function(t){this.setupZoomRenderTarget(),this.zoomSweepId&&this.broadcast(new q.a(this.zoomRenderTarget.width,this.zoomSweepId,this.zoomRenderTarget))},e.prototype.resetRenderStatus=function(t,e,n,r){var i;r&&(i=g(_.b,r)+1);for(var o=function(t,r,i,o){n&&(r.extra.tile.zoomUploaded=!1),e&&(r.extra.tile.uploaded=!1)},a=0;a<_.a;a++){this.getTileTree(t,a).breadthFirst({callback:o.bind(this,a),minLevel:i})}},e.prototype.copyBaseRenderStatusToZoomed=function(t){for(var e=g(_.b,this.panoQualityManager.getNavPanoSize()),n=function(t,e,n,r){e.extra.tile.zoomUploaded=e.extra.tile.uploaded,e.extra.zoomCovered=e.extra.covered},r=0;r<_.a;r++){this.getTileTree(t,r).breadthFirst({callback:n.bind(this,r),maxLevel:e})}},e.prototype.renderPanoTiles=function(t,e,n,r){var i=[];this.zoomRenderTarget&&this.zoomRenderTarget.width===this.panoQualityManager.getZoomPanoSize()||this.zoomSweepRenderingDisabled||this.setupZoomRenderTarget(),e=e||this.currentState.direction||h.a.FORWARD;var o=this.getRenderTargetDescriptorForSweep(t);if(!this.isRenderTargetDescriptorValid(o))throw new p.a("PanoRenderer.renderPanoTiles() -> Cannot render to a pano that is not activated.");for(var a=0;a<_.a;a++){var s=this.getTileTree(t,a);i.length=0,s.breadthFirst({saveVisited:i});for(var u=0;u<i.length;u++){var c=i[u];this.queueUploadForTile(c.extra.tile,!1,r||0===u&&n)}}},e.prototype.clearAllQueuedUploads=function(){this.tileUploadQueue.clearAllUploadQueues(null,0)},e.prototype.clearAllQueuedUploadsForPano=function(t){this.tileUploadQueue.clearAllUploadQueues(t,0)},e.prototype.updateState=function(t,e,n,r){var i=r||n||this.currentState.sweepId,o=i?this.sweepListMap.get(i):null;this.updatePositionState(t),this.updateRotationState(e),i&&this.updateSweepState(i),o&&this.tileDownloader.tilePrioritizer&&this.tileDownloader.tilePrioritizer.updateCriteria(o,t,this.currentState.direction)},e.prototype.updatePositionState=function(t){this.currentState.position.copy(t)},e.prototype.updateRotationState=function(t){var e,n;if(this.currentState.rotation.copy(t),this.currentState.direction.copy(h.a.FORWARD).applyQuaternion(t),this.tileUploadQueue.hasQueuedTiles())try{for(var r=Z(this.activeSweeps),i=r.next();!i.done;i=r.next()){var o=i.value;this.tileUploadQueue.sortQueue(o,this.currentState.direction)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},e.prototype.updateSweepState=function(t){this.currentState.sweepId=t},e.prototype.activatePano=function(t,e){void 0===e&&(e=!0),e&&this.tileUploadQueue.clearAllQueuedUploads();for(var n=this.panoQualityManager.getMaxPossiblePanoSize(),r=0;r<_.a;r++)this.initTileTree(t.id,r,n);this.linkAllTilesAndNodes(t);var i=this.getRenderTargetDescriptorForSweep(t.id);if(!i){var o=this.panoQualityManager.getNavPanoSize();if(!(i=this.renderTargetPool.get({size:o}))){var a=this.cwfRenderer.initRenderTargetCube(o,!1);(i=this.renderTargetPool.add(a)).extra={},i.extra.size=a.width}i.extra.sweep=t,this.setRenderTargetDescriptorForSweep(t.id,i),this.tileUploadQueue.resetPanoLODDescriptors(t.id),this.resetUploadState(t.id,!0,!0)}return this.updateActiveSweeps(t,e),i.object},e.prototype.deactivatePano=function(t){var e=this.getRenderTargetDescriptorForSweep(t);e&&this.isRenderTargetDescriptorValid(e)&&(this.renderTargetPool.free(e.object),this.setRenderTargetDescriptorForSweep(t,null),this.updateActiveSweeps(),this.tileUploadQueue.clearAllUploadQueues(t),this.tileUploadQueue.resetPanoLODDescriptors(t),this.clearCachedTileData())},e.prototype.clearCachedTileData=function(){for(var t,e,n=this.sweepLoadHistory.length-1;n>=0;n--){var r=!1,i=this.sweepLoadHistory[n];if(i){try{for(var o=Z(this.activeSweeps),a=o.next();!a.done;a=o.next()){if(i===a.value.id){r=!0;break}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}!r&&this.checkTileTreeInitialized(i)&&(this.clearTileState(i,!0,!0),this.deleteTileTrees(i),this.deleteTileDirectoryEntries(i),this.tileDownloader.deleteAllTileDownloadDescriptors(i),this.sweepLoadHistory[n]=null)}}this.updateSweepLoadHistory()},e.prototype.updateActiveSweeps=function(t,e){var n,r;void 0===e&&(e=!0);var i=this.persistentStorage.getArray("updateActiveSweeps:tempSweeps");i.length=0;try{for(var o=Z(this.activeSweeps),a=o.next();!a.done;a=o.next()){var s=a.value,u=this.getRenderTargetDescriptorForSweep(s.id);t&&s.id===t.id||!this.isRenderTargetDescriptorValid(u)||i.push(s)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}t&&(e?i.unshift(t):i.push(t)),this.activeSweeps.length=0,this.activeSweeps.push.apply(this.activeSweeps,i)},e.prototype.queueUploadForAllTiles=function(t,e,n){var r,i;void 0===e&&(e=!0),void 0===n&&(n=!1),this.zoomRenderTarget&&this.zoomRenderTarget.width===this.panoQualityManager.getZoomPanoSize()||this.zoomSweepRenderingDisabled||this.setupZoomRenderTarget();var o=this.getRenderTargetDescriptorForSweep(t);if(!this.isRenderTargetDescriptorValid(o))throw new p.a("queueUploadForAllTiles() -> Cannot render to a pano that is not activated.");for(var a=this.persistentStorage.getArray("queueUploadForAllTiles:nodeList"),s=0;s<_.a;s++){var u=this.getTileTree(t,s);a.length=0,u.breadthFirst({saveVisited:a});try{for(var c=Z(a),l=c.next();!l.done;l=c.next()){var h=l.value;this.queueUploadForTile(h.extra.tile,!1,n||0===h.level&&e)}}catch(t){r={error:t}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}},e.prototype.onTileDownLoaded=function(t){if(t.sweep){var e=g(_.b,t.panoSize),n=this.getTileDirectoryEntry(t.sweep.id,t.face,e,t.faceTileIndex);this.updateUploadDescriptorFromDownloadDescriptor(n,t),this.updateSweepLoadHistory(n.sweepId);var r=this.getRenderTargetDescriptorForSweep(n.sweepId);if(this.isRenderTargetDescriptorValid(r)){var i=this.getTileTree(n.sweepId,n.face).getSubNode(n.panoSize,n.tileX,n.tileY);i&&(this.linkTileAndNode(n,i),this.queueUploadForTile(n,!0))}}},e.prototype.updateUploadDescriptorFromDownloadDescriptor=function(t,e){t.downloaded=!0,t.image=e.image,t.panoSize=e.panoSize,t.tileX=e.tileX,t.tileY=e.tileY,t.totalTiles=e.totalTiles,t.tileIndex=e.tileIndex,t.faceTileIndex=e.faceTileIndex,t.face=e.face,t.cubeFace=P.a(e.face),e.sweep&&(t.sweepId=e.sweep.id),t.tileSize=e.tileSize,t.direction=(new a.a).copy(e.direction),t.node=null,t.level=g(_.b,t.panoSize)},e.prototype.updateSweepLoadHistory=function(t){var e,n,r=this.persistentStorage.getArray("updateSweepLoadHistory:tempHistory");r.length=0;try{for(var i=Z(this.sweepLoadHistory),o=i.next();!o.done;o=i.next()){var a=o.value;a&&(!t||t&&t!==a)&&r.push(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}this.sweepLoadHistory.length=0,t&&this.sweepLoadHistory.push(t),this.sweepLoadHistory.push.apply(this.sweepLoadHistory,r)},e.prototype.onPanoRendered=function(t,e,n,r){var i=this.panoLoadResolvers[t],o=this.activeRenderTargetDescriptors[t];o&&o.object&&i(o.object.texture)},e.prototype.getRenderTargetDescriptorForSweep=function(t){return this.activeRenderTargetDescriptors[t]},e.prototype.setRenderTargetDescriptorForSweep=function(t,e){this.activeRenderTargetDescriptors[t]=e},e.prototype.isRenderTargetDescriptorValid=function(t){return!!t&&!!t.object},e.prototype.isSweepZoomed=function(t){return this.zoomingActive&&this.zoomSweepId===t},e.prototype.initTileTree=function(t,e,n){var r=this.tileTrees[t];r||(r=[],this.tileTrees[t]=r);var i=r[e];if(!i){var o=g(_.b,n);i=new v(_.b,o),r[e]=i}},e.prototype.getTileTrees=function(t){var e=this.tileTrees[t];if(!e)throw new p.a("TiledPanoRenderer.getTileTrees() -> Tree array not yet initialized!");return e},e.prototype.checkTileTreeInitialized=function(t){return!!this.tileTrees[t]},e.prototype.getTileTree=function(t,e){var n=this.getTileTrees(t)[e];if(!n)throw new p.a("TiledPanoRenderer.getTileTree() -> Tree not yet initialized!");return n},e.prototype.deleteTileTrees=function(t){for(var e=this.getTileTrees(t),n=0;n<_.a;n++){var r=e[n];r&&r.deleteAllNodes()}this.tileTrees[t]=null,delete this.tileTrees[t]},e.prototype.clearTileState=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);for(var r=function(t,r,i,o){n&&(r.extra.tile.image=null),e&&(r.extra.tile.uploaded=!1,r.extra.tile.downloaded=!1,r.extra.tile.zoomUploaded=!1,r.extra.tile.uploadAttempted=!1)},i=0;i<_.a;i++){var o=this.getTileTree(t,i);o&&o.breadthFirst({callback:r.bind(this,i),maxLevel:g(_.b,this.panoQualityManager.getZoomPanoSize())})}},e.prototype.resetUploadState=function(t,e,n,r){for(var i=function(t,r,i,o){r.extra.tile.zoomUploaded=!n&&r.extra.tile.zoomUploaded,r.extra.tile.uploaded=!e&&r.extra.tile.uploaded},o=0;o<_.a;o++){this.getTileTree(t,o).breadthFirst({callback:i.bind(this,o),minLevel:void 0!==r?g(_.b,r)+1:0})}},e.prototype.anyUploaded=function(t){var e,n;if(!t)return!1;if(t.extra.tile&&this.isTileUploaded(t.extra.tile))return!0;if(t.children)try{for(var r=Z(t.children),i=r.next();!i.done;i=r.next()){var o=i.value;if(this.anyUploaded(o))return!0}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return!1},e.prototype.linkTileAndNode=function(t,e){e.extra.tile=t,t.node=e},e.prototype.linkAllTilesAndNodes=function(t){for(var e=this,n=function(n,r,i,o,a){var s=e.getTileDirectoryEntry(t.id,r,o,a);e.linkTileAndNode(s,i)},r=0;r<_.a;r++){var i=this.getTileTree(t.id,r);i.breadthFirst({callback:n.bind(this,i,r)})}},e.prototype.getTileDirectoryEntry=function(t,e,n,r){var i=this.tileDirectory[t];i||(i={},this.tileDirectory[t]=i);var o=16384*e+1024*n+r,s=i[o];return s||(s={downloaded:!1,uploaded:!1,uploadAttempted:!1,forceUpload:!1,zoomUploaded:!1,uploadQueued:!1,image:null,panoSize:-1,tileX:-1,tileY:-1,totalTiles:-1,tileIndex:r,faceTileIndex:-1,face:e,cubeFace:-1,sweepId:t,tileSize:-1,direction:new a.a,node:null,level:n},i[o]=s),s._key=t+":"+e+":"+n+":"+r,s._tileKey=o,s},e.prototype.deleteTileDirectoryEntries=function(t){this.tileDirectory[t]=null,delete this.tileDirectory[t]},e.prototype.isTileUploaded=function(t){return this.isSweepZoomed(t.sweepId)?t.zoomUploaded:t.uploaded},e.prototype.setUploaded=function(t,e){this.isSweepZoomed(t.sweepId)?t.zoomUploaded=e:t.uploaded=e},e.prototype.queueUploadForTile=function(t,e,n){var r=!t.downloaded||t.uploadQueued&&!n||this.isTileUploaded(t)||t.panoSize>this.panoQualityManager.getNavPanoSize()&&!this.zoomingActive,i=this.getRenderTargetDescriptorForSweep(t.sweepId);!r&&i&&this.isRenderTargetDescriptorValid(i)&&(n?this.uploadTile(t,!1):(0===g(_.b,t.panoSize)?this.tileUploadQueue.addToForceQueue(t):e&&this.currentState.direction?this.tileUploadQueue.insertSortedIntoPanoQueue(t,i.extra.sweep,this.currentState.direction):this.tileUploadQueue.addToPanoQueue(t.sweepId,t),t.uploadQueued=!0))},e.prototype.uploadTile=function(t,e){var n=this.persistentStorage.get("uploadTile:tempTileTexture",function(){return{}}),r=this.tileUploadQueue.getPanoLODDescriptor(t.sweepId,t.panoSize),o=this.getRenderTargetDescriptorForSweep(t.sweepId);if(o&&t.image&&this.isRenderTargetDescriptorValid(o)){var a=o.object,s=o.extra.size;if(this.isSweepZoomed(t.sweepId)&&(a=this.zoomRenderTarget,s=this.panoQualityManager.getZoomPanoSize()),e||!this.isTileUploaded(t)&&!this.anyUploaded(t.node)){var l=t.tileX*t.tileSize,p=t.tileY*t.tileSize,h=t.tileSize/t.panoSize*s,f=l/t.panoSize*s,d=p/t.panoSize*s,y=n[t.tileSize];if(n[t.tileSize]||((y=new u.a).generateMipmaps=!1,y.minFilter=c.L,y.flipY=!1,this.cwfRenderer.initSizedTexture2D(t.tileSize,y),n[t.tileSize]=y),this.cwfRenderer.uploadTexture2D(t.image,y,0,0),this.cwfRenderer.renderToCubeMap(y,a,t.tileSize,t.tileSize,0,0,t.tileSize,t.tileSize,f,d,h,h,t.cubeFace),i.c.overlayStyle>0){var v=1===i.c.overlayStyle?this.overlayTilesBasic:this.overlayTilesEnhanced;this.cwfRenderer.renderToCubeMap(v[t.panoSize],a,t.tileSize,t.tileSize,0,0,t.tileSize,t.tileSize,f,d,h,h,t.cubeFace,c.Ea,!0,.5)}r.uploadCount++,this.setUploaded(t,!0)}else this.setUploaded(t,!1);t.uploadAttempted||r.uploadAttempts++,t.uploadAttempted=!0,r.uploadAttempts===t.totalTiles&&this.onPanoRendered(t.sweepId,t.panoSize,t.totalTiles)}},e.prototype.updateUploadQueueProcessing=function(){var t=this.persistentStorage.getNumber("updateUploadQueueProcessing:lastUpdateTime"),e=this.persistentStorage.getNumber("updateUploadQueueProcessing:updateCount");!(performance.now()-t.value()>K||0===e.value())||!this.overlayTilesLoaded&&this.usingTileOverlay||(this.processUploadQueue(this.tilingSettings.highResUploadsPerFrame,this.tilingSettings.uploadsPerFrame),t.set(performance.now())),e.set(e.value()+1)},e.prototype.processUploadQueue=function(t,e){void 0===t&&(t=1);for(var n=0,r=0,i=null;i=this.tileUploadQueue.getNextFromUploadQueue(this.activeSweeps);){var o=this.getRenderTargetDescriptorForSweep(i.sweepId);if(!(i.panoSize>this.panoQualityManager.getNavPanoSize()&&!this.zoomingActive||!this.isRenderTargetDescriptorValid(o))&&(this.uploadTile(i,i.forceUpload),n+=0!==i.level?1:0,(r+=0===i.level?1:0)>=e||n>=t))break}},e.prototype.loadOverlayTiles=function(){var t=this;if(0!==i.c.overlayStyle){var e=0,r=[];switch(i.c.overlayStyle){case 1:r.push([n(673),this.overlayTilesBasic,256]),r.push([n(673),this.overlayTilesBasic,512]),r.push([n(916),this.overlayTilesBasic,1024]),r.push([n(915),this.overlayTilesBasic,2048]),r.push([n(914),this.overlayTilesBasic,4096]);break;case 2:r.push([n(672),this.overlayTilesEnhanced,256]),r.push([n(672),this.overlayTilesEnhanced,512]),r.push([n(913),this.overlayTilesEnhanced,1024]),r.push([n(912),this.overlayTilesEnhanced,2048]),r.push([n(911),this.overlayTilesEnhanced,4096])}r.forEach(function(n){var i=document.createElement("img");i.crossOrigin="anonymous",i.src=n[0],i.onload=function(){(function(n,i,o){var a=new u.a;a.generateMipmaps=!1,a.minFilter=c.L,a.flipY=!1,i?a=n[i]=t.cwfRenderer.initSizedTexture2D(_.b,a):(t.overlayTileBase=t.cwfRenderer.initSizedTexture2D(_.b,a),a=t.overlayTileBase),t.cwfRenderer.uploadTexture2D(o,a,0,0),++e>=r.length&&(t.overlayTilesLoaded=!0)}).call(t,n[1],n[2],i)}}),this.usingTileOverlay=!0}else this.usingTileOverlay=!1},e.prototype.copyTargetToZoom=function(t){if(this.zoomingActive){var e=this.getRenderTargetDescriptorForSweep(t);if(!e)throw new Error("Error in copying a null render target to a zoomed target");var n=e.object,r=n.width,i=this.zoomRenderTarget.width;this.cwfRenderer.copyCubeMap(n.texture,this.zoomRenderTarget,r,r,i,i),this.copyBaseRenderStatusToZoomed(t)}},e.prototype.setupZoomRenderTarget=function(){if(this.panoQualityManager.getZoomPanoSize()>=this.panoQualityManager.getNavPanoSize()){if(this.zoomRenderTarget&&this.zoomRenderTarget.width===this.panoQualityManager.getZoomPanoSize())return;var t=this.zoomRenderTarget;if(this.zoomRenderTarget=this.cwfRenderer.initRenderTargetCube(this.panoQualityManager.getZoomPanoSize(),!1),t){var e=t.width,n=this.zoomRenderTarget.width;this.cwfRenderer.copyCubeMap(t.texture,this.zoomRenderTarget,e,e,n,n),t.texture.dispose(),t.texture.version=0,this.cwfRenderer.deallocateCubeTexture(t.texture),t.texture=null}this.zoomSweepRenderingDisabled=!1}else this.zoomSweepRenderingDisabled=!0},e}(S.a),$=n(533),tt=n(3),et=n(96),nt=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},rt=new tt.a("tile-downloader"),it=function(){function t(t,e,n,r){this.urls=t,this.panoQualityManager=e,this.tilePrioritizer=n,this.settings=r,this.persistentStorage=new E.a,this.downloadDescriptors={},this.priorityQueue=[],this.forceQueue=[],this.activeDownloads=[],this.lastPrioritizedTime=Date.now(),this.processPriorityQueue=!0}return t.prototype.init=function(){},t.prototype.render=function(){this.update()},t.prototype.update=function(){this.processQueue(this.forceQueue,!1),this.processPriorityQueue&&(this.sweepListMap&&this.activeDownloads.length<this.settings.concurrentDownloads&&Date.now()-this.lastPrioritizedTime>200&&this.queuePrioritizedTiles(this.sweepListMap),this.processQueue(this.priorityQueue,!1))},t.prototype.dispose=function(){},t.prototype.activate=function(t){},t.prototype.deactivate=function(t){},t.prototype.setModel=function(t){this.setSweeps(t)},t.prototype.setRestrictedSweeps=function(t){var e,n;if(this.sweepListMap&&this.tilePrioritizer){var r=[];try{for(var i=nt(t),o=i.next();!o.done;o=i.next()){var a=o.value;r.push(this.sweepListMap.get(a))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}this.tilePrioritizer.setUpcomingSweeps(r),this.clearFromAllQueuesBySweep(t)}},t.prototype.clearRestrictedSweeps=function(){this.tilePrioritizer&&this.tilePrioritizer.clearUpcomingSweeps()},t.prototype.setLoadCallbacks=function(t,e){this.onTileDownloaded=t,this.onPanoDownloaded=e},t.prototype.setSweeps=function(t){this.sweepListMap=t},t.prototype.getNonDownloadedTiles=function(t,e,n){var r,i;n.length=0;var o=this.getTileDownloadDescriptors(t,e);try{for(var a=nt(o),s=a.next();!s.done;s=a.next()){var u=s.value;!u||u.status!==O.None&&u.status!==O.Queued||n.push(u)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},t.prototype.forceQueueTiles=function(t,e,n,r,i,o){var a,s,u,c,l=this.persistentStorage.getArray("forceQueueTiles:remaining"),p=this.persistentStorage.getArray("forceQueueTiles:matching"),h=this.persistentStorage.getArray("forceQueueTiles:toDownload");if(this.getNonDownloadedTiles(t,e,l),h.length=0,l.length>0){z.sortTiles(l,t,n),p.length=0,_.i(t,e,n,p,!0);try{for(var f=nt(l),d=f.next();!d.done;d=f.next()){var y=d.value;try{for(var v=nt(p),g=v.next();!g.done;g=v.next()){var w=g.value;y.face===w.face&&y.faceTileIndex===w.faceTileIndex&&h.push(y)}}catch(t){u={error:t}}finally{try{g&&!g.done&&(c=v.return)&&c.call(v)}finally{if(u)throw u.error}}}}catch(t){a={error:t}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(a)throw a.error}}this.forceQueue.push.apply(this.forceQueue,h),this.setStatusForAllDescriptors(this.forceQueue,O.ForceQueued),this.clearFromQueue(this.priorityQueue,O.ForceQueued,!1),r&&this.processQueue(this.forceQueue,!0)}},t.prototype.clearForceQueue=function(){this.clearQueue(this.forceQueue)},t.prototype.queuePrioritizedTiles=function(t){this.tilePrioritizer&&(this.clearQueue(this.priorityQueue),this.tilePrioritizer.filterAndPrioritize(this.priorityQueue,t,this),this.invalidateDuplicateEntries(this.priorityQueue),this.clearFromQueue(this.priorityQueue,O.None,!0),this.setStatusForAllDescriptors(this.priorityQueue,O.Queued),this.lastPrioritizedTime=Date.now())},t.prototype.clearQueue=function(t){this.setStatusForAllDescriptors(t,O.None),t.length=0},t.prototype.clearFromQueue=function(t,e,n){for(var r=0;r<t.length;r++){var i=t[r];i&&(e===i.status&&!n||e!==i.status&&n)&&(t[r]=null)}},t.prototype.clearFromAllQueuesBySweep=function(t){this.clearFromQueueBySweep(this.forceQueue,t),this.clearFromQueueBySweep(this.priorityQueue,t)},t.prototype.clearFromQueueBySweep=function(t,e){for(var n=Object(A.b)(e),r=0;r<t.length;r++){var i=t[r];i&&i.sweep&&(n[i.sweep.id]||(t[r]=null))}},t.prototype.setStatusForAllDescriptors=function(t,e){var n,r;try{for(var i=nt(t),o=i.next();!o.done;o=i.next()){var a=o.value;a&&(a.status=e)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.invalidateDuplicateEntries=function(t){var e,n;try{for(var r=nt(t),i=r.next();!i.done;i=r.next()){(a=i.value)&&(a.queuedCount=0)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}for(var o=0;o<t.length;o++){var a;(a=t[o])&&(a.queuedCount++,a.queuedCount>1&&(t[o]=null))}},t.prototype.getTileDownloadDescriptors=function(t,e){var n=this.getAllTileDownloadDescriptors(t.id),r=n[e];return r||(r=this.buildDownloadDescriptorArray(e),n[e]=r,this.initTileDownloadDescriptors(r,t,e)),r},t.prototype.getAllTileDownloadDescriptors=function(t){var e=this.downloadDescriptors[t];return e||(e={},this.downloadDescriptors[t]=e),e},t.prototype.deleteAllTileDownloadDescriptors=function(t){this.downloadDescriptors[t]=null,delete this.downloadDescriptors[t]},t.prototype.processQueue=function(t,e){if(this.cleanupActiveDownloads(),this.activeDownloads.length<this.settings.concurrentDownloads||e)for(var n=e?t.length:this.settings.concurrentDownloads-this.activeDownloads.length,r=0,i=0;r<n&&t.length>0;i++){var o=t.shift();o&&(this.startDownload(o),r++)}},t.prototype.startDownload=function(t){if(!this.urls)throw new Error("Can't call startDownload without signed urls");if(t.sweep){var e=t.status===O.ForceQueued?et.RequestPriority.HIGHEST:et.RequestPriority.MEDIUM;t.status=O.Downloading,this.checkRestrictedSweep(t.sweep.id)||rt.error("Tried to download tile that is not in restricted list!!!!!");var n=this.getTileUrl(t.sweep.id,t.panoSize,t.tileSize,t.tileIndex);this.activeDownloads.push(t),this.urls.getImageBitmap(n,t.tileSize,t.tileSize,{maxRetries:4,priority:e}).then(this.downloadComplete.bind(this,t),this.downloadFailed.bind(this,t))}},t.prototype.checkRestrictedSweep=function(t){var e,n;if(this.tilePrioritizer){var r=this.tilePrioritizer.priorityCriteria.upcomingSweeps;if(r){var i=!1;try{for(var o=nt(r),a=o.next();!a.done;a=o.next()){var s=a.value;s&&s.id===t&&(i=!0)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return i}return!0}return!0},t.prototype.downloadFailed=function(t,e){t.status=O.DownloadFailed},t.prototype.downloadComplete=function(t,e){if(t.sweep&&(t.status=O.Downloaded,t.image=e,this.onTileDownloaded&&this.onTileDownloaded(t),this.isPanoDownloaded(t.sweep,t.panoSize))){var n={sweep:t.sweep,tileSize:t.tileSize,panoSize:t.panoSize};this.onPanoDownloaded&&this.onPanoDownloaded(n)}},t.prototype.cleanupActiveDownloads=function(){var t,e,n=this.persistentStorage.getArray("cleanupActiveDownloads:temp");n.length=0;try{for(var r=nt(this.activeDownloads),i=r.next();!i.done;i=r.next()){var o=i.value;o.status!==O.Downloaded&&o.status!==O.DownloadFailed&&n.push(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}this.activeDownloads.length=0,this.activeDownloads.push.apply(this.activeDownloads,n)},t.prototype.isPanoDownloaded=function(t,e){var n,r,i=this.getTileDownloadDescriptors(t,e);if(!i||i.length<=0)return!1;try{for(var o=nt(i),a=o.next();!a.done;a=o.next()){var s=a.value;if(s&&s.status!==O.Downloaded)return!1}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!0},t.prototype.buildDownloadDescriptorArray=function(t){for(var e=_.e(t),n=[],r=0;r<e;r++){var i=this.buildDownloadDescriptor();n.push(i)}return n},t.prototype.buildDownloadDescriptor=function(){return{sweep:null,panoSize:-1,tileSize:-1,tileIndex:-1,totalTiles:-1,faceTileIndex:-1,status:O.None,url:null,image:null,direction:new a.a,face:-1,cubeFace:-1,tileX:-1,tileY:-1,queuedCount:-1}},t.prototype.initTileDownloadDescriptors=function(t,e,n){for(var r=0;r<t.length;r++){var i=t[r];i&&this.initTileDownloadDescriptor(i,e,n,r)}},t.prototype.initTileDownloadDescriptor=function(t,e,n,r){var i=n>=_.b?_.b:n;t.face=_.c(n,r),t.cubeFace=P.a(t.face),t.sweep=e,t.panoSize=n,t.tileSize=i,t.tileIndex=r,t.totalTiles=_.e(n),t.status=O.None,t.image=null,_.f(t.panoSize,t.tileIndex,t),_.g(t.panoSize,t.tileSize,t.cubeFace,t.tileX,t.tileY,$.a.Center,0,t.direction)},t.prototype.getTileUrl=function(t,e,n,r){return this.panoQualityManager.getTileUrl(t,e,n,r)},t}(),ot=n(531),at=n(530),st=n(113),ut=n(312),ct=n(19),lt=n(18),pt=n(384),ht=n(59),ft=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),dt=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},yt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},vt=new tt.a("sweep-pano-tiling"),gt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="sweep-pano-tiling",e.preloadQuality=null,e.preloadResolution=null,e}return ft(e,t),e.prototype.init=function(t,e){return dt(this,void 0,void 0,function(){var n,r,a,s,u,c,l,p,h,f=this;return yt(this,function(d){switch(d.label){case 0:return this.engine=e,[4,e.getModule(U.U)];case 1:return n=d.sent(),[4,e.getModule(U.qb)];case 2:return r=d.sent(),[4,e.market.waitForData(st.a)];case 3:return a=d.sent(),[4,e.market.waitForData(ut.a)];case 4:return s=d.sent(),u=this,[4,e.market.waitForData(ht.a)];case 5:return u.settingsData=d.sent(),c=r.getScene(),l=c.cwfRenderer,p=r.maxCubemapSize,h=n.getSignedUrls(),this.settings=new i.b,this.qualityManager=new D.b(h,p,t.navPanoSize,t.zoomPanoSize),this.tilePrioritizer=new z(this.qualityManager,this.settings),this.tileDownloader=new it(h,this.qualityManager,this.tilePrioritizer,this.settings),this.panoRenderer=new J(h,l,this.qualityManager,this.tileDownloader,a,s,this.settings,function(t){return e.broadcast(t)}),e.addComponent(this,this.tileDownloader),e.addComponent(this,this.panoRenderer),this.bindings.push(e.subscribe(o.a,function(t){f.panoRenderer.panoQualityManager.setWindowSize(t.width,t.height)}),e.subscribe(ot.a,function(t){f.tileDownloader.setRestrictedSweeps(t.sweepIds)}),e.subscribe(at.a,function(t){f.tileDownloader.clearRestrictedSweeps()}),e.subscribe(pt.a,function(t){f.handlePreloadQualityChange(t.toSweep)}),this.settingsData.onPropertyChanged(i.a,function(){f.preloadQuality=f.settingsData.tryGetProperty(i.a,null),a.currentSweep&&f.handlePreloadQualityChange(a.currentSweep)})),[2]}})})},e.prototype.getRenderer=function(){return this.panoRenderer},e.prototype.handlePreloadQualityChange=function(t){return dt(this,void 0,void 0,function(){var e;return yt(this,function(n){switch(n.label){case 0:return null===this.preloadQuality?[3,2]:[4,this.availableResolution(t,this.preloadQuality)];case 1:return e=n.sent(),this.preloadResolution=D.b.getPanoSize(e),this.qualityManager.overrideWindowMaximums(!0),[3,3];case 2:this.preloadResolution=null,this.qualityManager.overrideWindowMaximums(!1),n.label=3;case 3:return this.enableHighRes(!1),[2]}})})},e.prototype.enableHighRes=function(t,e){void 0===t&&(t=!0);var n=null!==this.preloadResolution?this.preloadResolution:t?this.qualityManager.getZoomPanoSize():this.qualityManager.getNavPanoSize();vt.debug("Setting max resolution: "+n),this.tilePrioritizer.maxResolution=n,this.panoRenderer.highResRenderTarget(t,e)},e.prototype.enableZooming=function(t,e){return dt(this,void 0,Promise,function(){var n;return yt(this,function(r){switch(r.label){case 0:return t?(n=D.b.getPanoSizeClass(this.qualityManager.getZoomPanoSize()),[4,this.requestResolution(e,n)]):[3,2];case 1:return[2,r.sent()>=n];case 2:return this.enableHighRes(!1,e),this.resetPano(e),[2,Promise.resolve(!1)]}})})},e.prototype.requestResolution=function(t,e,n,r){return void 0===n&&(n=U.o.CurrentView),void 0===r&&(r=!1),dt(this,void 0,Promise,function(){var o;return yt(this,function(a){switch(a.label){case 0:return this.settings.highResUploadsPerFrame=r?i.c.maxHighResUploadsPerFrame:i.c.highResUploadsPerFrame,this.settings.concurrentDownloads=r?i.c.maxConcurrentDownloads:i.c.concurrentDownloads,this.settings.downloadFullPano=n===U.o.FullPanorama,[4,this.availableResolution(t,e)];case 1:return(o=a.sent())>x.d.HIGH&&(this.qualityManager.overrideWindowMaximums(!0),this.panoRenderer.enableUltraHighQualityMode(t)),(this.currentResolution()<o||D.b.getPanoSize(o)>this.qualityManager.getNavPanoSize())&&(this.enableHighRes(!0,t),this.resetPano(t)),[2,o]}})})},e.prototype.waitForQueue=function(t,e){var n=this,r=new ct.a;return this.engine.after(lt.a.Render).then(function(){var i=n.tilePrioritizer.getQualityQueueSize(t,e);if(!i)return r.notify(1),void r.resolve();var o=n.tilePrioritizer.makeQueueSubscription(t,e,function(t){if(t>0){var e=(i-t)/Math.max(i,1);r.notify(e)}else o.cancel(),r.notify(1),r.resolve()});o.renew()}),r},e.prototype.revertTilingSettings=function(t){this.enableHighRes(!1,t),this.resetPano(t),this.settings.reset()},e.prototype.availableResolution=function(t,e){return this.qualityManager.availableResolution(t,e)},e.prototype.currentResolution=function(){return this.panoRenderer.getCurrentPanoResolution()},e.prototype.resetPano=function(t){this.panoRenderer.resetRenderStatus(t,!1,!0,this.panoRenderer.panoQualityManager.getNavPanoSize()),this.panoRenderer.clearAllQueuedUploadsForPano(t),this.panoRenderer.renderPanoTiles(t,null,!1,!1)},e}(U.Xa);e.default=gt},1129:function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(69),a=n(95),s=n(8),u=n(14),c=n(535),l=function(){return function(t,e){void 0===e&&(e={}),this.context=t,this.options={model_id:Object(a.c)(),start_source:s.q("play",!1)?"autoplay":s.d()?"click":"fullpage",autoplay:s.q("play",!1)||!s.d(),quickstart:1===s.q("qust",0)||1===s.q("qs",0),language_tag:s.q("lang",null),is_mobile:s.k(),iframe:s.d(),aspect_ratio:s.r(),session_id:Object(u.p)(),window:Object(c.c)(),platform:Object(c.a)()},this.options=Object.assign(this.options,e)}}(),p=n(136),h=n(621),f=n(620),d=n(383),y=n(152),v=function(){return function(){this.handlers=[{msgType:d.a,func:function(t,e,n){var r=n.tryGetData(y.a),i={view_mode:e.toMode};r&&(i.interaction_source=r.source),t.track("mode_changed",i)}}]}}(),g=n(487),w=n(396),m=function(){return function(){this.handlers=[{msgType:w.a,func:function(t,e,n){var r=n.tryGetData(y.a);r&&t.track("floor_changed",{floor_id:e.floorName,interaction_source:r.source})}}]}}(),b=n(619),T=n(113),_=150,S=function(){function t(){var t=this;this.firstZoom=!0,this.fromZoom=1,this.toZoom=1,this.handlers=[{msgType:b.a,func:function(e,n,r){t.analytics||(t.analytics=e);var i=r.tryGetData(T.a);i&&i.currentSweep!==t.currentPano&&(t.firstZoom=!0,t.currentPano=i.currentSweep,t.fromZoom=1),t.toZoom=n.zoomLevel,clearTimeout(t.sendTimeout),t.sendTimeout=window.setTimeout(t.trackZoomEvent.bind(t),_)}}]}return t.prototype.trackZoomEvent=function(){var t=this.firstZoom?"initial":"followup";this.analytics.track("zoom_"+t,{from:this.fromZoom,to:this.toZoom,pano:this.currentPano}),this.firstZoom=!1,this.fromZoom=this.toZoom},t}(),D=n(25),P=n(5),x=n(21),E=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.modelLoadingStartTime=0,e.waitingStartTime=0,e.appPlayingTime=0,e.appStartedTime=0,e}return E(e,t),e.prototype.update=function(t){this.modelLoadingStartTime=t.modelLoadingStartTime,this.waitingStartTime=t.waitingStartTime,this.appPlayingTime=t.appPlayingTime,this.appStartedTime=t.appStartedTime},Object.defineProperty(e.prototype,"totalTimeToAppStarting",{get:function(){var t=this.appStartedTime-performance.timing.navigationStart;return this.modelLoadingStartTime&&this.waitingStartTime&&(t-=this.modelLoadingStartTime-this.waitingStartTime),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalTimeToAppPlaying",{get:function(){var t=this.appPlayingTime-performance.timing.navigationStart;return this.modelLoadingStartTime&&this.waitingStartTime&&(t-=this.modelLoadingStartTime-this.waitingStartTime),t},enumerable:!0,configurable:!0}),e}(x.a),O=n(3),M=function(t){return t.data&&t.data.player_options&&t.data.player_options.highlight_reel},A=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},C=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},I=new O.a("showcase-session"),k=new R,U=function(){function t(t,e){var n=this;this.analytics=t,this.engine=e,this.handlers=[{msgType:D.a,func:function(t,e,r){return A(n,void 0,void 0,function(){var n;return C(this,function(r){switch(r.label){case 0:switch(e.phase){case P.a.WAITING:return[3,1];case P.a.LOADING:return[3,2];case P.a.STARTING:return[3,3];case P.a.PLAYING:return[3,5]}return[3,6];case 1:return k.waitingStartTime=Date.now(),t.track("impression",{url_params:s.b(),visible:!0}),[3,6];case 2:return k.modelLoadingStartTime=Date.now(),[3,6];case 3:return k.appStartedTime=Date.now(),I.info("First render, model loaded "+k.totalTimeToAppStarting/1e3),[4,this.engine.waitForModule(i.U)];case 4:return n=r.sent(),t.track("model_loaded",{has_hlr:M(n.getModel()),duration:Date.now()-k.modelLoadingStartTime,duration_from_navigation_start:Date.now()-performance.timing.navigationStart}),[3,6];case 5:return k.appPlayingTime=Date.now(),I.info("Playing, session started "+k.totalTimeToAppPlaying/1e3),t.track("session_started"),window.addEventListener("unload",this.sessionEnded),t.track("load_times",{time_to_app_start:k.totalTimeToAppStarting,time_to_app_playing:k.totalTimeToAppPlaying}),[3,6];case 6:return[2]}})})}}],this.sessionEnded=function(){n.analytics.trackAsync("session_ended",{duration:Date.now()-k.appPlayingTime})}}return t.prototype.dispose=function(){window.removeEventListener("unload",this.sessionEnded)},t}(),L=n(618),j=n(59),N=n(83),z=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),F=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},B=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},G=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},H=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="showcase-analytics",e.loaded=!1,e.handlers=[],e.track=function(t,n){e.analytics.track(t,n)},e}return z(e,t),e.prototype.init=function(t,e){return F(this,void 0,void 0,function(){var n,r,a,s,u,d,y,w=this;return B(this,function(b){switch(b.label){case 0:return n=this,[4,e.getModule(o.default)];case 1:return n.analytics=b.sent(),[4,e.getModule(i.a)];case 2:return r=b.sent(),[4,e.market.waitForData(j.a)];case 3:return a=b.sent(),s={app:{name:a.getProperty(N.b),version:"3.0.17.16-0-g4c07968ed"},screen:Object(c.b)()},this.context=new l(s,t.additionalValues||{}),this.addMessageHandler(new U(this.analytics,e),e),this.addMessageHandler(new v,e),this.addMessageHandler(new f.a,e),this.addMessageHandler(new h.a,e),this.addMessageHandler(new m,e),this.addMessageHandler(new g.a,e),this.addMessageHandler(new S,e),this.addMessageHandler(new L.a,e),u=a.getProperty(N.a),[4,r.getApi().getAppKey(u,p.b[p.a.Segment].keyName)];case 4:return null===(d=b.sent())?(this.log.warn("Unable to get the segment key for "+u+". Analytics will be disabled."),[2]):(y=r.getApi().user,this.analytics.load(p.a.Segment,d,this.context.options,this.context.context,y).then(function(){w.loaded=!0}),[2])}})})},e.prototype.addMessageHandler=function(t,e){var n=this;this.handlers.push(t),t.handlers.forEach(function(t,r){n.bindings.push(e.subscribe(t.msgType,function(r){t.func(n.analytics,r,e.market)}))})},e.prototype.onUpdate=function(t){this.loaded&&Object(L.b)(this.analytics,t)},e.prototype.dispose=function(e){var n,r;t.prototype.dispose.call(this,e);try{for(var i=G(this.handlers),o=i.next();!o.done;o=i.next()){var a=o.value;a.dispose&&a.dispose()}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}this.handlers=[]},e.prototype.getSessionId=function(){return this.context.options.session_id},e}(i.Oa);e.default=H},1132:function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(36),a=n(489),s=n(350),u=n(314),c=new(n(3).a)("passive-support"),l=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});return window.addEventListener("testPassive",function(){},e),window.removeEventListener("testPassive",function(){},e),t}catch(t){return c.warn("Passive Option for addEventListener is not supported, Safari zoom may not perform as expected: "+t),!1}}(),p=n(14);!function(t){t.MOUSE="mouse",t.TOUCH="touch",t.PEN="pen"}(r||(r={}));var h,f=function(){function t(t,e,n){var r=this;this.canvasData=e,this.handledTouchesAsPointer=0,this.activeButtons=s.b.NONE,this.passiveEventFlag=!!l&&{passive:!1},this.onEventCallback=n,window.PointerEvent||(t.addEventListener("mousedown",function(t){return r.onMouseDown(t)}),t.addEventListener("mouseup",function(t){return r.onMouseUp(t)}),t.addEventListener("mousemove",function(t){return r.onMouseMove(t)}),t.addEventListener("mouseenter",function(t){return r.onMouseEnter(t)})),t.addEventListener("contextmenu",function(t){return t.preventDefault()}),t.addEventListener("touchstart",function(t){return r.onTouchStart(t)}),t.addEventListener("touchend",function(t){return r.onTouchEnd(t)}),t.addEventListener("touchmove",function(t){return r.onTouchMove(t)}),t.addEventListener("touchcancel",function(t){return r.onTouchEnd(t)}),t.addEventListener("pointerdown",function(t){return r.onPointerDown(t)}),t.addEventListener("pointerup",function(t){return r.onPointerUp(t)}),t.addEventListener("pointermove",function(t){return r.onPointerMove(t)}),t.addEventListener("pointercancel",function(t){return r.onPointerUp(t)}),t.addEventListener("pointerenter",function(t){return r.onMouseEnter(t)}),document.addEventListener("touchmove",function(t){t.preventDefault()},this.passiveEventFlag)}return t.prototype.onMouseDown=function(t){t.currentTarget.focus(),t.preventDefault(),this.activeButtons|=1<<t.button,this.onEventCallback(new u.a(this.getPointerId(t),this.getPointerPosition(t),t.button,!0))},t.prototype.onMouseUp=function(t){t.preventDefault(),this.activeButtons&=~(1<<t.button),this.onEventCallback(new u.a(this.getPointerId(t),this.getPointerPosition(t),t.button,!1))},t.prototype.onMouseMove=function(t){t.preventDefault(),this.onEventCallback(new u.b(this.getPointerId(t),this.getPointerPosition(t),this.activeButtons))},t.prototype.onMouseEnter=function(t){for(var e=Object(p.m)(t.buttons||t.which,s.a.MIDDLE,s.a.SECONDARY),n=(this.activeButtons^e)&~e,r=s.a.PRIMARY;r<s.a.COUNT;++r){var i=Object(s.c)(r);i&&(n&i)>0&&this.onEventCallback(new u.a(this.getPointerId(t),this.getPointerPosition(t),r,!1))}this.activeButtons=e},t.prototype.onTouchStart=function(t){if(t.currentTarget.focus(),t.preventDefault(),this.handledTouchesAsPointer)--this.handledTouchesAsPointer;else for(var e=0;e<t.changedTouches.length;e++){var n=t.changedTouches.item(e),r=this.getTouchPosition(n);this.onEventCallback(new u.a(n.identifier,r,s.a.PRIMARY,!0))}},t.prototype.onTouchEnd=function(t){if(t.preventDefault(),this.handledTouchesAsPointer)--this.handledTouchesAsPointer;else for(var e=0;e<t.changedTouches.length;e++){var n=t.changedTouches.item(e),r=this.getTouchPosition(n);this.onEventCallback(new u.a(n.identifier,r,s.a.PRIMARY,!1))}},t.prototype.onTouchMove=function(t){if(t.preventDefault(),this.handledTouchesAsPointer)--this.handledTouchesAsPointer;else for(var e=0;e<t.changedTouches.length;e++){var n=t.changedTouches.item(e),r=this.getTouchPosition(n);this.onEventCallback(new u.b(n.identifier,r,s.b.PRIMARY))}},t.prototype.onPointerDown=function(t){switch(t.preventDefault(),t.pointerType){case r.MOUSE:this.onMouseDown(t);break;case r.TOUCH:++this.handledTouchesAsPointer,this.onEventCallback(new u.a(t.pointerId,this.getPointerPosition(t),s.a.PRIMARY,!0))}},t.prototype.onPointerUp=function(t){switch(t.preventDefault(),t.pointerType){case r.MOUSE:this.onMouseUp(t);break;case r.TOUCH:++this.handledTouchesAsPointer,this.onEventCallback(new u.a(t.pointerId,this.getPointerPosition(t),s.a.PRIMARY,!1))}},t.prototype.onPointerMove=function(t){switch(t.preventDefault(),t.pointerType){case r.MOUSE:-1!==t.button?this.activeButtons<t.buttons?this.onMouseDown(t):this.activeButtons>t.buttons&&this.onMouseUp(t):this.onMouseMove(t);break;case r.TOUCH:++this.handledTouchesAsPointer,this.onEventCallback(new u.b(t.pointerId,this.getPointerPosition(t),s.b.PRIMARY))}},t.prototype.getPointerId=function(t){return Object(a.a)(t)?t.pointerId:0},t.prototype.getPointerPosition=function(t){return this.normalizePosition(t.clientX,t.clientY)},t.prototype.getTouchPosition=function(t){return this.normalizePosition(t.clientX,t.clientY)},t.prototype.normalizePosition=function(t,e){return{x:2*(t-this.canvasData.x)/this.canvasData.width-1,y:-2*(e-this.canvasData.y)/this.canvasData.height+1}},t}(),d=n(333),y=n(354),v=n(323);!function(t){t[t.SEMICOLON=59]="SEMICOLON",t[t.PLUSEQUALS=61]="PLUSEQUALS",t[t.DASHUNDERSCORE=173]="DASHUNDERSCORE"}(h||(h={}));var g,w=function(){function t(t){this.keysDown={},this.onEventCallback=t,this.bindHandlers()}return t.prototype.bindHandlers=function(){var t=this;if(window&&window.document){var e=window.document;window.addEventListener("blur",function(){Object.keys(t.keysDown).forEach(function(e){return t.keysDown[e]=!1})}),e.addEventListener("keydown",function(e){if(!e.ctrlKey&&!e.metaKey){e.preventDefault();var n=t.translateFirefoxKeys(e.which||e.keyCode);t.keysDown[n]=!0,t.onEventCallback(new v.a(n,y.a.DOWN))}}),e.addEventListener("keyup",function(e){if(!e.ctrlKey&&!e.metaKey){e.preventDefault();var n=t.translateFirefoxKeys(e.which||e.keyCode);t.keysDown[n]&&t.onEventCallback(new v.a(n,y.a.PRESSED)),t.keysDown[n]=!1,t.onEventCallback(new v.a(n,y.a.UP))}})}},t.prototype.translateFirefoxKeys=function(t){switch(t){case h.SEMICOLON:return d.a.SEMICOLON;case h.PLUSEQUALS:return d.a.PLUSEQUALS;case h.DASHUNDERSCORE:return d.a.DASHUNDERSCORE}return t},t}(),m=n(91);!function(t){t[t.WAITING=0]="WAITING",t[t.WAITINGTOEXCEEDTHRESHOLD=1]="WAITINGTOEXCEEDTHRESHOLD",t[t.GESTURING=2]="GESTURING"}(g||(g={}));var b,T=n(443),_=n(315),S=function(){function t(t,e){void 0===t&&(t=T.a),void 0===e&&(e=T.b),this.startPosition=new m.a,this.pointerDelta=new m.a,this.activeButtons=s.b.NONE,this.state=g.WAITING,this.dragLimit=t,this.holdLimit=e}return t.prototype.start=function(t){if(this.state===g.WAITING&&this.startPosition.copy(t.position),0==(t.buttons&t.buttons-1))this.startTime=Date.now(),this.activeButtons=t.buttons,this.state=g.WAITINGTOEXCEEDTHRESHOLD;else if(this.activeButtons)return this.state=g.GESTURING,new _.a(t.position,this.activeButtons)},t.prototype.stop=function(){var t;return this.state===g.WAITINGTOEXCEEDTHRESHOLD&&Date.now()-this.startTime<this.holdLimit&&(t=new _.b(this.startPosition.add(this.pointerDelta),Object(s.d)(this.activeButtons)),this.pointerDelta.set(0,0)),this.state=g.WAITING,t},t.prototype.onMove=function(t){if(this.state===g.WAITINGTOEXCEEDTHRESHOLD&&(this.pointerDelta.copy(t.position).sub(this.startPosition),this.pointerDelta.length()>this.dragLimit))return this.state=g.GESTURING,new _.a(t.position,t.buttons)},t.prototype.compareState=function(t){return t===this.state},t}(),D=n(313),P=function(){function t(t){void 0===t&&(t=T.a),this.startPosition=new m.a,this.previousPosition=new m.a,this.pointerDelta=new m.a,this.lastPointerMove=Date.now(),this.state=g.WAITING,this.threshold=t}return t.prototype.start=function(t){return this.state===g.WAITING&&(this.startPosition.copy(t.position),this.previousPosition.copy(this.startPosition),this.state=g.WAITINGTOEXCEEDTHRESHOLD),new D.a(t.position,t.buttons)},t.prototype.stop=function(){this.state===g.WAITING&&this.pointerDelta.set(0,0),this.state=g.WAITING;var t=Date.now()-this.lastPointerMove;return new D.b(this.previousPosition,this.pointerDelta,s.b.NONE,t)},t.prototype.onMove=function(t){var e;return this.state===g.WAITINGTOEXCEEDTHRESHOLD&&(this.pointerDelta.copy(t.position).sub(this.startPosition),this.pointerDelta.length()>this.threshold&&(this.state=g.GESTURING)),this.state===g.GESTURING&&(this.pointerDelta.copy(t.position).sub(this.previousPosition),this.pointerDelta.length()>0&&(e=new D.c(this.previousPosition,this.pointerDelta,t.buttons))),this.previousPosition.copy(t.position),this.lastPointerMove=Date.now(),e},t.prototype.compareState=function(t){return t===this.state},t.prototype.compareStartPoint=function(t){return t.equals(this.startPosition)},t.prototype.compareDelta=function(t){return t.equals(this.pointerDelta)},t}(),x=n(319),E=2*Math.SQRT2,R=function(){function t(t){void 0===t&&(t=T.c),this.threshold=t,this.startDistance=0,this.previousDistance=0,this.pointerDelta=new m.a,this.lastPointerMove=Date.now(),this.pinchDelta=0,this.state=g.WAITING}return t.prototype.start=function(t,e){this.state===g.WAITING&&(this.state=g.WAITINGTOEXCEEDTHRESHOLD,this.startDistance=t.position.distanceTo(e.position)/E,this.previousDistance=this.startDistance)},t.prototype.stop=function(){this.state=g.WAITING;var t=Date.now()-this.lastPointerMove;return new x.a(this.pinchDelta,t)},t.prototype.onMove=function(t,e){this.pointerDelta.copy(t.position).sub(e.position);var n,r=this.pointerDelta.length()/E;if(this.state===g.WAITINGTOEXCEEDTHRESHOLD){var i=r-this.startDistance;Math.abs(i)>this.threshold&&(this.state=g.GESTURING)}if(this.state===g.GESTURING){i=r-this.previousDistance;Math.abs(i)>0&&(this.pinchDelta=i,n=new x.b(i))}return this.previousDistance=r,this.lastPointerMove=Date.now(),n},t}(),O=n(7),M=n(318),A=function(){function t(t){void 0===t&&(t=T.d),this.startPointerDelta=new m.a,this.previousPointerDelta=new m.a,this.pointerDelta=new m.a,this.lastPointerMove=Date.now(),this.angleWithDirection=0,this.state=g.WAITING,this.threshold=t}return t.prototype.start=function(t,e){this.state===g.WAITING&&(this.state=g.WAITINGTOEXCEEDTHRESHOLD,this.startPointerDelta.copy(t.position).sub(e.position).normalize(),this.pointerDelta.copy(this.startPointerDelta),this.previousPointerDelta.copy(this.pointerDelta))},t.prototype.stop=function(){this.state=g.WAITING;var t=Date.now()-this.lastPointerMove;return new M.a(this.angleWithDirection,t)},t.prototype.onMove=function(t,e){var n,r;(this.pointerDelta.copy(t.position).sub(e.position).normalize(),this.state===g.WAITINGTOEXCEEDTHRESHOLD)&&((r=Math.acos(Object(O.f)(this.pointerDelta.dot(this.startPointerDelta),-1,1)))>this.threshold&&(this.state=g.GESTURING));if(this.state===g.GESTURING&&(r=Math.acos(Object(O.f)(this.pointerDelta.dot(this.previousPointerDelta),-1,1)))>0){var i=this.previousPointerDelta.x*this.pointerDelta.y-this.previousPointerDelta.y*this.pointerDelta.x;this.angleWithDirection=i>=0?r:-r,n=new M.b(this.angleWithDirection)}return this.previousPointerDelta.copy(this.pointerDelta),this.lastPointerMove=Date.now(),n},t.prototype.compareState=function(t){return t===this.state},t}(),C=n(317),I=function(){function t(t){void 0===t&&(t=T.a),this.startEpicenter=new m.a,this.previousEpicenter=new m.a,this.deltaEpicenter=new m.a,this.currentEpicenter=new m.a,this.pointerCount=0,this.lastPointerMove=Date.now(),this.state=g.WAITING,this.threshold=t}return t.prototype.start=function(t){this.state===g.WAITING&&(Object(p.a)(this.getPointerPositions(t),this.startEpicenter),this.previousEpicenter.copy(this.startEpicenter),this.currentEpicenter.copy(this.previousEpicenter),this.state=g.WAITINGTOEXCEEDTHRESHOLD,this.pointerCount=t.length)},t.prototype.stop=function(){this.state=g.WAITING;var t=this.pointerCount;this.pointerCount=0;var e=Date.now()-this.lastPointerMove;return new C.a(t,this.currentEpicenter,this.deltaEpicenter,e)},t.prototype.onMove=function(t){var e;(Object(p.a)(this.getPointerPositions(t),this.currentEpicenter),this.state===g.WAITINGTOEXCEEDTHRESHOLD)&&(this.currentEpicenter.distanceTo(this.startEpicenter)>this.threshold&&(this.state=g.GESTURING));return this.state===g.GESTURING&&(this.deltaEpicenter.copy(this.currentEpicenter).sub(this.previousEpicenter),e=new C.b(t.length,this.currentEpicenter,this.deltaEpicenter)),this.previousEpicenter.copy(this.currentEpicenter),this.lastPointerMove=Date.now(),e},t.prototype.getPointerPositions=function(t){return t.map(function(t){return t.position})},t}(),k=n(328);!function(t){t[t.NONE=0]="NONE",t[t.CLICK_DRAG=1]="CLICK_DRAG",t[t.PINCH_ROTATE=2]="PINCH_ROTATE",t[t.MULTI_SWIPE_ONLY=3]="MULTI_SWIPE_ONLY"}(b||(b={}));var U,L=function(){function t(t,e,n){this.activeGesture=b.NONE,this.pointers=[],this.couldBeClick=!1,this.onEventCallback=n,this.clicker=new S(t.dragThreshold),this.dragger=new P(t.dragThreshold),this.pincher=new R(t.pinchThreshold),this.rotater=new A(t.rotateThreshold),this.multiswiper=new I(t.dragThreshold),t.disableWheel||this.bindWheelHandlers(e.element)}return Object.defineProperty(t.prototype,"activePointers",{get:function(){return this.pointers.length},enumerable:!0,configurable:!0}),t.prototype.onPointerChange=function(t){this.isMoveEvent(t)?this.onPointerMove(t):this.onPointerButton(t)},t.prototype.isMoveEvent=function(t){return!t.hasOwnProperty("down")},t.prototype.onPointerMove=function(t){this.movePointer(t.id,t.position,t.buttons)},t.prototype.onPointerButton=function(t){t.down?this.addPointer(t.id,t.position,t.button):this.removePointer(t.id,t.button)},t.prototype.bindWheelHandlers=function(t){var e=this;t.addEventListener("wheel",function(t){t.preventDefault(),e.onEventCallback(new k.a({x:t.clientX,y:t.clientY},{x:e.normalizeWheelDelta(t.deltaMode,t.deltaX),y:e.normalizeWheelDelta(t.deltaMode,t.deltaY)}))})},t.prototype.normalizeWheelDelta=function(t,e){return t===WheelEvent.DOM_DELTA_LINE?.7*e*e*e+13*e:e},t.prototype.addPointer=function(t,e,n){var r=Object(s.c)(n);if(r){var i=this.getPointer(t);i&&0==(i.buttons&r)?(i.buttons|=r,i.activeButtons++):this.pointers.push({id:t,position:new m.a(e.x,e.y),buttons:r,activeButtons:1}),this.toggleGestures()}},t.prototype.removePointer=function(t,e){var n=Object(s.c)(e);if(n){var r=this.getPointerIndex(t);if(-1!==r){var i=this.pointers[r];0!=(i.buttons&n)&&(i.buttons&=~n,i.activeButtons--),i.activeButtons||this.pointers.splice(r,1),this.toggleGestures()}}},t.prototype.movePointer=function(t,e,n){var r=this.getPointer(t);if(r)switch(r.position.copy(e),r.buttons!==n&&this.updateOffscreenPointer(r,n),this.activeGesture){case b.CLICK_DRAG:var i=this.clicker.onMove(r);i&&this.onEventCallback(i);var o=this.dragger.onMove(r);o&&this.onEventCallback(o);break;case b.PINCH_ROTATE:var a=this.pincher.onMove(this.pointers[0],this.pointers[1]),s=this.rotater.onMove(this.pointers[0],this.pointers[1]);a&&this.onEventCallback(a),s&&this.onEventCallback(s);case b.MULTI_SWIPE_ONLY:var u=this.multiswiper.onMove(this.pointers);u&&this.onEventCallback(u)}},t.prototype.getPointer=function(t){var e=this.getPointerIndex(t);if(-1!==e)return this.pointers[e]},t.prototype.toggleGestures=function(){var t=this.activeGesture;if(this.activeGesture=this.pointers.length,t===b.CLICK_DRAG&&this.activeGesture===b.NONE&&this.couldBeClick){var e=this.clicker.stop();e&&this.onEventCallback(e)}if(this.couldBeClick=t===b.NONE&&this.activeGesture===b.CLICK_DRAG,this.activeGesture===b.CLICK_DRAG){var n=this.clicker.start(this.pointers[0]);n&&this.onEventCallback(n);var r=this.dragger.start(this.pointers[0]);r&&this.onEventCallback(r)}else if(t===b.CLICK_DRAG){var i=this.dragger.stop();this.onEventCallback(i)}this.activeGesture===b.PINCH_ROTATE?(this.pincher.start(this.pointers[0],this.pointers[1]),this.rotater.start(this.pointers[0],this.pointers[1]),this.multiswiper.start(this.pointers)):t===b.PINCH_ROTATE&&(this.onEventCallback(this.pincher.stop()),this.onEventCallback(this.rotater.stop()),this.onEventCallback(this.multiswiper.stop())),this.activeGesture===b.MULTI_SWIPE_ONLY?this.multiswiper.start(this.pointers):t===b.MULTI_SWIPE_ONLY&&this.onEventCallback(this.multiswiper.stop())},t.prototype.getPointerIndex=function(t){for(var e=0;e<this.pointers.length;e++){if(this.pointers[e].id===t)return e}return-1},t.prototype.updateOffscreenPointer=function(t,e){if(t.buttons=e,0===e){var n=this.getPointerIndex(t.id);this.pointers.splice(n,1),this.toggleGestures()}},t}(),j=n(374),N=n(316),z=n(336),F=(U=function(t,e){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}U(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),B=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},G=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},H=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},Q=function(){function t(t,e,n){this._renew=t,this._cancel=e,this._active=n}return t.prototype.renew=function(){this.active||this._renew()},t.prototype.cancel=function(){this.active&&this._cancel()},Object.defineProperty(t.prototype,"active",{get:function(){return this._active()},enumerable:!0,configurable:!0}),t}(),V=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="input-ini",e.fallbackHandlerMap={},e.directedHandlerMap={},e.priorityHandlerMap={},e.unfilteredHandlerMap={},e.captureHandlerMap={},e.gesturing=!1,e.gestureCapture=new j.a(function(t){return t.object.id}),e.activeIntersections=new j.a(function(t){return t.object.id}),e.eventTypeLookup=new o.a,e.meshTypeLookup=new o.a,e.hoveredMesh=null,e}return F(e,t),e.prototype.init=function(t,e){return B(this,void 0,void 0,function(){var n,r,o,a,s=this;return G(this,function(u){switch(u.label){case 0:return n={disableWheel:!!t.disableWheel},[4,e.getModule(i.e)];case 1:return r=u.sent(),[4,e.market.waitForData(z.a)];case 2:return o=u.sent(),a=this,[4,e.getModule(i.Ha)];case 3:return a.raycaster=u.sent().getRaycaster(),new f(r.element,o,function(t){return s.onPointerEvent(t)}),new w(function(t){return s.onEvent(t)}),this.inputGesture=new L(n,r,function(t){return s.onEvent(t)}),[2]}})})},e.prototype.registerHandler=function(t,e){var n=this;this.insertHandler(t,this.fallbackHandlerMap,e);var r=this.eventTypeLookup.getIndexByType(t,!0);return new Q(function(){return n.registerHandler(t,e)},function(){return n.unregisterHandler(t,e)},function(){return-1!==n.fallbackHandlerMap[r].indexOf(e)})},e.prototype.unregisterHandler=function(t,e){this.removeHandler(t,this.fallbackHandlerMap,e)},e.prototype.registerMeshHandler=function(t,e,n){var r=this,i=this.eventTypeLookup.getIndexByType(t,!0),o=this.meshTypeLookup.getIndexByType(e,!0);this.directedHandlerMap[i]||(this.directedHandlerMap[i]={});var a=this.directedHandlerMap[i];return a[o]||(a[o]=[]),a[o].push(n),new Q(function(){return r.registerMeshHandler(t,e,n)},function(){return r.unregisterMeshHandler(t,e,n)},function(){return-1!==a[o].indexOf(n)})},e.prototype.unregisterMeshHandler=function(t,e,n){var r=this.eventTypeLookup.getIndexByType(t),i=this.directedHandlerMap[r];if(i){var o=i[this.meshTypeLookup.getIndexByType(e)];if(o)for(var a=0;a<o.length;a++)if(o[a]===n){o.splice(a,1);break}}},e.prototype.registerPriorityHandler=function(t,e,n){var r=this,i=this.eventTypeLookup.getIndexByType(t,!0),a=this.meshTypeLookup.getIndexByType(e,!0);this.priorityHandlerMap[i]||(this.priorityHandlerMap[i]={});var s=this.priorityHandlerMap[i];if(s[a]){var u=Object(o.c)(t),c=Object(o.c)(e);throw Error(u+" already has a priority handler registered for mesh type: "+c)}return s[a]=n,new Q(function(){return r.registerPriorityHandler(t,e,n)},function(){return r.unregisterPriorityHandler(t,e,n)},function(){return void 0!==s[a]})},e.prototype.unregisterPriorityHandler=function(t,e,n){var r=this.eventTypeLookup.getIndexByType(t),i=this.priorityHandlerMap[r];if(i){var o=this.meshTypeLookup.getIndexByType(e),a=i[o];a&&n===a&&delete i[o]}},e.prototype.registerUnfilteredHandler=function(t,e){var n=this;this.insertHandler(t,this.unfilteredHandlerMap,e);var r=this.eventTypeLookup.getIndexByType(t);return new Q(function(){return n.registerUnfilteredHandler(t,e)},function(){return n.unregisterUnfilteredHandler(t,e)},function(){return-1!==n.unfilteredHandlerMap[r].indexOf(e)})},e.prototype.unregisterUnfilteredHandler=function(t,e){this.removeHandler(t,this.unfilteredHandlerMap,e)},e.prototype.captureNext=function(t,e){return this.insertHandler(t,this.captureHandlerMap,e),e},e.prototype.removeCaptureHandler=function(t,e){this.removeHandler(t,this.captureHandlerMap,e)},e.prototype.registerMesh=function(t,e,n){void 0===n&&(n="default-group"),this.raycaster.addTarget(t,e,void 0,n)},e.prototype.unregisterMesh=function(t){this.raycaster.removeTarget(t)},e.prototype.enableMeshGroup=function(t,e){this.raycaster.enableForGroup(t,e)},e.prototype.onPointerEvent=function(t){var e,n,r,i,o=!t.hasOwnProperty("down"),a=!o&&t.down,s=!a&&!o;if(o||a){this.raycaster.updatePointerPosition(t.position),this.activeIntersections.clear();try{for(var u=H(this.raycaster.cast()),c=u.next();!c.done;c=u.next()){var l=c.value;this.activeIntersections.add(l)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}if(!this.gesturing){this.gestureCapture.clear();try{for(var p=H(this.activeIntersections),h=p.next();!h.done;h=p.next()){l=h.value;this.gestureCapture.add(l)}}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}this.updateHoveredMesh()}a&&(this.gesturing=!0),this.onEvent(t)}this.inputGesture.onPointerChange(t),s&&this.onEvent(t),0===this.inputGesture.activePointers&&(this.activeIntersections.clear(),this.gestureCapture.clear(),this.gesturing=!1)},e.prototype.updateHoveredMesh=function(){var t,e,n,r,i=this.activeIntersections.getByIndex(0),a=!1;if(this.hoveredMesh&&(void 0===i||i.object!==this.hoveredMesh)){var s=this.getMeshHandler(N.b,Object(o.b)(this.hoveredMesh),this.priorityHandlerMap);if(s&&(a=s(new N.b,this.hoveredMesh,i)||!1),!a){var u=this.getMeshHandler(N.b,Object(o.b)(this.hoveredMesh),this.directedHandlerMap);if(u)try{for(var c=H(u),l=c.next();!l.done;l=c.next()){(0,l.value)(new N.b,this.hoveredMesh,i)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}}}var p=!1;if(i&&i.object!==this.hoveredMesh){var h=this.getMeshHandler(N.a,Object(o.b)(i.object),this.priorityHandlerMap);if(h&&(p=h(new N.a,i.object,i)||!1),!p){var f=this.getMeshHandler(N.a,Object(o.b)(i.object),this.directedHandlerMap);if(f)try{for(var d=H(f),y=d.next();!y.done;y=d.next()){(0,y.value)(new N.a,i.object,i)}}catch(t){n={error:t}}finally{try{y&&!y.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}}}this.hoveredMesh=i&&i.object||null},e.prototype.onEvent=function(t){var e,n,r,i,o,a,s=this.eventTypeLookup.getIndexByInstance(t),u=this.captureHandlerMap[s];if(u&&u.length>0){try{for(var c=H(u),l=c.next();!l.done;l=c.next()){(0,l.value)(t)}}catch(t){e={error:t}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}u.length=0}else{var p=this.unfilteredHandlerMap[s];if(p)try{for(var h=H(p),f=h.next();!f.done;f=h.next()){(0,f.value)(t)}}catch(t){r={error:t}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}var d=this.iterateMeshCallbacks(t,this.gesturing?this.gestureCapture:this.activeIntersections),y=this.fallbackHandlerMap[s];if(!d&&y)try{for(var v=H(y),g=v.next();!g.done;g=v.next()){(0,g.value)(t)}}catch(t){o={error:t}}finally{try{g&&!g.done&&(a=v.return)&&a.call(v)}finally{if(o)throw o.error}}}},e.prototype.iterateMeshCallbacks=function(t,e){var n,r,i,a,s=!1,u=this.eventTypeLookup.getIndexByInstance(t);try{for(var c=H(e),l=c.next();!l.done;l=c.next()){var p=l.value;if(s)break;var h=p.object,f=this.activeIntersections.get(h.id);for(var d in this.priorityHandlerMap[u])if(p.object instanceof this.meshTypeLookup.getTypeByIndex(parseInt(d,10))){var y=this.priorityHandlerMap[u]&&this.priorityHandlerMap[u][d];if(y&&(s=!0,y(t,h,f)))return!0}for(var d in this.directedHandlerMap[u])if(p.object instanceof this.meshTypeLookup.getTypeByIndex(parseInt(d,10))){var v=this.directedHandlerMap[u]&&this.directedHandlerMap[u][d];if(v&&v.length>0){s=!0;try{for(var g=H(v),w=g.next();!w.done;w=g.next()){(0,w.value)(t,h,f)}}catch(t){i={error:t}}finally{try{w&&!w.done&&(a=g.return)&&a.call(g)}finally{if(i)throw i.error}}}}}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return Object(o.b)(t)===_.b&&this.raycaster.onClick(),s},e.prototype.insertHandler=function(t,e,n){var r=this.eventTypeLookup.getIndexByType(t,!0);e[r]||(e[r]=[]),e[r].push(n)},e.prototype.removeHandler=function(t,e,n){var r=e[this.eventTypeLookup.getIndexByType(t)];if(r)for(var i=0;i<r.length;i++)if(r[i]===n){r.splice(i,1);break}},e.prototype.getMeshHandler=function(t,e,n){var r=n[this.eventTypeLookup.getIndexByType(t)];return r?r[this.meshTypeLookup.getIndexByType(e)]:null},e}(i.z);e.default=V},1174:function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(113),a=n(391),s=n(47),u=n(404),c=n(145),l=n(324),p=n(396),h=n(25),f=n(22),d=n(366),y=n(365),v=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),g=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},w=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="label-viewdata",e.selectionEnabled=!0,e.sweepMap={},e.sweepIdList=[],e.sweepInteractionMap={},e.enableSweepSelection=function(t){return g(e,void 0,Promise,function(){return w(this,function(t){return this.selectionEnabled=!0,[2]})})},e.disableSweepSelection=function(t){return g(e,void 0,Promise,function(){return w(this,function(t){return this.selectionEnabled=!1,this.viewData.selectedSweep.value&&(this.viewData.selectedSweep.value=null),[2]})})},e.onSweepSelectCommand=function(t){return g(e,void 0,Promise,function(){return w(this,function(e){return this.selectionEnabled?(this.modifySelectAnimation(t.id,t.duration),t.selected?this.viewData.selectedSweep.value=this.viewData.getSweep(t.id):this.viewData.selectedSweep.value=null,[2]):[2]})})},e.onSweepHoverCommand=function(t){return g(e,void 0,Promise,function(){return w(this,function(e){return this.modifySelectAnimation(t.id,t.duration),t.hovered?this.viewData.hoveredSweep.value=this.viewData.getSweep(t.id):this.viewData.hoveredSweep.value=null,[2]})})},e.onSweepVisibilityCommand=function(t){return g(e,void 0,Promise,function(){return w(this,function(e){return this.viewData.getState(t.sweepId).visible=t.visible,[2]})})},e.updateVisibility=function(t){return g(e,void 0,Promise,function(){var e,n,r=this;return w(this,function(i){return this.viewmodeData.isPano()?t&&(e=this.viewData.getSweep(t).neighbours,this.viewData.iterate(function(t){r.viewData.getState(t.id).visible=-1!==e.indexOf(t.id)})):(n=-1===this.floorsViewData.currentFloor,this.viewData.iterate(function(t){var e=r.floorsViewData.currentFloor===t.floor;r.viewData.getState(t.id).visible=e||n})),t&&(this.viewData.getState(t).visible=!1),[2]})})},e}return v(e,t),e.prototype.init=function(t,e){return g(this,void 0,void 0,function(){var t,n,r,i,f,d=this;return w(this,function(v){switch(v.label){case 0:return t=this,[4,e.market.waitForData(o.a)];case 1:return t.data=v.sent(),this.updateViewData=this.updateViewData.bind(this),this.makeViewDataForSweep=this.makeViewDataForSweep.bind(this),n=Object(s.a)(new a.a(this.data,this.data.getSweepList())),e.market.register(this,a.a,n),r=this,[4,e.market.waitForData(a.a)];case 2:return r.viewData=v.sent(),n.setViewDataFactory(this.makeViewDataForSweep),this.updateViewData(),this.bindings.push(e.commandBinder.addBinding(u.d,this.onSweepSelectCommand),e.commandBinder.addBinding(u.c,this.onSweepHoverCommand),e.commandBinder.addBinding(a.b,this.onSweepVisibilityCommand),e.commandBinder.addBinding(u.b,this.enableSweepSelection),e.commandBinder.addBinding(u.a,this.disableSweepSelection),this.data.onChanged(function(){return d.updateViewData()}),this.data.onPropertyChanged("currentSweep",this.updateVisibility),e.msgBus.subscribe(y.e,function(){return d.updateViewData()})),i=this,[4,e.market.waitForData(c.a)];case 3:return i.viewmodeData=v.sent(),f=this,[4,e.market.waitForData(l.a)];case 4:return f.floorsViewData=v.sent(),this.bindings.push(e.subscribe(p.a,function(){return d.updateVisibility(d.viewData.data.currentSweep)}),e.subscribe(h.b,function(){return d.updateVisibility(d.viewData.data.currentSweep)}),this.viewmodeData.makeModeChangeSubscription(function(){return d.updateVisibility(d.viewData.data.currentSweep)})),this.updateVisibility(this.viewData.data.currentSweep),[2]}})})},e.prototype.updateViewData=function(){var t=this;this.sweepIdList.length=0,this.sweepInteractionMap=this.viewData.sweepInteractionMap,this.data.getSweepList().forEach(function(e,n){t.sweepMap[e.id]=e,t.viewData.derivedData[e.id]=t.makeViewDataForSweep(e,n),t.viewData.sweepInteractionMap[e.id]=t.viewData.derivedData[e.id],t.sweepIdList.push(e.id)}),this.viewData.sweepIdList=this.sweepIdList,this.viewData.sweepMap=this.sweepMap,this.viewData.notifyOnChanged()},e.prototype.onUpdate=function(t){this.viewData.updateAnimations(t)},e.prototype.modifySelectAnimation=function(t,e){var n=this.viewData.getState(t).selected;1===n.endValue?n.modifyAnimation(n.value,0,e):n.modifyAnimation(0,1,e)},e.prototype.makeViewDataForSweep=function(t,e){return{id:t.id,interaction:this.sweepInteractionMap[t.id]?this.sweepInteractionMap[t.id].interaction:d.a.NONE,floor:t.floor,position:t.position,index:t.index,alignmentType:t.alignmentType,dataIndex:e,placed:t.placementType===f.b.MANUAL,enabled:t.enabled,name:t.name}},e}(i.hb);e.default=m},1175:function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(59),a=n(3),s=n(1053),u=n(96),c=(n(92),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},p=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},h=new a.a("Locale"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="locale",e._languageCode="en-US",e}return c(e,t),e.prototype.init=function(t,n){return l(this,void 0,void 0,function(){var t,r,i,a,c;return p(this,function(l){switch(l.label){case 0:return[4,n.market.waitForData(o.a)];case 1:return t=l.sent(),r=t.tryGetProperty("lang","en"),e.languageCodeMap.hasOwnProperty(r)&&(this._languageCode=e.languageCodeMap[r]),this.polyglot=new s({onMissingKey:function(t){return h.warn("Missing phrase key:"+t),e.missingPrefix+t}}),i="./locale/strings-"+this._languageCode+".json",[4,new u.RequestQueue({retries:0}).get(i)];case 2:return a=l.sent(),c=JSON.parse(a),this.polyglot.extend(c),h.info("Loaded phrases - "+i),[2]}})})},e.prototype.t=function(t){return this.polyglot.t(t)},Object.defineProperty(e.prototype,"languageCode",{get:function(){return this._languageCode},enumerable:!0,configurable:!0}),e.languageCodeMap={en:"en-US",es:"es-MX",fr:"fr-FR",de:"de-DE",ru:"ru-RU",cn:"cn-CN",jp:"jp-JP"},e.missingPrefix="FIX-",e}(i.H);e.default=f},1176:function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(419),a=n(113),s=n(405),u=n(4),c=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},p=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="snapshots",e}return c(e,t),e.prototype.init=function(t,e){return l(this,void 0,void 0,function(){var n,r,i;return p(this,function(s){switch(s.label){case 0:return this.engine=e,e.market.register(this,o.a),[4,t.snapshotsStore.read()];case 1:return n=s.sent()||{},r=this,[4,e.market.waitForData(a.a)];case 2:for(i in r.sweepData=s.sent(),n)this.processSnapshot(n[i]);return this.snapshotsData=new o.a(n),e.market.update(this,this.snapshotsData),[2]}})})},e.prototype.processSnapshot=function(t){var e=t.metadata.camera_mode===u.a.Panorama,n=!Object(s.b)(this.sweepData,t.metadata.scan_id);if(t.is360=e&&n,e){var r=this.sweepData.getSweep(t.metadata.scan_id);r&&t.metadata.camera_position.copy(r.position)}},e.prototype.addSnapshot=function(t){this.processSnapshot(t),this.snapshotsData.add(t),this.engine.market.update(this,this.snapshotsData)},e}(i.Ua);e.default=h},1177:function(t,e,n){"use strict";n.r(e);var r,i=n(419),o=n(68),a=n(0),s=n(230),u=n(4),c=n(623),l=n(3),p=n(113),h=n(7),f=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},y=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},v=new l.a("camera-start"),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="camera-start",e.paramStart=null,e}return f(e,t),e.prototype.init=function(t,e){return d(this,void 0,void 0,function(){var n,r,a,s,u,c,l,h;return y(this,function(f){switch(f.label){case 0:return this.engine=e,n=this,[4,e.market.waitForData(p.a)];case 1:return n.sweepData=f.sent(),[4,t.cameraStartSync.load()];case 2:return r=f.sent(),a=this,[4,e.market.waitForData(i.a)];case 3:return a.snapshotsData=f.sent(),t.startOverride&&(s=this.parseStartParam(t.startOverride))&&(this.paramStart=s),this.validStartPano(this.paramStart)||(this.paramStart=null),u=r&&r.icon||void 0,c=r&&r.hasCameraPose&&this.validStartPano(r.pose)&&r.pose,l=r&&r.thumb||this.getIconThumbnail(u)||void 0,h=this.paramStart||this.getIconStartPose(u)||c||this.getStartFallback(),this.data=new o.a(u,l,h),e.market.register(this,o.a,this.data),t.createSyncMonitor&&t.cameraStartSync.addMonitor(t.createSyncMonitor()),[2]}})})},e.prototype.parseStartParam=function(t){var e=s.a.deserialize(t);return e?{mode:e.mode,camera:{position:e.position,rotation:e.quaternion,zoom:e.zoom},pano:{uuid:e.panoId,position:e.position,rotation:e.quaternion},floorVisibility:e.floorVisibility}:(v.info("failed to parse &start param"),null)},e.prototype.updateStartLocationFromSnapshot=function(t){var e=this.buildCameraStart(t),n=new o.a(t.sid,t.thumbnailUrl,e);this.engine.broadcast(new c.a(t.is360)),this.data.copy(n),this.engine.market.update(this,this.data)},e.prototype.buildCameraStart=function(t){var e={mode:t.metadata.camera_mode,camera:{position:t.metadata.camera_position,rotation:t.metadata.camera_quaternion,zoom:t.metadata.ortho_zoom},pano:{}};return e.mode===u.a.Panorama&&(e.pano={uuid:t.metadata.scan_id,position:t.metadata.camera_position,rotation:t.metadata.camera_quaternion}),e.floorVisibility=t.metadata.floorVisibility,e},e.prototype.defaultCameraStart=function(t){return{mode:u.a.Panorama,camera:{position:t.position,rotation:Object(h.m)(t.rotation),zoom:0},pano:{uuid:t.id,position:t.position,rotation:t.rotation}}},e.prototype.validStartPano=function(t){return!!t&&(t.mode!==u.a.Panorama||!!t.pano.uuid&&this.sweepData.containsSweep(t.pano.uuid))},e.prototype.getStartFallback=function(){var t=this.sweepData.getFirstAlignedSweep();return this.defaultCameraStart(t||this.sweepData.getFirstSweep())},e.prototype.getIconStartPose=function(t){var e=null;return t&&t in this.snapshotsData.collection&&(e=(new o.b).copy(this.buildCameraStart(this.snapshotsData.get(t)))),this.validStartPano(e)||(e=null),e},e.prototype.getIconThumbnail=function(t){if(t&&t in this.snapshotsData.collection)return this.snapshotsData.get(t).thumbnailUrl},e}(a.d);e.default=g},1178:function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(336),a=n(538),s=n(537),u=n(536),c=n(19),l=n(625),p=n(14),h=n(490),f=n(360),d=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},v=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},g=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return d(e,t),e}(Error),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="canvas",e.getNewX=function(){return 0},e.getNewY=function(){return 0},e.getNewWidth=function(t){return t.width},e.getNewHeight=function(t){return t.height},e.activeTransitions=[],e.activeTransitionMap={left:null,top:null,width:null,height:null},e.onResize=function(t){t.propertyName in u.b&&(e.resolveActiveTransition(t.propertyName),e._canvas.style.transitionDuration=e.stringifyTransitionDurations())},e.onWindowResize=function(){e.transitionDurations.left=e.transitionDurations.top=e.transitionDurations.width=e.transitionDurations.height="0s",e._canvas.style.transitionDuration=e.stringifyTransitionDurations(),e.applySize(),e.applyPosition(),e.activeTransitions.forEach(e.resolveActiveTransition.bind(e)),e._canvas.style.transitionDuration=e.stringifyTransitionDurations()},e.resizeCanvas=function(t){return y(e,void 0,void 0,function(){var e,n=this;return v(this,function(r){return t.resizeDimensions?(this.activeTransitions.forEach(this.resolveActiveTransition.bind(this)),e=t.resizeDimensions.map(function(t){var e=t.property,r=t.setDimension,i=t.duration;switch(e){case u.b.height:n.setHeight(r,i);break;case u.b.width:n.setWidth(r,i);break;case u.b.top:n.setY(r,i);break;case u.b.left:n.setX(r,i)}var o=new c.a;return n.activeTransitionMap[e]=o,n.activeTransitions.push(e),o}),this.resolveNoopTransitions(),this.hasActiveTransitions()||(this.canvasBounds=this._canvas.getBoundingClientRect()),[2,Promise.all(e)]):[2]})})},e}return d(e,t),e.prototype.init=function(t,e){return y(this,void 0,void 0,function(){var n,r,i,a,s=this;return v(this,function(c){if(this.engine=e,this.container=t.container,!this.container)throw new w;this.container.appendChild(t.canvas),this.containerBounds=this.container.getBoundingClientRect(),this._canvas=t.canvas,this._canvas.setAttribute("tabindex","-1"),this._canvas.style.position="absolute",this._canvas.style.left="0",this._canvas.style.top="0",this.transitionDurations={left:"0s",top:"0s",width:"0s",height:"0s",filter:"0.4s"},this._canvas.style.transitionProperty=Object.keys(this.transitionDurations).join(","),this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this.updateTransitions(),this.bindings.push(Object(f.c)(f.b.RESIZE,this.onWindowResize),e.commandBinder.addBinding(u.a,this.resizeCanvas),this.makeTransitionEndSubscription(),e.commandBinder.addBinding(l.a,function(t){return y(s,void 0,void 0,function(){return v(this,function(e){return[2,this.screenToCanvasPoint(t.x,t.y)]})})}),e.commandBinder.addBinding(h.a,this.blur.bind(this)));try{for(i=g(this.bindings),a=i.next();!a.done;a=i.next())a.value.renew()}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return this.canvasBounds=this._canvas.getBoundingClientRect(),this.containerBounds=this.container.getBoundingClientRect(),this.data=new o.a(this.canvasBounds.width,this.canvasBounds.height),e.market.register(this,o.a,this.data),[2]})})},e.prototype.resolveNoopTransitions=function(){var t=this.containerBounds;this.getNewHeight(t)!==this.data.height&&parseInt(this.transitionDurations[u.b.height],10)||this.resolveActiveTransition(u.b.height),this.getNewWidth(t)!==this.data.width&&parseInt(this.transitionDurations[u.b.width],10)||this.resolveActiveTransition(u.b.width),this.getNewY(t)!==this.data.y&&parseInt(this.transitionDurations[u.b.top],10)||this.resolveActiveTransition(u.b.top),this.getNewX(t)!==this.data.x&&parseInt(this.transitionDurations[u.b.left],10)||this.resolveActiveTransition(u.b.left),this._canvas.style.transitionDuration=this.stringifyTransitionDurations()},e.prototype.makeTransitionEndSubscription=function(){var t=this,e=!1;return{renew:function(){e||(t.element.addEventListener("transitionend",t.onResize),e=!0)},cancel:function(){e&&(t.element.removeEventListener("transitionend",t.onResize),e=!1)}}},e.prototype.dispose=function(e){t.prototype.dispose.call(this,e)},Object.defineProperty(e.prototype,"element",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.canvasBounds.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.canvasBounds.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.canvasBounds.left},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.canvasBounds.top},enumerable:!0,configurable:!0}),e.prototype.onUpdate=function(){var t=this.container.getBoundingClientRect(),e=this.containerHasChanged(t);e&&(this.containerBounds=t,this.updateTransitions()),(e||this.hasActiveTransitions())&&(this.canvasBounds=this._canvas.getBoundingClientRect());var n=this.data.width!==this.width||this.data.height!==this.height,r=this.data.x!==this.x||this.data.y!==this.y;n&&(this.data.width=this.width,this.data.height=this.height,this.engine.market.update(this,this.data),this.engine.broadcast(new a.a(this.width,this.height))),r&&(this.data.x=this.x,this.data.y=this.y,this.engine.market.update(this,this.data),this.engine.broadcast(new s.a(this.x-this.containerBounds.left,this.y-this.containerBounds.top)))},e.prototype.containerHasChanged=function(t){return t.left!==this.containerBounds.left||t.top!==this.containerBounds.top||t.width!==this.containerBounds.width||t.height!==this.containerBounds.height},e.prototype.setX=function(t,e){void 0===e&&(e=0),this.getNewX="number"==typeof t?function(){return t}:t,this.transitionDurations.left=e+"ms",this.updateTransitions()},e.prototype.setY=function(t,e){void 0===e&&(e=0),this.getNewY="number"==typeof t?function(){return t}:t,this.transitionDurations.top=e+"ms",this.updateTransitions()},e.prototype.setWidth=function(t,e){void 0===e&&(e=0),this.getNewWidth="number"==typeof t?function(){return t}:t,this.transitionDurations.width=e+"ms",this.updateTransitions()},e.prototype.setHeight=function(t,e){void 0===e&&(e=0),this.getNewHeight="number"==typeof t?function(){return t}:t,this.transitionDurations.height=e+"ms",this.updateTransitions()},e.prototype.screenToCanvasPoint=function(t,e){return{x:t-this.x,y:e-this.y}},e.prototype.blur=function(t){return y(this,void 0,void 0,function(){return v(this,function(e){switch(e.label){case 0:return this.transitionDurations.filter=t.duration+"ms",this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this._canvas.style.filter="blur("+t.pixelBlur+"px)",[4,Object(p.d)(t.duration)];case 1:return e.sent(),0===t.pixelBlur&&(this._canvas.style.filter=null),[2]}})})},e.prototype.updateTransitions=function(){this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this.applySize(),this.applyPosition()},e.prototype.applySize=function(){this._canvas.style.width=this.getNewWidth(this.containerBounds)+"px",this._canvas.style.height=this.getNewHeight(this.containerBounds)+"px"},e.prototype.applyPosition=function(){this._canvas.style.left=this.getNewX(this.containerBounds)+"px",this._canvas.style.top=this.getNewY(this.containerBounds)+"px"},e.prototype.stringifyTransitionDurations=function(){var t=this;return Object.keys(this.transitionDurations).map(function(e){return t.transitionDurations[e]}).join(",")},e.prototype.resolveActiveTransition=function(t){var e=this.activeTransitions.indexOf(t);-1!==e&&this.activeTransitions.splice(e,1);var n=this.activeTransitionMap[t];n&&n.resolve(),this.activeTransitionMap[t]=null,this.transitionDurations[t]="0s"},e.prototype.hasActiveTransitions=function(){return this.activeTransitions.length>0},e}(i.e);e.default=m},1179:function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=n(360),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},u=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e}(Error),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="container-resizer",e.resizeContainer=function(){e.containerElement.style.height=window.innerHeight+"px"},e}return a(e,t),e.prototype.init=function(t){return s(this,void 0,void 0,function(){return u(this,function(e){if(!t.container)throw new c;return this.containerElement=t.container,this.resizeSub=Object(o.c)(o.b.RESIZE,this.resizeContainer),this.resizeSub.renew(),[2]})})},e.prototype.dispose=function(){this.resizeSub.cancel()},e}(i.b);e.default=l},1180:function(t,e,n){"use strict";n.r(e);var r,i=n(0),o=(n(1061),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},s=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="mouse-cursor",e}return o(e,t),e.prototype.init=function(t,e){return a(this,void 0,void 0,function(){return s(this,function(t){return document.body.classList.add("cursor"),[2]})})},e.prototype.changeCursor=function(t){t!==this.activeCursor&&(document.body.classList.remove(this.activeCursor),this.activeCursor=t,document.body.classList.add(this.activeCursor))},e}(i.X);e.default=u},310:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r,i=n(311),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a)},311:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){return function(){this.eventType="input"}}()},312:function(t,e,n){"use strict";var r=n(327),i=n(21),o=n(146),a=n(1),s=n(10),u=n(17),c=function(t,e){return t&&e?t.equals(e):t===e},l=n(47),p=n(320),h=n(144);n.d(e,"b",function(){return y}),n.d(e,"a",function(){return m});var f,d=(f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(t,e,n){void 0===n&&(n=!0),e.position=v(t.position,e.position,n),e.rotation=v(t.rotation,e.rotation,n),e.projection=v(t.projection,e.projection,n)},v=function(t,e,n){return void 0===n&&(n=!0),t&&!e?e=t.clone():t&&e?e.copy(t):n&&(e=void 0),e},g=function(t){return Object(l.a)({position:Object(l.a)(new a.a),rotation:Object(l.a)(new s.a),projection:Object(r.c)(t),focalDistance:-1})},w=function(){return Object(l.a)({startTime:0,duration:0,active:!1,type:null,progress:Object(l.a)(new o.a(0)),blackoutProgress:Object(l.a)(new o.a(0)),from:Object(l.a)({position:Object(l.a)(new a.a),rotation:Object(l.a)(new s.a),projection:new h.a}),to:Object(l.a)({position:Object(l.a)(new a.a),rotation:Object(l.a)(new s.a),projection:new h.a}),rotationDelay:0,rotationDuration:1,matrixDelay:0,matrixDuration:1,activeInternal:!1})},m=function(t){function e(e,n){var i=t.call(this)||this;return i.width=e,i.height=n,i.pose=g(e/n),i.transition=w(),i.setCameraDimensions(e,n),i._baseFovY=u.a.DEG2RAD*r.a.fov,i}return d(e,t),e.prototype.setCameraDimensions=function(t,e){this.width=t,this.height=e,this.pose.projection.copy(this.isOrtho()?Object(r.b)(t,e,e/(2*this.orthoZoom())):Object(r.c)(t/e))},Object.defineProperty(e.prototype,"baseFovY",{get:function(){return this._baseFovY},enumerable:!0,configurable:!0}),e.prototype.aspect=function(){return this.pose.projection.elements[5]/this.pose.projection.elements[0]},e.prototype.fovY=function(){return 2*Math.atan(1/this.pose.projection.elements[5])},e.prototype.fovX=function(){return 2*Math.atan(1*this.aspect()/this.pose.projection.elements[5])},e.prototype.isOrtho=function(){return Object(p.n)(this.pose.projection)},e.prototype.baseZoom=function(){return this.pose.projection.elements[0]/2},e.prototype.zoom=function(){return this.isOrtho()?this.orthoZoom():this.baseFovY/this.fovY()},e.prototype.orthoZoom=function(){return Object(p.e)(this.pose.projection)},e.prototype.copyTransition=function(t){this.transition.active=t.active,this.transition.activeInternal=t.activeInternal,this.transition.type=t.type,this.transition.startTime=t.startTime,this.transition.duration=t.duration,this.transition.rotationDelay=t.rotationDelay,this.transition.rotationDuration=t.rotationDuration,this.transition.matrixDelay=t.matrixDelay,this.transition.matrixDuration=t.matrixDuration,t.progress&&this.transition.progress.copy(t.progress),t.blackoutProgress&&this.transition.blackoutProgress.copy(t.blackoutProgress),t.from&&y(t.from,this.transition.from),t.to&&y(t.to,this.transition.to)},e.prototype.canTransition=function(){return!this.transition.active},e.prototype.update=function(t){this.copy(t)},e.prototype.clone=function(){var t=new e(this.width,this.height);return t.copy(this),t},e.prototype.copy=function(t){var e=this;this.pose.atomic(function(){e.pose.position.copy(t.pose.position),e.pose.rotation.copy(t.pose.rotation),e.pose.focalDistance=t.pose.focalDistance,e.pose.projection.copy(t.pose.projection),e.pose.setDirty()}),this._baseFovY=t.baseFovY,this.transition.atomic(function(){e.copyTransition(t.transition),e.transition.setDirty()})},e.prototype.shallowIsEqual=function(t){return this.pose.position.equals(t.pose.position)&&this.pose.rotation.equals(t.pose.rotation)&&this.pose.projection.equals(t.pose.projection)&&this.pose.focalDistance===t.pose.focalDistance&&this.baseFovY===t.baseFovY},e.prototype.isEqual=function(t){return this.shallowIsEqual(t)&&this.transitionIsEqual(t.transition)},e.prototype.transitionIsEqual=function(t){return this.transition.active===t.active&&this.transition.type===t.type&&this.transition.progress.equals(t.progress)&&this.transition.blackoutProgress.equals(t.blackoutProgress)&&this.transition.rotationDelay===t.rotationDelay&&this.transition.rotationDuration===t.rotationDuration&&this.transition.matrixDelay===t.matrixDelay&&this.transition.matrixDuration===t.matrixDuration&&this.transition.activeInternal===t.activeInternal&&c(this.transition.from.position,t.from.position)&&c(this.transition.from.rotation,t.from.rotation)&&c(this.transition.from.projection,t.from.projection)&&c(this.transition.to.position,t.to.position)&&c(this.transition.to.rotation,t.to.rotation)&&c(this.transition.to.projection,t.to.projection)&&this.transition.startTime===t.startTime&&this.transition.duration===t.duration},e}(i.a)},313:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"c",function(){return s}),n.d(e,"b",function(){return u});var r,i=n(310),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.position=e,r.buttons=n,r}return o(e,t),e}(i.a),s=function(t){function e(e,n,r){var i=t.call(this)||this;return i.position=e,i.delta=n,i.buttons=r,i}return o(e,t),e}(i.a),u=function(t){function e(e,n,r,i){var o=t.call(this,e,n,r)||this;return o.timeSinceLastMove=i,o}return o(e,t),e}(s)},314:function(t,e,n){"use strict";n.d(e,"a",function(){return s}),n.d(e,"b",function(){return u});var r,i=n(311),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a),s=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.id=e,o.position=n,o.button=r,o.down=i,o}return o(e,t),e}(a),u=function(t){function e(e,n,r){var i=t.call(this)||this;return i.id=e,i.position=n,i.buttons=r,i}return o(e,t),e}(a)},315:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return s});var r,i=n(310),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.position=e,r.buttons=n,r}return o(e,t),e}(i.a),s=function(t){function e(e,n){var r=t.call(this)||this;return r.position=e,r.button=n,r}return o(e,t),e}(i.a)},316:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return s});var r,i=n(311),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="hover",e}return o(e,t),e}(i.a),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="unhover",e}return o(e,t),e}(i.a)},317:function(t,e,n){"use strict";n.d(e,"b",function(){return s}),n.d(e,"a",function(){return u});var r,i=n(310),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=function(t){function e(e,n,r){var i=t.call(this)||this;return i.pointerCount=e,i.position=a({},n),i.delta=a({},r),i}return o(e,t),e}(i.a),u=function(t){function e(e,n,r,i){var o=t.call(this,e,n,r)||this;return o.timeSinceLastMove=i,o}return o(e,t),e}(s)},318:function(t,e,n){"use strict";n.d(e,"b",function(){return a}),n.d(e,"a",function(){return s});var r,i=n(310),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.rotateDelta=e,n}return o(e,t),e}(i.a),s=function(t){function e(e,n){var r=t.call(this,e)||this;return r.timeSinceLastMove=n,r}return o(e,t),e}(a)},319:function(t,e,n){"use strict";n.d(e,"b",function(){return a}),n.d(e,"a",function(){return s});var r,i=n(310),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.pinchDelta=e,n}return o(e,t),e}(i.a),s=function(t){function e(e,n){var r=t.call(this,e)||this;return r.timeSinceLastMove=n,r}return o(e,t),e}(a)},320:function(t,e,n){"use strict";n.d(e,"n",function(){return G}),n.d(e,"b",function(){return H}),n.d(e,"c",function(){return Q}),n.d(e,"d",function(){return V}),n.d(e,"i",function(){return W}),n.d(e,"l",function(){return X}),n.d(e,"j",function(){return q}),n.d(e,"k",function(){return Y}),n.d(e,"h",function(){return Z}),n.d(e,"f",function(){return K}),n.d(e,"q",function(){return J}),n.d(e,"p",function(){return $}),n.d(e,"g",function(){return tt}),n.d(e,"o",function(){return et}),n.d(e,"a",function(){return nt}),n.d(e,"m",function(){return rt}),n.d(e,"e",function(){return it});var r,i,o,a,s,u,c,l,p,h,f,d,y,v,g,w,m,b,T,_,S,D,P,x,E,R,O,M,A=n(91),C=n(1),I=n(49),k=n(10),U=n(50),L=n(334),j=n(11),N=n(144),z=n(48),F=n(7),B=n(149),G=function(t){return 1===t.elements[15]},H=function(t,e){var n=new C.a;if(e.intersectBox(t,n),!n)return null;var r=new C.a;return Object(F.e)(n.x,t.max.x,B.a.epsilon)?r.x=-1:Object(F.e)(n.x,t.min.x,B.a.epsilon)?r.x=1:Object(F.e)(n.y,t.max.y,B.a.epsilon)?r.y=-1:Object(F.e)(n.y,t.min.y,B.a.epsilon)?r.y=1:Object(F.e)(n.z,t.max.z,B.a.epsilon)?r.z=-1:r.z=1,t.containsPoint(e.origin)||r.multiplyScalar(-1),{point:n,normal:r}},Q=(r=new C.a,function(t,e,n,i){return r.copy(t).sub(e),r.clampLength(n,i),e.clone().add(r)}),V=function(){var t=new C.a;return function(e,n,r,i){t.copy(n).sub(e);var o=Math.atan2(Math.sqrt(Math.pow(t.x,2)+Math.pow(t.z,2)),t.y),a=Math.min(Math.max(r,o),i);return Math.abs(o-a)>Number.EPSILON?W(e,n,o-a,!1):e}}(),W=function(){var t=new C.a,e=new C.a;return function(n,r,i,o){return t.copy(r).sub(n),o?e.copy(z.a.UP):e.copy(t).applyAxisAngle(z.a.UP,-1*Math.PI/2).setY(0).normalize(),t.applyAxisAngle(e,i),r.clone().sub(t)}}(),X=(i=new C.a,o=new C.a,function(t,e,n){return i.copy(t).sub(e).normalize(),o.copy(t).sub(n).normalize(),(new k.a).setFromUnitVectors(i,o)}),q=(a=new N.a,function(t,e){return a.setPosition(t),a.lookAt(t,e,z.a.UP),(new k.a).setFromRotationMatrix(a.asThreeMatrix4())}),Y=(s=new C.a,function(t,e,n){return s.copy(z.a.FORWARD).applyQuaternion(t).normalize(),s.clone().multiplyScalar(-1*n).add(e)}),Z=(u=new L.a,c=new C.a,l=new C.a,function(t,e,n){return l.set(0,0,0),c.copy(z.a.FORWARD).applyQuaternion(e),u.set(t,c),u.intersectPlane(n,l)}),K=(p=new C.a,h=new C.a,f=new C.a,d=new C.a,y=[new C.a,new C.a,new C.a,new C.a,new C.a,new C.a,new C.a,new C.a],v=new C.a,g=new C.a,w=new C.a,m=new C.a,b=new U.a,T=new C.a,_=new L.a,S=new C.a,D=new C.a,function(t,e,n,r,i,o){p.copy(z.a.FORWARD).applyQuaternion(e).setY(0),h.copy(p).setY(-Math.PI/6).normalize(),d.copy(h).applyAxisAngle(z.a.UP,-Math.PI/2).setY(0).normalize(),f.copy(d).cross(h).normalize();for(var a=0,s=r.max,u=r.min,c=[s,u],l=0;l<2;l++)for(var P=c[l].x,x=0;x<2;x++)for(var E=c[x].y,R=0;R<2;R++){var O=c[R].z;y[a].set(P,E,O),a++}v.copy(u),w.copy(t).setY(u.y);var M=g.copy(v).sub(w).dot(h);y.forEach(function(t){if(t.y!==s.y){var e=g.copy(t).sub(w).dot(h);e<M&&(v.copy(t),M=e)}});var A=Math.sign(v.dot(d));m.copy(v).setX(v.x===s.x?u.x:s.x),Math.sign(m.dot(d))!==A?b.set(T.set(0,0,-1*Math.sign(v.z)),Math.abs(v.z)):(m.copy(v).setZ(v.z===s.z?u.z:s.z),b.set(T.set(-1*Math.sign(v.x),0,0),Math.abs(v.x))),_.set(t,S.copy(h).multiplyScalar(-1)),_.intersectPlane(b,D);var C=Math.min(Math.abs(D&&D.dot(h)),M),I=0,k=0;y.forEach(function(e){g.copy(e).sub(t);var n=Math.abs(g.dot(d)),r=Math.abs(g.dot(f));n>I&&(I=n),r>k&&(k=r)});var U=I/Math.tan(i*o/2),L=k/Math.tan(i/2),j=Math.max(U,L)+Math.abs(C),N={};return N.position=t.clone().add(h.clone().multiplyScalar(1.1*-j)),N.rotation=q(N.position,t),N}),J=(P=new j.a,function(){var t=new j.a,e=new I.a;return function(n,r,i,o,a){return a=a||new A.a,t.makeRotationFromQuaternion(i).setPosition(r),t.getInverse(t),t.premultiply(o.asThreeMatrix4()),e.x=n.x,e.y=n.y,e.z=n.z,e.w=1,e.applyMatrix4(t),e.x/=e.w,e.y/=e.w,e.z/=e.w,e.w=1,a.x=e.x,a.y=e.y,a}}()),$=(x=new C.a,function(t,e){var n=t.angleTo(e);return Math.sign(x.crossVectors(t,e).dot(z.a.UP))*n}),tt=(E=new N.a,R=new C.a,function(t,e,n,r){return r=r||new N.a,t.parent?t.parent.getWorldPosition(R):t.getWorldPosition(R),r.lookAt(e,R,n),t.parent&&r.premultiply(E.getInverse(t.parent.matrixWorld)),r.extractRotation(r),r}),et=function(t){return!!t&&1===t.elements[15]},nt=function(t,e,n,r){if(void 0===r&&(r=1.5),et(t)){var i=it(t);return r*window.innerHeight/(2*i)}var o=e.distanceTo(n),a=2*Math.atan(1/t.elements[5]),s=r/(2*Math.tan(a/2)*o);return window.innerHeight*s},rt=(O=new C.a,M=new j.a,function(t,e,n){var r=O.set(0,0,-t).applyMatrix4(e).z;return O.set(2/n,0,r).applyMatrix4(M.getInverse(e)),O.x}),it=function(t){return 1/t.elements[5]}},323:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r,i=n(311),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.state=n,r}return o(e,t),e}(i.a)},324:function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r,i=n(42),o=n(146),a=n(93),s=n(21),u=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},l=function(t){function e(e){var n=t.call(this)||this;return n.floors=e,n.floorNames=new i.a,n.currentFloor=-1,n.getHighestVisibleFloor=function(){return n.currentFloor>-1?n.currentFloor:n.totalFloors-1},n.getViewData=function(t){var e=n.floors.getFloor(t),r=n.derivedData[t];return e&&!r&&n.makeViewData&&(n.derivedData[t]=n.makeViewData(e)),n.derivedData[t]},n.raycastGroups=function(t){var e,r,i=[],o=-1===n.currentFloor,a=n.floors.getCollection();try{for(var s=c(a),u=s.next();!u.done;u=s.next()){var l=u.value,p=l.floorIndex===n.currentFloor;(t||o||p)&&i.push(l.colliderGroupName)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return i},n.viewdataChangeHandlers=[],n.derivedData={},n.currentFloor=-1,n.transition={from:-1,to:-1,progress:new o.a(0),promise:Promise.resolve()},n}return u(e,t),Object.defineProperty(e.prototype,"totalFloors",{get:function(){return this.floors.getFloorCount()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highestVisibleFloor",{get:function(){return this.getHighestVisibleFloor},enumerable:!0,configurable:!0}),e.prototype.update=function(t){this.floors=t.floors,this.viewdataChangeHandlers=t.viewdataChangeHandlers,this.derivedData=t.derivedData,this.currentFloor=t.currentFloor,this.transition=t.transition,this.floorNames=t.floorNames,this.makeViewData=t.makeViewData,this.getFloorMax=t.getFloorMax,this.getFloorMin=t.getFloorMin,this.moveToFloor=t.moveToFloor},e.prototype.setViewDataFactory=function(t){this.makeViewData=t},e.prototype.getFloorNames=function(){var t=[];for(var e in this.derivedData)t.push(this.derivedData[e].name);return t},e.prototype.initialize=function(){},e.prototype.dispose=function(){},e.prototype.notifyOnChanged=function(){var t,e;try{for(var n=c(this.viewdataChangeHandlers),r=n.next();!r.done;r=n.next()){(0,r.value)()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.onViewDataChanged=function(t,e){var n=this;void 0===e&&(e=!1);var r={renew:function(){n.viewdataChangeHandlers.push(t)},cancel:function(){Object(a.a)(n.viewdataChangeHandlers,t)}};return e&&r.renew(),r},e.prototype.getFloorsVisibility=function(){if(-1===this.currentFloor)return[];for(var t=[],e=0;e<this.totalFloors;e++)t[e]=e===this.currentFloor?1:0;return t},e}(s.a)},327:function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"c",function(){return o}),n.d(e,"b",function(){return a});var r=n(144),i={fov:75,near:.1,far:1500},o=function(t){return(new r.a).makePerspectiveFov(i.fov,t,i.near,i.far)},a=function(t,e,n){void 0===n&&(n=1);var o=t/2,a=e/2,s=(new r.a).makeOrthographic(-o,o,a,-a,i.near,i.far);return s.elements[0]*=n,s.elements[5]*=n,s}},328:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r,i=n(310),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.position=e,r.delta=n,r}return o(e,t),e}(i.a)},331:function(t,e,n){"use strict";var r;n.d(e,"a",function(){return r}),function(t){t[t.visibleFloor=1]="visibleFloor",t[t.ghostFloor=3]="ghostFloor",t[t.boundingSkybox=1]="boundingSkybox",t[t.panoMarker=2]="panoMarker",t[t.reticule=3]="reticule",t[t.grid=5]="grid",t[t.pins=6]="pins",t[t.portals=9]="portals",t[t.rotators=10]="rotators",t[t.ribbon=100]="ribbon",t[t.colorOverlay=1e3]="colorOverlay"}(r||(r={}))},333:function(t,e,n){"use strict";var r;n.d(e,"a",function(){return r}),function(t){t[t.ESCAPE=27]="ESCAPE",t[t.ZERO=48]="ZERO",t[t.ONE=49]="ONE",t[t.TWO=50]="TWO",t[t.THREE=51]="THREE",t[t.FOUR=52]="FOUR",t[t.FIVE=53]="FIVE",t[t.SIX=54]="SIX",t[t.SEVEN=55]="SEVEN",t[t.EIGHT=56]="EIGHT",t[t.NINE=57]="NINE",t[t.LEFTARROW=37]="LEFTARROW",t[t.UPARROW=38]="UPARROW",t[t.RIGHTARROW=39]="RIGHTARROW",t[t.DOWNARROW=40]="DOWNARROW",t[t.TAB=9]="TAB",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.SPACE=32]="SPACE",t[t.RETURN=13]="RETURN",t[t.SEMICOLON=186]="SEMICOLON",t[t.PLUSEQUALS=187]="PLUSEQUALS",t[t.DASHUNDERSCORE=189]="DASHUNDERSCORE",t[t.OPENBRACKET=219]="OPENBRACKET",t[t.SHIFT=16]="SHIFT",t[t.ALT=18]="ALT"}(r||(r={}))},336:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r,i=n(21),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;r.x=0,r.y=0,r.width=e||0,r.height=n||0;var i=r.width/r.height;return r.aspectRatio=isFinite(i)?i:1,r}return o(e,t),e.prototype.update=function(t){this.width=t.width,this.height=t.height,this.aspectRatio=t.width/t.height,this.x=t.x,this.y=t.y},e}(i.a)},346:function(t,e,n){"use strict";n.d(e,"h",function(){return a}),n.d(e,"e",function(){return s}),n.d(e,"d",function(){return u}),n.d(e,"a",function(){return c}),n.d(e,"c",function(){return l}),n.d(e,"j",function(){return p}),n.d(e,"b",function(){return h}),n.d(e,"g",function(){return f}),n.d(e,"i",function(){return d}),n.d(e,"f",function(){return y});var r=n(22),i=n(1),o=.25,a=function(t){return function(e){return e!==t}},s=function(t){return function(e){return-1!==t.neighbours.indexOf(e.id)}},u=function(t){return function(e){return t===e||s(t)(e)}},c=function(t,e,n){void 0===n&&(n=o);var r=new i.a;return function(i){return r.copy(i.position).sub(t).normalize().dot(e)>n}},l=function(){return function(t){return t.enabled}},p=function(t){return t.placementType===r.b.MANUAL},h=function(){return function(t){return t.alignmentType===r.a.ALIGNED}},f=function(){return function(t){return t.alignmentType!==r.a.ALIGNED}},d=function(t){return function(e){return t.floor===e.floor}},y=function(t,e){var n=new i.a;return e=e.clone(),function(r){return n.copy(r.position).sub(t).normalize().dot(e)>0}}},347:function(t,e,n){"use strict";var r,i=n(382),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a);e.a=a},348:function(t,e,n){"use strict";var r,i=n(34),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.fromSweep=n,r.toSweep=e,r.timestamp=Date.now(),r}return o(e,t),e}(i.a);e.a=a},350:function(t,e,n){"use strict";var r,i;n.d(e,"a",function(){return r}),n.d(e,"b",function(){return i}),n.d(e,"c",function(){return o}),n.d(e,"d",function(){return a}),function(t){t[t.PRIMARY=0]="PRIMARY",t[t.MIDDLE=1]="MIDDLE",t[t.SECONDARY=2]="SECONDARY",t[t.BACK=3]="BACK",t[t.FORWARD=4]="FORWARD",t[t.COUNT=5]="COUNT"}(r||(r={})),function(t){t[t.NONE=0]="NONE",t[t.PRIMARY=1]="PRIMARY",t[t.SECONDARY=4]="SECONDARY",t[t.MIDDLE=2]="MIDDLE",t[t.BACK=8]="BACK",t[t.FORWARD=16]="FORWARD",t[t.ALL=31]="ALL"}(i||(i={}));var o=function(t){var e=i[r[t]];return"number"==typeof e?e:void 0},a=function(t){var e=r[i[t]];return"number"==typeof e?e:void 0}},353:function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r,i=n(21),o=n(156),a=n(114),s=n(47),u=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tags=Object(a.a)(),e}return u(e,t),e.prototype.update=function(t){this.copy(t)},e.prototype.clear=function(){var t,e;try{for(var n=c(this.tags),r=n.next();!r.done;r=n.next()){var i=r.value;this.removeTag(i.sid)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(t){return e.copyTagCollection(this,t),this},e.copyTagCollection=function(t,e){var n,r,i,o,a=t.tags,s=e.tags;try{for(var u=c(a.keys),l=u.next();!l.done;l=u.next()){var p=l.value;s.has(p)||t.removeTag(p)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}try{for(var h=c(s),f=h.next();!f.done;f=h.next()){var d=f.value;t.addTag(d)}}catch(t){i={error:t}}finally{try{f&&!f.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}},e.copyTag=function(t,e){var n,r;t.anchorNormal.copy(e.anchorNormal),t.anchorPosition.copy(e.anchorPosition),t.color.copy(e.color),t.created.setTime(e.created.getTime()),t.description=e.description.slice(),t.enabled=e.enabled,t.floorIndex=e.floorIndex,t.isActive=e.isActive,t.label=e.label.slice(),t.mediaSrc=e.mediaSrc.slice(),t.mediaType=e.mediaType.slice(),t.modified.setTime(e.modified.getTime()),t.sid=e.sid.slice(),t.stemVector.copy(e.stemVector),t.stemVisible=e.stemVisible,t.parsedDescription=[];try{for(var i=c(e.parsedDescription),o=i.next();!o.done;o=i.next()){var a=o.value;t.parsedDescription.push({link:a.link&&{label:a.link.label.slice(),url:a.link.url.slice(),type:a.link.type,navigationData:a.link.navigationData&&{floorVisibility:a.link.navigationData.floorVisibility,mode:a.link.navigationData.mode,panoId:a.link.navigationData.panoId&&a.link.navigationData.panoId.slice(),position:a.link.navigationData.position.clone(),quaternion:a.link.navigationData.quaternion.clone(),zoom:a.link.navigationData.zoom}},text:a.text&&a.text.slice(),type:a.type})}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return t},e.cloneTag=function(t){var n=e.copyTag(new o.a,t);return n.anchorNormal=Object(s.a)(n.anchorNormal),n.anchorPosition=Object(s.a)(n.anchorPosition),n.color=Object(s.a)(n.color),n.stemVector=Object(s.a)(n.stemVector),Object(s.a)(n)},Object.defineProperty(e.prototype,"collection",{get:function(){return this.tags},enumerable:!0,configurable:!0}),e.prototype.addTag=function(t){this.tags.has(t.sid)?e.copyTag(this.tags.get(t.sid),t):this.tags.set(t.sid,e.cloneTag(t))},e.prototype.removeTag=function(t){return this.tags.delete(t)},e.prototype.getTag=function(t){return this.tags.get(t)},e.prototype.getTagList=function(){return this.tags.keys},e.prototype.getTagCount=function(){return this.tags.length},e.prototype.iterate=function(t){var e,n;try{for(var r=c(this.tags),i=r.next();!i.done;i=r.next()){t(i.value)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},e}(i.a)},354:function(t,e,n){"use strict";var r;n.d(e,"a",function(){return r}),function(t){t[t.DOWN=0]="DOWN",t[t.PRESSED=1]="PRESSED",t[t.UP=2]="UP"}(r||(r={}))},359:function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"c",function(){return o}),n.d(e,"b",function(){return a});var r=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},i=function(){function t(t,e,n){this.watchedData=t,this.registerSubscription=e,this.unregisterSubscription=n}return t.prototype.createSubscription=function(t,e){var n=this;return new s(function(){return n.registerSubscription(t)},function(){return n.unregisterSubscription(t)},e)},t.prototype.getData=function(){return this.watchedData()},t}(),o=function(){function t(t,e,n){this.watchedData=t,this.registerSubscription=e,this.unregisterSubscription=n}return t.prototype.createSubscription=function(t,e){var n=this,r=function(){return t(n.watchedData())};return new s(function(){return n.registerSubscription(r)},function(){return n.unregisterSubscription(r)},e)},t.prototype.getData=function(){return this.watchedData()},t}(),a=function(){function t(t,e,n,r){this.collection=t,this.itemProperty=e,this.subscribeFcn=n,this.unsubcribeFcn=r}return t.prototype.createSubscription=function(t,e){var n=this,i=[],o=new s(function(){var e,o,a=function(e){var r=function(){return t(e,n.itemProperty)};i.push(r),n.subscribeFcn(e,r)};try{for(var s=r(n.collection),u=s.next();!u.done;u=s.next())a(u.value)}catch(t){e={error:t}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(e)throw e.error}}},function(){var t,e,o=0;try{for(var a=r(n.collection),s=a.next();!s.done;s=a.next()){var u=s.value;n.unsubcribeFcn(u,i[o]),o++}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}},e);return this.collection.hasOwnProperty("isObservable")?(this.collection.onElementChanged({onAdded:function(e){i.push(function(){return t(e,n.itemProperty)}),o.active&&n.subscribeFcn(e,i[i.length-1])},onRemoved:function(t){var e,o,a=0;try{for(var s=r(n.collection),u=s.next();!u.done;u=s.next()){if(u.value===t)break;a++}}catch(t){e={error:t}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(e)throw e.error}}n.unsubcribeFcn(t,i[a]),i.splice(a,1)}}),o):o},t.prototype.getData=function(){return this.collection},t}(),s=function(){function t(t,e,n){void 0===n&&(n=!1),this.startSubscription=t,this.endSubscription=e,this.isSubbed=!1,n&&this.renew()}return t.prototype.renew=function(){this.isSubbed||(this.startSubscription(),this.isSubbed=!0)},t.prototype.cancel=function(){this.isSubbed&&(this.endSubscription(),this.isSubbed=!1)},Object.defineProperty(t.prototype,"active",{get:function(){return this.isSubbed},enumerable:!0,configurable:!0}),t}()},360:function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return i}),n.d(e,"d",function(){return l}),n.d(e,"c",function(){return f});var r,i,o=n(359);!function(t){t[t.RESIZE=1]="RESIZE",t[t.ORIENTATION_CHANGED=2]="ORIENTATION_CHANGED"}(r||(r={})),function(t){t[t.PORTRAIT=1]="PORTRAIT",t[t.LANDSCAPE=2]="LANDSCAPE"}(i||(i={}));var a=[],s=[],u={w:window.innerWidth,h:window.innerHeight},c=new o.c(function(){return u},function(t){return a.push(t)},function(t){a=a.filter(function(e){return e!==t})}),l=function(){return window.innerWidth>window.innerHeight?i.LANDSCAPE:i.PORTRAIT},p=l(),h=new o.c(function(){return p},function(t){return s.push(t)},function(t){s=s.filter(function(e){return e!==t})});function f(t,e){switch(t){case r.RESIZE:return c.createSubscription(e);case r.ORIENTATION_CHANGED:return h.createSubscription(e)}}var d,y,v=function(){var t=function(){window.clearInterval(d),window.clearTimeout(y)};t();var e=function(){u.w===window.innerWidth&&u.h===window.innerHeight||(u.w=window.innerWidth,u.h=window.innerHeight,function(){if(a.length>0&&a.forEach(function(t){return t(u)}),s.length>0){var t=l();t!==p&&(p=t,s.forEach(function(e){return e(t)}))}}())};d=window.setInterval(e,100),y=window.setTimeout(t,1e3),e()};window.addEventListener("resize",v)},365:function(t,e,n){"use strict";n.d(e,"c",function(){return a}),n.d(e,"d",function(){return s}),n.d(e,"f",function(){return u}),n.d(e,"a",function(){return c}),n.d(e,"e",function(){return l}),n.d(e,"b",function(){return p});var r,i=n(34),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a),s=function(t){function e(e){var n=t.call(this)||this;return n.index=e,n}return o(e,t),e}(i.a),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a)},366:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r,i=n(390),o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};!function(t){t[t.SELECTED=1]="SELECTED",t[t.HIDE=2]="HIDE",t[t.SHOW=3]="SHOW"}(r||(r={}));var a=o({},i.a,r)},369:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r,i=n(21),o=n(1),a=n(72),s=n(146),u=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t){function e(e,n,r){var i=t.call(this)||this;return i.opacity=new s.a(e),i.bounds=n,i.center=r,i}return u(e,t),e.prototype.update=function(t){this.opacity.copy(t.opacity),this.bounds=new a.a(t.bounds.min,t.bounds.max),this.center=(new o.a).copy(t.center)},e}(i.a)},370:function(t,e){t.exports="precision highp float;\nprecision highp int;\n\nuniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n"},371:function(t,e){t.exports="precision highp float;\nprecision highp int;\n\nuniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"},373:function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"b",function(){return l});var r,i,o=n(21),a=n(42),s=n(60),u=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),c=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};!function(t){t[t.DISABLED=0]="DISABLED",t[t.ENABLED=1]="ENABLED",t[t.PLACING=2]="PLACING",t[t.OPENING=3]="OPENING",t[t.OPEN=4]="OPEN"}(i||(i={}));var l=function(t){function e(e){var n=t.call(this)||this;return n.tags=e,n.openBillboards=new a.a,n.visitedTags=new a.a,n.persistentBillboards={},n.observables={selectedTag:Object(s.b)(null),uncommittedEdit:Object(s.b)(null),editingTag:Object(s.b)(null),navigatingTag:Object(s.b)(null)},n.addStateObservable=Object(s.b)(i.ENABLED),n.navigationPitch=0,n.viewedTags=0,n}return u(e,t),e.prototype.update=function(t){this.openBillboards=t.openBillboards,this.visitedTags=t.visitedTags,this.persistentBillboards=t.persistentBillboards,this.observables.selectedTag=t.observables.selectedTag,this.observables.editingTag=t.observables.editingTag,this.observables.navigatingTag=t.observables.navigatingTag,this.navigationPitch=t.navigationPitch,this.viewedTags=t.viewedTags,this.tags=t.tags},e.prototype.togglePersistentBillboards=function(t,e){var n,r;try{for(var i=c(t),o=i.next();!o.done;o=i.next()){var a=o.value;this.tags.has(a)&&(this.persistentBillboards[a]=e)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.addBillboards=function(t){var e=this;t.length&&(t=t.filter(function(t){return e.tags.has(t)&&-1===e.openBillboards.indexOf(t)}),this.openBillboards.concat(t),t.forEach(function(t){e.tags.get(t).isActive=!0}))},e.prototype.removeBillboards=function(t,e){var n=this,r=this.openBillboards.values().filter(function(r){return!e&&n.persistentBillboards[r]||n.tags.has(r)&&-1===t.indexOf(r)});t.forEach(function(t){n.tags.has(t)&&n.tags.get(t).isActive&&(!e&&n.persistentBillboards[t]||(n.tags.get(t).isActive=!1))}),this.openBillboards.replace(r)},e.prototype.removeAllBillboards=function(){this.removeBillboards(this.openBillboards.values())},e.prototype.resetBillboardData=function(){this.removeAllBillboards(),this.selectTag(null),this.setEditing(null)},e.prototype.getTagCount=function(){return this.tags.length},e.prototype.removeAllBillboardsExcept=function(t){var e=this.tags.keys.filter(function(e){return e!==t});this.removeBillboards(e)},e.prototype.selectTag=function(t){this.observables.selectedTag.value!==t&&(this.observables.selectedTag.value=t)},Object.defineProperty(e.prototype,"selected",{get:function(){return this.observables.selectedTag.value},enumerable:!0,configurable:!0}),e.prototype.onSelectedChanged=function(t,e){return void 0===e&&(e=!1),this.makePropertySubscription("selectedTag",t,e)},e.prototype.setEditing=function(t){this.observables.editingTag.value!==t&&(this.observables.editingTag.value=t)},Object.defineProperty(e.prototype,"editing",{get:function(){return this.observables.editingTag.value},enumerable:!0,configurable:!0}),e.prototype.onEditingTagChanged=function(t,e){return void 0===e&&(e=!1),this.makePropertySubscription("editingTag",t,e)},e.prototype.setNavigatingTag=function(t){this.observables.navigatingTag.value!==t&&(this.observables.navigatingTag.value=t)},Object.defineProperty(e.prototype,"navigating",{get:function(){return this.observables.navigatingTag.value},enumerable:!0,configurable:!0}),e.prototype.onNavigatingChanged=function(t,e){return void 0===e&&(e=!1),this.makePropertySubscription("navigatingTag",t,e)},e.prototype.setUncommittedTag=function(t){this.observables.uncommittedEdit.value=t},Object.defineProperty(e.prototype,"uncommittedTag",{get:function(){return this.observables.uncommittedEdit.value},enumerable:!0,configurable:!0}),e.prototype.onUncommittedChanged=function(t,e){return void 0===e&&(e=!1),this.makePropertySubscription("uncommittedEdit",t,e)},e.prototype.makePropertySubscription=function(t,e,n){var r=this.observables[t].onChanged(e);return n&&r.renew(),r},e.prototype.setAddState=function(t){this.addStateObservable.value=t},Object.defineProperty(e.prototype,"addState",{get:function(){return this.addStateObservable.value},enumerable:!0,configurable:!0}),e.prototype.onAddStateChanged=function(t,e){void 0===e&&(e=!1);var n=this.addStateObservable.onChanged(t);return e&&n.renew(),n},e.prototype.isAddingTag=function(){var t=this.addStateObservable.value;return t===i.PLACING||t===i.OPENING||t===i.OPEN},e.prototype.visitTag=function(t){this.viewedTags++,-1===this.visitedTags.indexOf(t)&&this.visitedTags.push(t)},e.prototype.getViewedTagCount=function(){return this.viewedTags},e.prototype.getVisitedTags=function(){return this.visitedTags.values()},e.prototype.getBillboards=function(){return this.openBillboards.values()},e.prototype.setNavigationPitch=function(t){this.navigationPitch=t},e.prototype.iterate=function(t){var e,n;try{for(var r=c(this.tags),i=r.next();!i.done;i=r.next()){t(i.value)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},e}(o.a)},374:function(t,e,n){"use strict";var r=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},i=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},o=function(t){return""+t},a=function(){function t(t){void 0===t&&(t=o),this.mappingFunction=t,this.list=[],this.map={}}return t.prototype.add=function(t){var e=this.mappingFunction(t);return!this.map[e]&&(this.list.push(t),this.map[e]=t,!0)},t.prototype.set=function(t){var e=this.mappingFunction(t);return this.map[e]?(this.map[e]=t,!0):(this.add(t),!0)},t.prototype.count=function(){return this.list.length},t.prototype[Symbol.iterator]=function(){var t,e,n,o,a;return r(this,function(r){switch(r.label){case 0:r.trys.push([0,5,6,7]),n=i(this.list),o=n.next(),r.label=1;case 1:return o.done?[3,4]:[4,o.value];case 2:r.sent(),r.label=3;case 3:return o=n.next(),[3,1];case 4:return[3,7];case 5:return a=r.sent(),t={error:a},[3,7];case 6:try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}return[7];case 7:return[2]}})},t.prototype.getByIndex=function(t){return this.list[t]},t.prototype.get=function(t){return this.map[t]},t.prototype.copyToList=function(t){t.push.apply(t,this.list)},t.prototype.clear=function(){this.list=[],this.map={}},t.prototype.mapElements=function(t){return this.list.map(t)},t}();e.a=a},381:function(t,e,n){"use strict";n.d(e,"c",function(){return a}),n.d(e,"d",function(){return s}),n.d(e,"a",function(){return u}),n.d(e,"b",function(){return c}),n.d(e,"e",function(){return l});var r,i=n(34),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.sid=e,r.hovering=n,r}return o(e,t),e}(i.a),s=function(t){function e(e){var n=t.call(this)||this;return n.sid=e,n}return o(e,t),e}(i.a),u=function(t){function e(e){var n=t.call(this)||this;return n.sid=e,n}return o(e,t),e}(i.a),c=function(t){function e(e){var n=t.call(this)||this;return n.extUrl=e,n}return o(e,t),e}(i.a),l=function(t){function e(e,n){var r=t.call(this)||this;return r.sid=e,r.view=n,r}return o(e,t),e}(i.a)},382:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r,i=n(34),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.fromMode=n,r.toMode=e,r.timestamp=Date.now(),r}return o(e,t),e}(i.a)},383:function(t,e,n){"use strict";var r,i=n(382),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a);e.a=a},384:function(t,e,n){"use strict";var r,i=n(348),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a);e.a=a},385:function(t,e,n){"use strict";var r,i,o=n(395),a=n(1),s=n(11),u=n(358),c=function(){function t(t,e){void 0===e&&(e=null),this.eyeTranslationL=new a.a,this.eyeTranslationR=new a.a,this.frameData=null,this.defaultLeftBounds=[0,0,.5,1],this.defaultRightBounds=[.5,0,.5,1],this.renderer=t,this.onError=e,null!==window.VRFrameData&&void 0!==window.VRFrameData&&(this.frameData=new window.VRFrameData),navigator.getVRDisplays&&(this.gotVRDisplays=this.gotVRDisplays.bind(this),navigator.getVRDisplays().then(this.gotVRDisplays).catch(function(){console.warn("VREffect: Unable to get VR Displays")})),this.scope=this,this.rendererSize=t.getSize(),this.rendererUpdateStyle=!1,this.rendererPixelRatio=t.getPixelRatio(),this.onVRDisplayPresentChange=this.onVRDisplayPresentChange.bind(this),window.addEventListener("vrdisplaypresentchange",this.onVRDisplayPresentChange,!1),this.cameraL=new u.a,this.cameraL.layers.mask=-1,this.cameraR=new u.a,this.cameraR.layers.mask=-1}return t.prototype.gotVRDisplays=function(t){this.vrDisplays=t,t.length>0?this.vrDisplay=t[0]:this.onError&&this.onError("HMD not available")},t.prototype.getVRDisplay=function(){return this.vrDisplay},t.prototype.setVRDisplay=function(t){this.vrDisplay=t},t.prototype.getVRDisplays=function(){return console.warn("THREE.VREffect: getVRDisplays() is being deprecated."),this.vrDisplays},t.prototype.setSize=function(t,e,n){if(this.rendererSize={width:t,height:e},this.rendererUpdateStyle=n,this.scope.isPresenting){var r=this.vrDisplay.getEyeParameters("left");this.renderer.setPixelRatio(1),this.renderer.setSize(2*r.renderWidth,r.renderHeight,!1)}else this.renderer.setPixelRatio(this.rendererPixelRatio),this.renderer.setSize(t,e,n)},t.prototype.onVRDisplayPresentChange=function(){var t=this.scope.isPresenting;if(this.scope.isPresenting=void 0!==this.vrDisplay&&this.vrDisplay.isPresenting,this.scope.isPresenting){var e=this.vrDisplay.getEyeParameters("left"),n=e.renderWidth,r=e.renderHeight;t||(this.rendererPixelRatio=this.renderer.getPixelRatio(),this.rendererSize=this.renderer.getSize(),this.renderer.setPixelRatio(1),this.renderer.setSize(2*n,r,!1))}else t&&(this.renderer.setPixelRatio(this.rendererPixelRatio),this.renderer.setSize(this.rendererSize.width,this.rendererSize.height,this.rendererUpdateStyle))},t.prototype.setFullScreen=function(t){return new Promise(function(e,n){void 0!==this.vrDisplay?this.scope.isPresenting!==t?e(t?this.vrDisplay.requestPresent([{source:this.canvas}]):this.vrDisplay.exitPresent()):e():n(new Error("No VR hardware found."))})},t.prototype.requestPresent=function(){return this.setFullScreen(!0)},t.prototype.exitPresent=function(){return this.setFullScreen(!1)},t.prototype.requestAnimationFrame=function(t){return void 0!==this.vrDisplay?this.vrDisplay.requestAnimationFrame(t):window.requestAnimationFrame(t)},t.prototype.cancelAnimationFrame=function(t){void 0!==this.vrDisplay?this.vrDisplay.cancelAnimationFrame(t):window.cancelAnimationFrame(t)},t.prototype.submitFrame=function(){void 0!==this.vrDisplay&&this.scope.isPresenting&&this.vrDisplay.submitFrame()},t.prototype.render=function(t,e,n,r){if(this.vrDisplay&&this.scope.isPresenting){var i=t.autoUpdate;i&&(t.updateMatrixWorld(r),t.autoUpdate=!1),Array.isArray(t)&&(console.warn("VREffect.render() no longer supports arrays. Use object.layers instead."),t=t[0]);var o=this.renderer.getSize(),a=this.vrDisplay.getLayers(),s=this.defaultLeftBounds,u=this.defaultRightBounds;if(a.length){var c=a[0];null!==c&&(c.leftBounds&&4===c.leftBounds.length&&(s=c.leftBounds),c.rightBounds&&4===c.rightBounds.length&&(u=c.rightBounds))}else s=this.defaultLeftBounds,u=this.defaultRightBounds;return this.renderRectL={x:Math.round(o.width*s[0]),y:Math.round(o.height*s[1]),width:Math.round(o.width*s[2]),height:Math.round(o.height*s[3])},this.renderRectR={x:Math.round(o.width*u[0]),y:Math.round(o.height*u[1]),width:Math.round(o.width*u[2]),height:Math.round(o.height*u[3])},n?(this.renderer.setRenderTarget(n),n.scissorTest=!0):(this.renderer.setRenderTarget(null),this.renderer.setScissorTest(!0)),(this.renderer.autoClear||r)&&this.renderer.clear(),null===e.parent&&e.updateMatrixWorld(r),e.matrixWorld.decompose(this.cameraL.position,this.cameraL.quaternion,this.cameraL.scale),this.cameraR.position.copy(this.cameraL.position),this.cameraR.quaternion.copy(this.cameraL.quaternion),this.cameraR.scale.copy(this.cameraL.scale),this.cameraL.translateOnAxis(this.eyeTranslationL,this.cameraL.scale.x),this.cameraR.translateOnAxis(this.eyeTranslationR,this.cameraR.scale.x),this.vrDisplay.getFrameData&&(this.vrDisplay.depthNear=e.near,this.vrDisplay.depthFar=e.far,this.vrDisplay.getFrameData(this.frameData),this.cameraL.projectionMatrix.elements=this.frameData.leftProjectionMatrix,this.cameraR.projectionMatrix.elements=this.frameData.rightProjectionMatrix),n?(n.viewport.set(this.renderRectL.x,this.renderRectL.y,this.renderRectL.width,this.renderRectL.height),n.scissor.set(this.renderRectL.x,this.renderRectL.y,this.renderRectL.width,this.renderRectL.height)):(this.renderer.setViewport(this.renderRectL.x,this.renderRectL.y,this.renderRectL.width,this.renderRectL.height),this.renderer.setScissor(this.renderRectL.x,this.renderRectL.y,this.renderRectL.width,this.renderRectL.height)),this.renderer.render(t,this.cameraL,n,r),n?(n.viewport.set(this.renderRectR.x,this.renderRectR.y,this.renderRectR.width,this.renderRectR.height),n.scissor.set(this.renderRectR.x,this.renderRectR.y,this.renderRectR.width,this.renderRectR.height)):(this.renderer.setViewport(this.renderRectR.x,this.renderRectR.y,this.renderRectR.width,this.renderRectR.height),this.renderer.setScissor(this.renderRectR.x,this.renderRectR.y,this.renderRectR.width,this.renderRectR.height)),this.renderer.render(t,this.cameraR,n,r),n?(n.viewport.set(0,0,o.width,o.height),n.scissor.set(0,0,o.width,o.height),n.scissorTest=!1,this.renderer.setRenderTarget(null)):(this.renderer.setViewport(0,0,o.width,o.height),this.renderer.setScissorTest(!1)),i&&(t.autoUpdate=!0),void this.scope.submitFrame()}this.renderer.render(t,e,n,r)},t.prototype.dispose=function(){window.removeEventListener("vrdisplaypresentchange",this.onVRDisplayPresentChange,!1)},t.prototype.fovToNDCScaleOffset=function(t){var e=2/(t.leftTan+t.rightTan),n=(t.leftTan-t.rightTan)*e*.5,r=2/(t.upTan+t.downTan);return{scale:[e,r],offset:[n,(t.upTan-t.downTan)*r*.5]}},t.prototype.fovPortToProjection=function(t,e,n,r){n=void 0===n?.01:n,r=void 0===r?1e4:r;var i=(e=void 0===e||e)?-1:1,o=new s.a,a=o.elements,u=this.fovToNDCScaleOffset(t);return a[0]=u.scale[0],a[1]=0,a[2]=u.offset[0]*i,a[3]=0,a[4]=0,a[5]=u.scale[1],a[6]=-u.offset[1]*i,a[7]=0,a[8]=0,a[9]=0,a[10]=r/(n-r)*-i,a[11]=r*n/(n-r),a[12]=0,a[13]=0,a[14]=i,a[15]=0,o.transpose(),o},t.prototype.fovToProjection=function(t,e,n,r){var i=Math.PI/180,o={upTan:Math.tan(t.upDegrees*i),downTan:Math.tan(t.downDegrees*i),leftTan:Math.tan(t.leftDegrees*i),rightTan:Math.tan(t.rightDegrees*i)};return this.fovPortToProjection(o,e,n,r)},t}(),l=n(321),p=n(327),h=n(151),f=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t){function e(e){var n=t.call(this)||this;return n.camera=new u.a(p.a.fov,e,p.a.near,p.a.far),n.add(n.camera),n.camera.layers.mask=h.a.ALL.mask,n}return f(e,t),e.prototype.dispose=function(){this.remove(this.camera)},e}(l.a);n.d(e,"a",function(){return i}),function(t){t[t.Root=0]="Root",t[t.CameraRig=1]="CameraRig"}(i||(i={}));var y=function(){function t(t,e,n){this.cwfRenderer=t,this.cameraData=e,this.canvas=n,this.rendererHeight=0,this.rendererWidth=0,this.rendering=!1,this.cameraRigStale=!0}return t.prototype.addChild=function(t,e){switch(t){case i.Root:this.scene.add(e);break;case i.CameraRig:this.cameraRig.add(e);break;default:return!1}return!0},t.prototype.removeChild=function(t,e){switch(t){case i.Root:this.scene.remove(e);break;case i.CameraRig:this.cameraRig.remove(e);break;default:return!1}return!0},Object.defineProperty(t.prototype,"camera",{get:function(){return this.updateCameraRig(),this.cameraRig.camera},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.scene=new o.a,this.cameraRig=new d(this.canvas.aspectRatio),this.effect=new c(this.cwfRenderer.renderer),this.effect.setSize(this.canvas.width,this.canvas.height,!1)},t.prototype.dispose=function(){this.effect.dispose(),this.cameraRig.dispose()},t.prototype.startRender=function(t){this.rendering=t},t.prototype.activate=function(t){var e=this;this.scene.add(this.cameraRig),this.cameraDataCallback=function(){return e.cameraRigStale=!0},this.cameraData.pose.onChanged(this.cameraDataCallback)},t.prototype.deactivate=function(t){this.scene.remove(this.cameraRig),this.cameraData.pose.removeOnChanged(this.cameraDataCallback)},t.prototype.beforeRender=function(){this.updateCameraRig()},t.prototype.updateCameraRig=function(){this.cameraRigStale&&(this.cameraRig.position.copy(this.cameraData.pose.position),this.cameraRig.camera.quaternion.copy(this.cameraData.pose.rotation),this.cameraRig.camera.projectionMatrix.copy(this.cameraData.pose.projection.asThreeMatrix4()),this.cameraRig.updateMatrixWorld(!0),this.cameraRigStale=!1)},t.prototype.render=function(){this.rendering&&this.effect.render(this.scene,this.cameraRig.camera,void 0,!1)},t.prototype.setSize=function(t,e){this.cameraRigStale=!0,this.cameraRig.camera.updateProjectionMatrix(),this.effect.setSize(t,e,!1),this.rendererWidth=t,this.rendererHeight=e},t}();e.b=y},390:function(t,e,n){"use strict";var r;n.d(e,"a",function(){return r}),function(t){t[t.NONE=0]="NONE"}(r||(r={}))},391:function(t,e,n){"use strict";n.d(e,"b",function(){return y}),n.d(e,"a",function(){return v});var r,i=n(21),o=n(146),a=n(47),s=n(16),u=n(346),c=n(93),l=n(60),p=n(366),h=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),f=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},d=function(){return function(){this.visible=!0,this.selected=Object(a.a)(new o.a(0))}}(),y=function(t){function e(e,n){var r=t.call(this)||this;return r.sweepId=e,r.visible=n,r.payload={sweepId:e,visible:n},r}return h(e,t),e}(s.a),v=function(t){function e(e,n){var r,i,o=t.call(this)||this;if(o.data=e,o.sweepIdList=[],o.sweepMap={},o.makeViewData=void 0,o.sweepInteractionMap={},o.states={},o.derivedData={},o.viewdataChangeHandlers=[],o.selectedSweep=new l.a(null),o.hoveredSweep=new l.a(null),n)try{for(var s=f(n),u=s.next();!u.done;u=s.next()){var c=u.value,p=Object(a.a)(new d);o.states[c.id]=p}}catch(t){r={error:t}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return o}return h(e,t),e.prototype.getSweep=function(t){return this.data.getSweep(t)},e.prototype.setViewDataFactory=function(t){this.makeViewData=t},e.prototype.getViewData=function(t){var e=this.data.getSweep(t),n=this.derivedData[t];return e&&!n&&this.makeViewData&&(this.derivedData[t]=this.makeViewData(e,e.index)),this.derivedData[t]},e.prototype.iterate=function(t){this.data.iterate(t)},e.prototype.getState=function(t){return this.states[t]},e.prototype.isVisible=function(t){return t in this.states&&this.states[t].visible},e.prototype.getSelected=function(t){return t in this.states?this.states[t].selected:null},e.prototype.updateAnimations=function(t){for(var e in this.states){var n=this.states[e];n.selected&&n.selected.active&&n.selected.tick(t)}},e.prototype.onViewDataChanged=function(t,e){var n=this;void 0===e&&(e=!1);var r={renew:function(){n.viewdataChangeHandlers.push(t)},cancel:function(){Object(c.a)(n.viewdataChangeHandlers,t)}};return e&&r.renew(),r},e.prototype.notifyOnChanged=function(){var t,e;try{for(var n=f(this.viewdataChangeHandlers),r=n.next();!r.done;r=n.next()){(0,r.value)()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},e.prototype.setSweepInteraction=function(t,e){this.sweepInteractionMap[t].interaction=e,this.notifyOnChanged()},e.prototype.getIndexByAlignment=function(t,e){return this.getAlignedSweeps(t).findIndex(function(t){return t.id===e})},e.prototype.getAlignedSweeps=function(t){var e=this,n=this.sweepIdList.map(function(t){return e.getViewData(t)});return t?n.filter(Object(u.b)()):n.filter(Object(u.g)())},e.prototype.unselectAllSweeps=function(){var t,e;try{for(var n=f(this.sweepIdList),r=n.next();!r.done;r=n.next()){var i=r.value;this.sweepInteractionMap[i].interaction=p.a.NONE}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.notifyOnChanged()},e.prototype.update=function(t){this.data=t.data,this.derivedData=t.derivedData,this.sweepInteractionMap=t.sweepInteractionMap,this.states=t.states,this.selectedSweep=t.selectedSweep,this.sweepIdList=t.sweepIdList,this.sweepMap=t.sweepMap,this.hoveredSweep=t.hoveredSweep,this.viewdataChangeHandlers=t.viewdataChangeHandlers},e}(i.a)},396:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r,i=n(34),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.floorIndex=e,r.floorName=n,r}return o(e,t),e}(i.a)},402:function(t,e,n){"use strict";n.d(e,"b",function(){return a}),n.d(e,"a",function(){return s});var r,i=n(21),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hit=null,e}return o(e,t),e.prototype.update=function(t){this.hit=t.hit},e}(i.a),s=function(){return function(t,e,n){this.point=t,this.object=n,this.face={normal:e}}}()},403:function(t,e,n){"use strict";var r,i,o=n(389),a=n(325),s=n(3),u=n(26),c=n(14),l=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},p=new s.a("api"),h=((r={})[u.d.BASE]="low",r[u.d.STANDARD]="high",r[u.d.HIGH]="2k",r[u.d.ULTRAHIGH]="4k",r),f=((i={})[u.d.BASE]=256,i[u.d.STANDARD]=1024,i[u.d.HIGH]=2048,i[u.d.ULTRAHIGH]=4096,i),d=function(){function t(t){this.urls=t,this.sweepCubeTextures={}}return t.prototype.useTexture=function(t){var e=this.getTexture(t);if(!e)throw Error("Texture for sweep "+t+" not loaded before using");return e},t.prototype.loadFace=function(t,e,n,r){return this.loadFaceImage(t,e,n,r).then(function(t){var e=new a.a(t);return e.needsUpdate=!0,e})},t.prototype.load=function(t,e){var n=this;void 0===e&&(e=u.d.STANDARD);var r=this.sweepCubeTextures[t];if(r)return p.debug("Skipping load of pano, already loaded"),new Promise(function(t,e){t(r)});var i=[2,4,0,5,1,3].map(function(r){return n.loadFaceImage(t,e,r)}),a=Promise.all(i).then(function(e){var r=new o.a(e);return r.flipY=!1,r.needsUpdate=!0,n.sweepCubeTextures[t]=r,r});return a.catch(function(){p.error("Downloading cubemap for pano",t,"failed")}),a},t.prototype.unload=function(t){var e=this.sweepCubeTextures[t];if(!e)throw Error("Texture for sweep "+t+" not loaded before unloading");e.dispose(),this.sweepCubeTextures[t]=null},t.prototype.unloadAll=function(t){var e,n,r=Object(c.b)(t);try{for(var i=l(Object.keys(this.sweepCubeTextures)),o=i.next();!o.done;o=i.next()){var a=o.value;this.sweepCubeTextures[a]&&!r[a]&&this.unload(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.loadFaceImage=function(t,e,n,r){var i=h[e],o=f[e],a="pan/"+i+"/"+t+"_skybox"+n+".jpg";return this.urls.getImageBitmap(a,o,o,r)},t.prototype.getTexture=function(t){return this.sweepCubeTextures[t]},t}();e.a=d},404:function(t,e,n){"use strict";n.d(e,"d",function(){return a}),n.d(e,"c",function(){return s}),n.d(e,"b",function(){return u}),n.d(e,"a",function(){return c});var r,i=n(16),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n,r){void 0===r&&(r=500);var i=t.call(this)||this;return i.id="SELECT_SWEEP",i.payload={id:e,selected:n,duration:r},i}return o(e,t),e}(i.a),s=function(t){function e(e,n,r){void 0===r&&(r=500);var i=t.call(this)||this;return i.id="HOVER_SWEEP",i.payload={id:e,hovered:n,duration:r},i}return o(e,t),e}(i.a),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id="ENABLE_SWEEP_SELECTION",e}return o(e,t),e}(i.a),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id="DISABLE_SWEEP_SELECTION",e}return o(e,t),e}(i.a)},405:function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return o}),n.d(e,"c",function(){return a});var r=n(22),i=function(t,e){if(!t||!e)return!1;var n=e&&t.getSweep(e);return!!n&&n.alignmentType===r.a.ALIGNED},o=function(t){return i(t,t.currentSweep)},a=function(t,e){switch(t){case r.a.ALIGNED:return 1;case r.a.UNALIGNED:return 2}switch(e){case r.b.MANUAL:return 3}return 0}},410:function(t,e,n){"use strict";n.d(e,"d",function(){return s}),n.d(e,"c",function(){return u}),n.d(e,"b",function(){return c}),n.d(e,"a",function(){return l});var r=n(1),i=-1,o=10,a=5,s=function(t,e){return void 0===e&&(e=i),function(n){return t.distanceToSquared(n.position)*e}},u=function(t,e){return void 0===e&&(e=i),function(n){return t.distanceTo(n.position)*e}},c=function(t,e,n){void 0===n&&(n=o);var i=new r.a;return function(r){return i.copy(r.position).sub(t).normalize().dot(e)*n}},l=function(t,e){return void 0===e&&(e=a),function(e){return t===e.floor?a:0}}},412:function(t,e,n){"use strict";var r,i=n(348),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n,r,i){var o=t.call(this,e,i)||this;return o.alignmentType=n,o.placementType=r,o}return o(e,t),e}(i.a);e.a=a},418:function(t,e,n){"use strict";n.d(e,"b",function(){return m}),n.d(e,"a",function(){return b}),n.d(e,"g",function(){return T}),n.d(e,"c",function(){return _}),n.d(e,"f",function(){return S}),n.d(e,"e",function(){return D}),n.d(e,"d",function(){return P}),n.d(e,"i",function(){return x}),n.d(e,"h",function(){return R});var r,i,o,a,s,u,c,l,p,h=n(462),f=n(1),d=n(11),y=n(10),v=n(533),g=n(481),w=n(7),m=512,b=6,T=function(t,e,n,r,i,o,a,s){var u=t/e,c=2*(e/t),l=c/2,p=2*(r/u)-1+l,f=2*((i=u-1-i)/u)-1+l;switch(o=o||v.a.Center){case v.a.UpperLeft:p-=l,f+=l,p+=a*c;break;case v.a.UpperRight:p+=l,f+=l,f-=a*c;break;case v.a.LowerRight:p+=l,f-=l,p-=a*c;break;case v.a.LowerLeft:p-=l,f-=l,f+=a*c;break;case v.a.Center:}switch(n){case h.a.GL_TEXTURE_CUBE_MAP_POSITIVE_X:s.set(-1,f,-p);break;case h.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_X:s.set(1,f,p);break;case h.a.GL_TEXTURE_CUBE_MAP_POSITIVE_Y:s.set(-p,1,-f);break;case h.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y:s.set(-p,-1,f);break;case h.a.GL_TEXTURE_CUBE_MAP_POSITIVE_Z:s.set(-p,f,1);break;case h.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z:s.set(p,f,-1)}s.normalize()},_=function(t,e){var n=m;t<m&&(n=t);var r=Math.floor(t/n),i=r*r;return Math.floor(e/i)},S=function(t,e,n){var r=m;t<m&&(r=t);var i=_(t,e),o=Math.floor(t/r),a=e-i*(o*o);n.tileX=a%o,n.tileY=Math.floor(a/o),n.face=i,n.faceTileIndex=a},D=function(t){if(t<=m)return b;var e=Math.floor(t/m);return e*e*b},P=(r=new d.a,i=new y.a,function(t,e){i.copy(t),i.inverse(),r.makeRotationFromQuaternion(i),e.applyMatrix4(r),e.normalize()}),x=(a=new f.a,s=new f.a(0,0,-1),u=new y.a,c=function(t,e){t.push({face:e.face,faceTileIndex:e.faceTileIndex,tileX:e.tileX,tileY:e.tileY})},o={face:-1,faceTileIndex:-1,tileX:-1,tileY:-1},l=function(t,e,n){for(var r=D(t),i=0,a=0;a<r;a++)S(t,a,o),e&&!e(o)||(i++,n&&c(n,o));return i},function(t,e,n,r,i,o,c){void 0===i&&(i=!1),r.length=i?0:r.length;var p=e<m?e:m;if(!o&&!c)return l(e,null,r);var h=!!c;o=o||0,c=c||o,c=Math.max(0,Math.min(c,360)),o=Math.max(0,Math.min(o,360)),a.copy(n);var f=t.rotation||new y.a;return P(f,a),h?(u.setFromUnitVectors(a,s),l(e,function(t){return E(e,p,t.face,t.tileX,t.tileY,u,o||0,c||0)},r)):l(e,function(t){return R(e,p,t.face,t.tileX,t.tileY,a,o||0)},r)}),E=(p=new f.a,function(t,e,n,r,i,o,a,s){for(var u=Math.tan(.5*s*w.b),c=-u,l=Math.tan(.5*a*w.b),h=-l,f=Object(g.a)(n),d=0,y=0,m=0,b=0,_=0,S=v.a.Center;S<=v.a.LowerLeft;S++)if(T(t,e,f,r,i,S,0,p),p.applyQuaternion(o),!(p.z>=-1e-5)){var D=-1/p.z,P=p.x*D,x=p.y*D;x>u?d++:x<c&&y++,P>l?m++:P<h&&b++,_++}return y!==_&&d!==_&&m!==_&&b!==_}),R=function(){var t=new f.a,e=new f.a(0,1,0),n=new f.a(1,0,0);return function(r,i,o,a,s,u,c){var l=Object(g.a)(o);if(n.copy(u).cross(e),T(r,i,l,a,s,v.a.Center,0,t),O(t,u,c))return!0;for(var p=c/360,h=Math.floor(1/p),f=0,d=0;d<h;d++){for(var y=v.a.UpperLeft;y<=v.a.LowerLeft;y++)if(T(r,i,l,a,s,y,f,t),O(t,u,c))return!0;f+=p}return!1}}(),O=function(){var t=new f.a,e=new f.a;return function(n,r,i,o){if(e.copy(n),o){t.copy(o),t.normalize();var a=t.dot(n);t.x*=a,t.y*=a,t.z*=a,e.sub(t)}var s=i/2*w.b,u=Math.cos(s);return e.dot(r)>=u}}()},419:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r,i=n(21),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;for(var r in n.snapshots={},e)n.snapshots[r]=e[r].clone();return n}return o(e,t),e.prototype.get=function(t){return this.snapshots[t]},Object.defineProperty(e.prototype,"collection",{get:function(){return this.snapshots},enumerable:!0,configurable:!0}),e.prototype.add=function(t){this.snapshots[t.sid]=t},e.prototype.clone=function(){return new e(this.snapshots)},e.prototype.update=function(t){this.snapshots=t.snapshots},e}(i.a)},441:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n(332),i=n(330),o=n(72),a=n(51),s=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};function u(t){var e,n;if(0===t.length)throw Error("Can't merge empty list of geometries");if(1===t.length)return t[0];var u=0,l=0,p=0,h=0,f=new o.a;try{for(var d=s(t),y=d.next();!y.done;y=d.next()){var v=y.value;u+=v.index.count,l+=v.getAttribute("position").count,v.getAttribute("uv")&&(p+=v.getAttribute("uv").count),v.boundingBox&&(f.union(v.boundingBox),h++)}}catch(t){e={error:t}}finally{try{y&&!y.done&&(n=d.return)&&n.call(d)}finally{if(e)throw e.error}}var g=new r.a;h!==t.length||f.isEmpty()?g.computeBoundingBox():g.boundingBox=f,g.boundingSphere=g.boundingBox.getBoundingSphere(new a.a);var w=c(new Float32Array(3*l),"position",t);g.addAttribute("position",new i.a(w,3));var m=function(t,e){var n,r,i=0,o=0;try{for(var a=s(e),u=a.next();!u.done;u=a.next()){for(var c=u.value,l=c.index,p=0;p<l.array.length;p++)t[i+p]=l.array[p]+o;i+=l.array.length,o+=c.getAttribute("position").count}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return t}(new Uint32Array(u),t);if(g.setIndex(new i.a(m,1)),p){var b=c(new Float32Array(2*p),"uv",t);g.addAttribute("uv",new i.a(b,2))}return g}function c(t,e,n){var r,i,o=0;try{for(var a=s(n),u=a.next();!u.done;u=a.next()){var c=u.value.getAttribute(e);t.set(c.array,o),o+=c.array.length}}catch(t){r={error:t}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return t}},443:function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"c",function(){return i}),n.d(e,"d",function(){return o}),n.d(e,"b",function(){return a});var r=.01,i=.01,o=.1,a=300},461:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=function(){function t(t){this._value=t}return t.prototype.value=function(){return this._value},t.prototype.set=function(t){this._value=t},t}(),i=function(){function t(){this.storage={}}return t.prototype.get=function(t,e){var n=this.storage[t];return n||(n=e(),this.storage[t]=n),n},t.prototype.getNumber=function(t){return this.get(t,function(){return new r(0)})},t.prototype.getString=function(t){return this.get(t,function(){return new r("")})},t.prototype.getArray=function(t){return this.get(t,function(){return[]})},t.prototype.getNumberMap=function(t){return this.get(t,function(){return{}})},t.prototype.getStringMap=function(t){return this.get(t,function(){return{}})},t}()},462:function(t,e,n){"use strict";var r;!function(t){t[t.GL_TEXTURE_CUBE_MAP_POSITIVE_X=0]="GL_TEXTURE_CUBE_MAP_POSITIVE_X",t[t.GL_TEXTURE_CUBE_MAP_NEGATIVE_X=1]="GL_TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.GL_TEXTURE_CUBE_MAP_POSITIVE_Y=2]="GL_TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y=3]="GL_TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.GL_TEXTURE_CUBE_MAP_POSITIVE_Z=4]="GL_TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z=5]="GL_TEXTURE_CUBE_MAP_NEGATIVE_Z"}(r||(r={})),e.a=r},479:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},i=function(){var t,e;if(!navigator.getGamepads)return null;var n=navigator.getGamepads();try{for(var i=r(n),o=i.next();!o.done;o=i.next()){var a=o.value;if(a&&a.pose)return a}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return null}},480:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r,i=n(26),o=n(118),a=n(461),s=n(418),u=n(19),c=new(n(3).a)("panoqualitymanager");!function(t){t[t.Untested=0]="Untested",t[t.Testing=1]="Testing",t[t.Success=2]="Success",t[t.Fail=3]="Fail"}(r||(r={}));var l=function(){function t(t,e,n,r){this.urls=t,this.maxCubemapSize=e,this.maxNavPanoSize=n,this.maxZoomPanoSize=r,this.overrideWindow=!1,this.devicePixelRatio=window.devicePixelRatio||1,this.navPanoSize=-1,this.zoomPanoSize=-1,this.windowHeight=window.innerHeight*this.devicePixelRatio,this.highQualityThreshold=o.c.windowHeightHighQualityThresholdOverride||o.c.windowHeightHighQualityThreshold,this.persistentStorage=new a.a,this.downloadTestResults={},this.updateMaximums()}return t.prototype.setWindowSize=function(t,e){this.windowHeight=e*this.devicePixelRatio,this.updateMaximums()},t.prototype.overrideWindowMaximums=function(t){this.overrideWindow=t,this.updateMaximums()},t.prototype.getTestResults=function(t,e){var n=this.downloadTestResults[t];if(n){var i=n[e];if(i)return i}return r.Untested},t.prototype.ultraHighQualityModeEnabled=function(t){var e=i.b[this.getZoomPanoSize()],n=this.downloadTestResults[t];return!(!n||!n[e])&&n[e]===r.Success},t.prototype.updateMaximums=function(){this.windowHeight<this.highQualityThreshold&&!this.overrideWindow?(this.navPanoSize=Math.min(t.getPanoSize(i.d.STANDARD),this.maxNavPanoSize),this.zoomPanoSize=Math.min(t.getPanoSize(i.d.HIGH),this.maxZoomPanoSize)):(this.navPanoSize=this.maxNavPanoSize,this.zoomPanoSize=this.maxZoomPanoSize),this.zoomPanoSize<this.navPanoSize&&(this.navPanoSize=this.zoomPanoSize),this.zoomPanoSize=Math.min(this.maxCubemapSize,this.zoomPanoSize),this.navPanoSize=Math.min(this.maxCubemapSize,this.navPanoSize)},t.getPanoSize=function(t){if(t in i.a)return i.a[t];throw new Error("Not a panoSizeClass: "+t)},t.getPanoSizeClass=function(t){if(t in i.b)return i.b[t];throw new Error("Not a valid pano resolution: "+t)},t.prototype.getMaxPossiblePanoSize=function(){return t.getPanoSize(i.d.ULTRAHIGH)},t.prototype.getNavPanoSize=function(){return this.navPanoSize},t.prototype.getZoomPanoSize=function(){return this.zoomPanoSize},t.prototype.availableResolution=function(t,e){var n=this,i=new u.a;switch(e<1&&i.reject(0),this.getTestResults(t,e)){case r.Success:i.resolve(e);break;case r.Fail:return this.availableResolution(t,e-1);case r.Untested:this.testDownload(t,e,s.b).then(function(r){r?i.resolve(e):n.availableResolution(t,e-1).then(function(t){return i.resolve(t)})});break;case r.Testing:c.warn("resolution is already testing, do we need to handle this?")}return i},t.prototype.testDownload=function(e,n,i){var o=this;if(!this.urls)throw new Error("Can't call testDownload without signed urls");var a=t.getPanoSize(n),s=new u.a;this.downloadTestResults[e]||(this.downloadTestResults[e]={});var c=this.downloadTestResults[e]&&this.downloadTestResults[e][n];if(c)c===r.Success?s.resolve(!0):c===r.Fail&&s.resolve(!1);else{this.downloadTestResults[e][n]=r.Testing;var l=this.getTileUrl(e,a,i,0);this.urls.getImage(l,{maxRetries:0}).then(function(t){o.downloadTestResults[e][n]=r.Success,s.resolve(!0)},function(){o.downloadTestResults[e][n]=r.Fail,s.resolve(!1)})}return s},t.prototype.getTileUrl=function(t,e,n,r){var i=this.persistentStorage.get("getTileUrl:sizeMap",function(){return{256:"256",512:"512",1024:"1k",2048:"2k",4096:"4k"}}),o=this.persistentStorage.get("getTileUrl:sizeMap",function(){return{face:-1,faceTileIndex:-1,tileX:-1,tileY:-1}});s.f(e,r,o);var a=Math.floor(e/n),u=a*a,c=Math.floor(r/u);return"tiles/"+t+"/"+i[e]+"_face"+c+"_"+o.tileX+"_"+o.tileY+".jpg"},t}();e.b=l},481:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(462),i=n(160),o={0:r.a.GL_TEXTURE_CUBE_MAP_POSITIVE_Y,1:r.a.GL_TEXTURE_CUBE_MAP_POSITIVE_Z,2:r.a.GL_TEXTURE_CUBE_MAP_POSITIVE_X,3:r.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z,4:r.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_X,5:r.a.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y},a=function(t){if(t<0||t>5)throw new i.a("mapFaceToCubemapFace() -> face must be in the range [0, 5]");return o[t]}},482:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},i=function(){function t(t){this.comparer=t||this.defaultComparer,this.poolArray=[]}return t.prototype.add=function(t){var e=this.createObjectDescriptor(t);return e.object=t,e.inUse=!0,this.addObjectDescriptorToPool(e),e},t.prototype.get=function(t){var e,n;try{for(var i=r(this.poolArray),o=i.next();!o.done;o=i.next()){var a=o.value;if(!a.inUse&&this.comparer(a,t))return a.inUse=!0,a}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return null},t.prototype.free=function(t){var e,n;try{for(var i=r(this.poolArray),o=i.next();!o.done;o=i.next()){var a=o.value;if(a.object===t)return a.inUse=!1,!0}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return!1},t.prototype.all=function(){return this.poolArray},t.prototype.remove=function(t){var e=this.poolArray.findIndex(function(e){return e.object===t});return-1!==e&&(this.poolArray.splice(e,1),!0)},t.prototype.defaultComparer=function(t,e){return!0},t.prototype.createObjectDescriptor=function(t){return{object:t,inUse:!1}},t.prototype.addObjectDescriptorToPool=function(t){this.poolArray.push(t)},t}()},483:function(t,e){t.exports="varying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},484:function(t,e,n){"use strict";var r=n(8);e.a=Object.freeze({camera:{transitionBlackoutTime:300,transitionFadeTime:800,baseTransitionTime:r.q("btt",200),minRotationTransitionTime:r.q("mttr",1250),transitionSpeed:r.q("tsp",3)}})},485:function(t,e,n){"use strict";var r,i=n(34),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.from=n,r.to=e,r.timestamp=Date.now(),r}return o(e,t),e}(i.a);e.a=a},486:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},i=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},o=function(){function t(t){this.size=t,this.index=0,this.buffer=[]}return t.prototype.push=function(t){this.index>=this.size&&(this.index=0),this.buffer[this.index]=t,this.index++},t.prototype.peek=function(){return this.buffer[this.index<=this.buffer.length?this.index-1:0]||null},t.prototype.getList=function(){return this.buffer},t.prototype[Symbol.iterator]=function(){return r(this,function(t){switch(t.label){case 0:return[5,i(this.buffer)];case 1:return t.sent(),[2]}})},t.prototype.clear=function(){this.buffer=[],this.index=0},t}()},487:function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return u});var r,i=n(353),o=n(373),a=n(381),s=n(40);!function(t){t.OVERLAY="overlay",t.HOVER="hover",t.OPEN="open"}(r||(r={}));var u=function(){return function(){this.handlers=[{msgType:a.d,func:function(t,e,n){var r=n.tryGetData(i.a),a=n.tryGetData(o.b);if(r&&a){var u=r.getTagCount(),c=a.getVisitedTags().length,l=a.getViewedTagCount(),p=r.getTag(e.sid);p&&t.track("tag_opened",{tag_count:u,tag_id:e.sid,tags_visited:c,tag_view_count:l,has_media:p.mediaType!==s.a.none})}}},{msgType:a.e,func:function(t,e,n){var r=n.tryGetData(i.a),a=n.tryGetData(o.b);if(r&&a){var s=r.getTagCount(),u=a.getVisitedTags().length,c=a.getViewedTagCount(),l=r.getTag(e.sid);if(l){var p={mattertag_sid:e.sid,mattertag_view:e.view,mattertag_media:l.mediaType,mattertags_count:s,mattertags_total_views:c,mattertags_visited:u};t.track("mattertag_view",p)}}}}]}}()},488:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return s});var r,i=n(34),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.mode=e,r.fromMode=n,r}return o(e,t),e}(i.a),s=function(t){function e(e){var n=t.call(this)||this;return n.source=e,n}return o(e,t),e}(i.a)},489:function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"b",function(){return i});var r=function(t){return void 0!==t.pointerId},i=function(t){return void 0!==t.changedTouches}},490:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r,i=n(16),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.name="blur-canvas",r.payload={duration:e,pixelBlur:n},r}return o(e,t),e}(i.a)},529:function(t,e,n){"use strict";n.d(e,"b",function(){return a}),n.d(e,"a",function(){return s});var r,i=n(34),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.hit=null,n.hit=e,n}return o(e,t),e}(i.a),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a)},530:function(t,e,n){"use strict";var r,i=n(34),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return t.call(this)||this}return o(e,t),e}(i.a);e.a=a},531:function(t,e,n){"use strict";var r,i=n(34),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.sweepIds=e,n}return o(e,t),e}(i.a);e.a=a},532:function(t,e,n){"use strict";var r,i=n(34),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n,r){var i=t.call(this)||this;return i.size=e,i.sweepId=n,i.renderTarget=r,i}return o(e,t),e}(i.a);e.a=a},533:function(t,e,n){"use strict";var r;!function(t){t[t.Center=0]="Center",t[t.UpperLeft=1]="UpperLeft",t[t.UpperRight=2]="UpperRight",t[t.LowerRight=3]="LowerRight",t[t.LowerLeft=4]="LowerLeft"}(r||(r={})),e.a=r},535:function(t,e,n){"use strict";n.d(e,"c",function(){return r}),n.d(e,"b",function(){return i}),n.d(e,"a",function(){return o});var r=function(){return{height:window.innerHeight,width:window.innerWidth}},i=function(){return{width:window.screen.width,height:window.screen.height,density:window.devicePixelRatio}},o=function(){var t=(new(n(676))).getResult();return{browser:{name:t.browser.name,major:t.browser.major,version:t.browser.version},os:{name:t.os.name,version:t.os.version},device:{vendor:t.device.vendor,model:t.device.model,type:t.device.type}}}},536:function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return u});var r,i,o=n(16),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(){return(s=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};!function(t){t.left="left",t.top="top",t.width="width",t.height="height"}(i||(i={}));var u=function(t){function e(e){var n=t.call(this)||this;return n.name="resize-canvas",n.payload=s({},e),n}return a(e,t),e}(o.a)},537:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r,i=n(34),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.x=e,r.y=n,r}return o(e,t),e}(i.a)},538:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r,i=n(34),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n){var r=t.call(this)||this;return r.width=e,r.height=n,r}return o(e,t),e}(i.a)},616:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r,i=n(322),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(i.a)},617:function(t,e,n){"use strict";var r;n.d(e,"a",function(){return r}),function(t){t.FPS="stat.fps"}(r||(r={}))},618:function(t,e,n){"use strict";(function(t){n.d(e,"a",function(){return T}),n.d(e,"b",function(){return P});var r=n(347),i=n(14),o=n(486),a=n(25),s=n(5),u=n(4),c=n(3),l=n(145),p=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},h=new c.a(t),f=1e4,d=6e4,y=0,v=1/0,g=null,w=null,m={},b=new o.a(1e3),T=function(){return function(){this.handlers=[{msgType:r.a,func:function(t,e,n){w!==s.a.STARTING&&w!==s.a.PLAYING||_(t,u.a[e.toMode],f)}},{msgType:a.a,func:function(t,e,n){var r=n.tryGetData(l.a);e.phase===s.a.LOADING?_(t,"Loading",d):(e.phase===s.a.STARTING||e.phase===s.a.PLAYING)&&r&&r.currentMode&&_(t,u.a[r.currentMode],f),w=e.phase}}]}}();function _(t,e,n){e!==g&&(g&&(D(t),S()),m[e]||(v=n,m[g=e]=!0))}var S=function(){g=null,b.clear(),y=0},D=function(t){var e=b.getList();if(0!==e.length)try{var n=x(e);t.track("performance",n)}catch(t){h.warn("Could not send performance metrics",t)}},P=function(t,e){g&&(b.push(e),(y+=e)>=v&&(D(t),S()))},x=function(t){var e,n,r=0,o=0,a=0,s=0,u=0,c=0;try{for(var l=p(t),h=l.next();!h.done;h=l.next()){var f=h.value;r+=f,f<0||(f<=16.7?o+=f:f<=33.3?a+=f:f<=100?s+=f:f<=1e3?u+=f:c+=f)}}catch(t){e={error:t}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}if(r<=0)throw Error("No positive timings, cannot calculate performance data");var d=r/t.length;o/=r,a/=r,s/=r,u/=r,c/=r;var y=t.slice(),v=Object(i.k)(y,50),w=Object(i.k)(y,95,!1),m=y[y.length-1];return{phase:g,frame_delta:d,frame_delta_avg:d,frame_delta_median:v,frame_delta_95th:w,frame_delta_max:m,duration:r,time_60_fps:o,time_60_30_fps:a,time_30_10_fps:s,time_10_1_fps:u,time_1_0_fps:c}}}).call(this,"/index.js")},619:function(t,e,n){"use strict";var r,i=n(34),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.zoomLevel=e,n}return o(e,t),e}(i.a);e.a=a},620:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n(405),i=n(33),o=n(152),a=n(384),s=n(412),u=function(){function t(){var t=this;this.startLoadTime=Date.now(),this.endLoadTime=Date.now(),this.panosViewed=0,this.navSource="self-guided",this.interactSource=i.a.None,this.handlers=[{msgType:a.a,func:function(e,n,r){t.onMoveToSweepBegin(n.timestamp)}},{msgType:s.a,func:function(e,n,i){var a=i.tryGetData(o.a);t.endLoadTime=Date.now();var s=t.endLoadTime-t.startLoadTime;t.interactSource=a?a.source:t.interactSource,e.track("pano_viewed",{pano_id:n.toSweep,pano_view_count:++t.panosViewed,alignment_type:Object(r.c)(n.alignmentType,n.placementType),interaction_source:t.interactSource,navigation_source:t.navSource,load_time:s/1e3})}}]}return t.prototype.onMoveToSweepBegin=function(t){this.startLoadTime=t},t}()},621:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(488),i=n(152),o=function(){return function(){this.handlers=[{msgType:r.a,func:function(t,e,n){var r=n.tryGetData(i.a);r&&t.track("interaction_mode_changed",{interaction_mode_prev:e.fromMode,interaction_mode:e.mode,interaction_source:r.source})}}]}}()},623:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r,i=n(34),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e){var n=t.call(this)||this;return n.is360=e,n}return o(e,t),e}(i.a)},624:function(t,e,n){"use strict";var r,i=n(34),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.urls=e,o.sid=n,o.vrSupported=r,o.sweepList=i,o}return o(e,t),e}(i.a);e.a=a},625:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r,i=n(16),o=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},s=function(t){function e(e){var n=t.call(this)||this;return n.name="screen-to-canvas-point",n.payload=a({},e),n}return o(e,t),e}(i.a)},672:function(t,e,n){t.exports=n.p+"images/outlineEnhanced512.png"},673:function(t,e,n){t.exports=n.p+"images/outlineBasic512.png"},674:function(t,e,n){"use strict";var r=n(22),i=n(374),o=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},a=function(){function t(t,e){var n,a;this.textureUsageCounter={},this.model=t,this.sweepList=e;var s=new i.a(function(t){return t.id});try{for(var u=o(this.sweepList),c=u.next();!c.done;c=u.next()){var l=c.value;l.isObservableProxy&&(l=(new r.c).copy(l)),s.add(l)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}this.sweepListMap=s}return t.prototype.init=function(){},t.prototype.dispose=function(){},t.prototype.activate=function(t){},t.prototype.deactivate=function(t){},t.prototype.beforeRender=function(){},t.prototype.render=function(){},t.prototype.activateSweep=function(t){return this.initTextureUsage(t),Promise.resolve(null)},t.prototype.useTexture=function(t){return this.incrementTextureUsage(t),null},t.prototype.freeTexture=function(t,e){void 0===e&&(e=!1),e?this.setTextureUsage(t,0):this.decrementTextureUsage(t)},t.prototype.initTextureUsage=function(t){this.textureUsageCounter[t]||(this.textureUsageCounter[t]=0)},t.prototype.setTextureUsage=function(t,e){this.textureUsageCounter[t]=e},t.prototype.incrementTextureUsage=function(t){this.textureUsageCounter[t]++},t.prototype.decrementTextureUsage=function(t){this.textureUsageCounter[t]--},t}();e.a=a},909:function(t,e){t.exports="// Sweep transitions\nuniform float progress;\n\n// gradient colorings\nuniform vec3 topColor;\nuniform vec3 bottomColor;\nuniform float gradientOpacity;\nuniform float radius;\nvarying vec4 worldPosition;\n\n// projected panos\nuniform vec3 pano0Position;\nuniform vec3 pano1Position;\nuniform samplerCube pano0Map;\nuniform samplerCube pano1Map;\nvarying vec3 vWorldPosition0;\nvarying vec3 vWorldPosition1;\n\n// Mixed in Linear color spaces based off of https://www.shadertoy.com/view/lscGDr\n#define SRGB_TO_LINEAR(c) pow((c), vec3(2.2))\n#define LINEAR_TO_SRGB(c) pow((c), vec3(1.0 / 2.2))\n#define USE_DITHER\n\n// Gradient noise from Jorge Jimenez's presentation:\n// http://www.iryoku.com/next-generation-post-processing-in-call-of-duty-advanced-warfare\nfloat gradientNoise(in vec2 uv) {\n  const vec3 magic = vec3(0.06711056, 0.00583715, 52.9829189);\n  return fract(magic.z * fract(dot(uv, magic.xy)));\n}\n\nvoid main() {\n  vec3 colorFromPano0 = textureCube(pano0Map, vWorldPosition0.xyz).rgb;\n  vec3 colorFromPano1 = textureCube(pano1Map, vWorldPosition1.xyz).rgb;\n\n  float normalizedHeight = (worldPosition.y + radius) / (radius * 2.0);\n  float ratio = smoothstep(0.0, 0.5, normalizedHeight);\n\n  vec3 colorFromGradient = mix(SRGB_TO_LINEAR(bottomColor), SRGB_TO_LINEAR(topColor), ratio);\n\n  vec3 colorFromPanos = mix(colorFromPano0, colorFromPano1, progress);\n  vec3 color = mix(colorFromPanos, LINEAR_TO_SRGB(colorFromGradient), gradientOpacity);\n\n  #if defined (USE_DITHER)\n    color += (1.0/255.0) * gradientNoise(gl_FragCoord.xy) - (0.5/255.0);\n  #endif\n\n  gl_FragColor = vec4(color, 1.0);\n}\n"},910:function(t,e){t.exports="uniform vec3 pano0Position;\nuniform mat4 pano0Matrix;\n\nuniform vec3 pano1Position;\nuniform mat4 pano1Matrix;\n\nvarying vec3 vWorldPosition0;\nvarying vec3 vWorldPosition1;\nvarying vec4 worldPosition;\n\nvoid main() {\n  worldPosition = modelMatrix * vec4(position, 1.0);\n  vec3 positionLocalToPanoCenter0 = worldPosition.xyz - pano0Position;\n  vWorldPosition0 = (vec4(positionLocalToPanoCenter0, 1.0) * pano0Matrix).xyz;\n  vWorldPosition0.x *= -1.0;\n\n  vec3 positionLocalToPanoCenter1 = worldPosition.xyz - pano1Position;\n  vWorldPosition1 = (vec4(positionLocalToPanoCenter1, 1.0) * pano1Matrix).xyz;\n  vWorldPosition1.x *= -1.0;\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\n}\n"},911:function(t,e,n){t.exports=n.p+"images/outlineEnhanced4096.png"},912:function(t,e,n){t.exports=n.p+"images/outlineEnhanced2048.png"},913:function(t,e,n){t.exports=n.p+"images/outlineEnhanced1024.png"},914:function(t,e,n){t.exports=n.p+"images/outlineBasic4096.png"},915:function(t,e,n){t.exports=n.p+"images/outlineBasic2048.png"},916:function(t,e,n){t.exports=n.p+"images/outlineBasic1024.png"},917:function(t,e){t.exports="uniform vec3 color;\nuniform float opacity;\nvoid main() {\n  gl_FragColor = vec4(color, opacity);\n}"},918:function(t,e){t.exports="void main() {\n  gl_Position = vec4(position, 1.0);\n}\n"},919:function(t,e){t.exports="varying vec2 vUv;\nuniform float alpha;\nuniform sampler2D tDiffuse;\nvoid main() {\n  vec4 texColor = texture2D(tDiffuse, vUv);\n  gl_FragColor = vec4(texColor.rgb, texColor.a * alpha);\n}"},920:function(t,e){t.exports="varying vec3 vWorldPos;\nuniform float alpha;\nuniform samplerCube tDiffuse;\nvoid main() {\n  vec4 texColor = textureCube(tDiffuse, vWorldPos);\n  gl_FragColor = vec4(texColor.rgb, texColor.a * alpha);\n}"},921:function(t,e){t.exports="varying vec3 vWorldPos;\nvoid main() {\n  vWorldPos = vec3(-position.x, -position.y, position.z);\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}"}}]);